<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Analysis and Visualization in Python for Ecologists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg">
</div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Analysis and Visualization in Python for Ecologists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualization in Python for Ecologists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="CONTRIBUTORS.html">About Contributors</a></li>
<li><a class="dropdown-item" href="extra_challenges.html">Extra Challenges</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="jupyter_notebooks.html">Overview of Jupyter Notebooks</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualization in Python for Ecologists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-before-we-start.html">1. Before we start</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-short-introduction-to-Python.html">2. Short Introduction to Programming in Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Starting With Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-index-slice-subset.html">4. Indexing, Slicing and Subsetting DataFrames in Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-data-types-and-format.html">5. Data Types and Formats</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-merging-data.html">6. Combining DataFrames with Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-loops-and-functions.html">7. Data Workflows and Automation</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-visualization-ggplot-python.html">8. Making Plots With plotnine</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="08-putting-it-all-together.html">9. Data Ingest and Visualization - Matplotlib and Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="09-working-with-sql.html">10. Accessing SQLite Databases Using Python and Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <li><a href="CONTRIBUTORS.html">About Contributors</a></li>
<li><a href="extra_challenges.html">Extra Challenges</a></li>
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="jupyter_notebooks.html">Overview of Jupyter Notebooks</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-00-before-we-start"><p>Content from <a href="00-before-we-start.html">Before we start</a></p>
<hr>
<p>Last updated on 2024-02-21 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/00-before-we-start.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Python and why should I learn it?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Present motivations for using Python.</li>
<li>Organize files and directories for a set of analyses as a Python
project, and understand the purpose of the working directory.</li>
<li>How to work with Jupyter Notebook and Spyder.</li>
<li>Know where to find help.</li>
<li>Demonstrate how to provide sufficient information for
troubleshooting with the Python user community.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="what-is-python"><h2 class="section-heading">What is Python?<a class="anchor" aria-label="anchor" href="#what-is-python"></a>
</h2>
<hr class="half-width">
<p>Python is a general purpose programming language that supports rapid
development of data analytics applications. The word “Python” is used to
refer to both, the programming language and the tool that executes the
scripts written in Python language.</p>
<p>Its main advantages are:</p>
<ul>
<li>Free</li>
<li>Open-source</li>
<li>Available on all major platforms (macOS, Linux, Windows)</li>
<li>Supported by Python Software Foundation</li>
<li>Supports multiple programming paradigms</li>
<li>Has large community</li>
<li>Rich ecosystem of third-party packages</li>
</ul>
<p><em>So, why do you need Python for data analysis?</em></p>
<ul>
<li><p><strong>Easy to learn:</strong> Python is easier to learn than
other programming languages. This is important because lower barriers
mean it is easier for new members of the community to get up to
speed.</p></li>
<li>
<p><strong>Reproducibility:</strong> Reproducibility is the ability
to obtain the same results using the same dataset(s) and analysis.</p>
<p>Data analysis written as a Python script can be reproduced on any
platform. Moreover, if you collect more or correct existing data, you
can quickly re-run your analysis!</p>
<p>An increasing number of journals and funding agencies expect analyses
to be reproducible, so knowing Python will give you an edge with these
requirements.</p>
</li>
<li>
<p><strong>Versatility:</strong> Python is a versatile language that
integrates with many existing applications to enable something
completely amazing. For example, one can use Python to generate
manuscripts, so that if you need to update your data, analysis
procedure, or change something else, you can quickly regenerate all the
figures and your manuscript will be updated automatically.</p>
<p>Python can read text files, connect to databases, and many other data
formats, on your computer or on the web.</p>
</li>
<li><p><strong>Interdisciplinary and extensible:</strong> Python
provides a framework that allows anyone to combine approaches from
different research (but not only) disciplines to best suit your analysis
needs.</p></li>
<li><p><strong>Python has a large and welcoming community:</strong>
Thousands of people use Python daily. Many of them are willing to help
you through mailing lists and websites, such as <a href="https://stackoverflow.com" class="external-link">Stack Overflow</a> and <a href="https://www.anaconda.com/community" class="external-link">Anaconda community
portal</a>.</p></li>
<li><p><strong>Free and Open-Source Software (FOSS)… and
Cross-Platform:</strong> We know we have already said that but it is
worth repeating.</p></li>
</ul></section><section id="knowing-your-way-around-anaconda"><h2 class="section-heading">Knowing your way around Anaconda<a class="anchor" aria-label="anchor" href="#knowing-your-way-around-anaconda"></a>
</h2>
<hr class="half-width">
<p><a href="https://www.anaconda.com/download" class="external-link">Anaconda</a> distribution
of Python includes a lot of its popular packages, such as the IPython
console, Jupyter Notebook, and Spyder IDE. Have a quick look around the
Anaconda Navigator. You can launch programs from the Navigator or use
the command line.</p>
<p>The <a href="https://jupyter.org" class="external-link">Jupyter Notebook</a> is an
open-source web application that allows you to create and share
documents that allow one to create documents that combine code, graphs,
and narrative text. <a href="https://www.spyder-ide.org" class="external-link">Spyder</a> is
an <strong>Integrated Development Environment</strong> that allows one
to write Python scripts and interact with the Python software from
within a single interface.</p>
<p>Anaconda comes with a package manager called <a href="https://conda.io/docs/" class="external-link">conda</a> used to install and update
additional packages.</p>
</section><section id="research-project-best-practices"><h2 class="section-heading">Research Project: Best Practices<a class="anchor" aria-label="anchor" href="#research-project-best-practices"></a>
</h2>
<hr class="half-width">
<p>It is a good idea to keep a set of related data, analyses, and text
in a single folder. All scripts and text files within this folder can
then use relative paths to the data files. Working this way makes it a
lot easier to move around your project and share it with others.</p>
<div class="section level3">
<h3 id="organizing-your-working-directory">Organizing your working directory<a class="anchor" aria-label="anchor" href="#organizing-your-working-directory"></a>
</h3>
<p>Using a consistent folder structure across your projects will help
you keep things organized, and will also make it easy to find/file
things in the future. This can be especially helpful when you have
multiple projects. In general, you may wish to create separate
directories for your scripts, data, and documents.</p>
<ul>
<li><p><strong><code>data/</code></strong>: Use this folder to store
your raw data. For the sake of transparency and provenance, you should
always keep a copy of your <strong>raw data</strong>. If you need to
cleanup data, do it programmatically (<em>i.e.</em> with scripts) and
make sure to separate cleaned up data from the raw data. For example,
you can store raw data in files <code>./data/raw/</code> and clean data
in <code>./data/clean/</code>.</p></li>
<li><p><strong><code>documents/</code></strong>: Use this folder to
store outlines, drafts, and other text.</p></li>
<li><p><strong><code>code/</code></strong>: Use this folder to store
your (Python) scripts for data cleaning, analysis, and plotting that you
use in this particular project.</p></li>
</ul>
<p>You may need to create additional directories depending on your
project needs, but these should form the backbone of your project’s
directory. For this workshop, we will need a <code>data/</code> folder
to store our raw data, and we will later create a
<code>data_output/</code> folder when we learn how to export data as CSV
files.</p>
</div>
</section><section id="what-is-programming-and-coding"><h2 class="section-heading">What is Programming and Coding?<a class="anchor" aria-label="anchor" href="#what-is-programming-and-coding"></a>
</h2>
<hr class="half-width">
<p>Programming is the process of writing <em>“programs”</em> that a
computer can execute and produce some (useful) output. Programming is a
multi-step process that involves the following steps:</p>
<ol style="list-style-type: decimal">
<li>Identifying the aspects of the real-world problem that can be solved
computationally</li>
<li>Identifying (the best) computational solution</li>
<li>Implementing the solution in a specific computer language</li>
<li>Testing, validating, and adjusting the implemented solution.</li>
</ol>
<p>While <em>“Programming”</em> refers to all of the above steps,
<em>“Coding”</em> refers to step 3 only: <em>“Implementing the solution
in a specific computer language”</em>. It’s important to note that
<em>“the best”</em> computational solution must consider factors beyond
the computer. Who is using the program, what resources/funds does your
team have for this project, and the available timeline all shape and
mold what “best” may be.</p>
<div class="section level4">
<h4 id="if-you-are-working-with-jupyter-notebook">If you are working with Jupyter notebook:<a class="anchor" aria-label="anchor" href="#if-you-are-working-with-jupyter-notebook"></a>
</h4>
<p>You can type Python code into a code cell and then execute the code
by pressing <kbd>Shift</kbd>+<kbd>Return</kbd>. Output will be printed
directly under the input cell. You can recognise a code cell by the
<code>In[ ]:</code> at the beginning of the cell and output by
<code>Out[ ]:</code>. Pressing the <strong>+</strong> button in the menu
bar will add a new cell. All your commands as well as any output will be
saved with the notebook.</p>
</div>
<div class="section level4">
<h4 id="if-you-are-working-with-spyder">If you are working with Spyder:<a class="anchor" aria-label="anchor" href="#if-you-are-working-with-spyder"></a>
</h4>
<p>You can either use the console or use script files (plain text files
that contain your code). The console pane (in Spyder, the bottom right
panel) is the place where commands written in the Python language can be
typed and executed immediately by the computer. It is also where the
results will be shown. You can execute commands directly in the console
by pressing <kbd>Return</kbd>, but they will be “lost” when you close
the session. Spyder uses the <a href="https://ipython.org" class="external-link">IPython</a>
console by default.</p>
<p>Since we want our code and workflow to be reproducible, it is better
to type the commands in the script editor, and save them as a script.
This way, there is a complete record of what we did, and anyone
(including our future selves!) has an easier time reproducing the
results on their computer.</p>
<p>Spyder allows you to execute commands directly from the script editor
by using the run buttons on top. To run the entire script click <em>Run
file</em> or press <kbd>F5</kbd>, to run the current line click <em>Run
selection or current line</em> or press <kbd>F9</kbd>, other run buttons
allow to run script cells or go into debug mode. When using
<kbd>F9</kbd>, the command on the current line in the script (indicated
by the cursor) or all of the commands in the currently selected text
will be sent to the console and executed.</p>
<p>At some point in your analysis you may want to check the content of a
variable or the structure of an object, without necessarily keeping a
record of it in your script. You can type these commands and execute
them directly in the console. Spyder provides the
<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>E</kbd> and
<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd> shortcuts to allow you to
jump between the script and the console panes.</p>
<p>If Python is ready to accept commands, the IPython console shows an
<code>In [..]:</code> prompt with the current console line number in
<code>[]</code>. If it receives a command (by typing, copy-pasting or
sent from the script editor), Python will execute it, display the
results in the <code>Out [..]:</code> cell, and come back with a new
<code>In [..]:</code> prompt waiting for new commands.</p>
<p>If Python is still waiting for you to enter more data because it
isn’t complete yet, the console will show a <code>...:</code> prompt. It
means that you haven’t finished entering a complete command. This can be
because you have not typed a closing parenthesis (<code>)</code>,
<code>]</code>, or <code>}</code>) or quotation mark. When this happens,
and you thought you finished typing your command, click inside the
console window and press <kbd>Esc</kbd>; this will cancel the incomplete
command and return you to the <code>In [..]:</code> prompt.</p>
</div>
</section><section id="how-to-learn-more-after-the-workshop"><h2 class="section-heading">How to learn more after the workshop?<a class="anchor" aria-label="anchor" href="#how-to-learn-more-after-the-workshop"></a>
</h2>
<hr class="half-width">
<p>The material we cover during this workshop will give you an initial
taste of how you can use Python to analyze data for your own research.
However, you will need to learn more to do advanced operations such as
cleaning your dataset, using statistical methods, or creating beautiful
graphics. The best way to become proficient and efficient at Python, as
with any other tool, is to use it to address your actual research
questions. As a beginner, it can feel daunting to have to write a script
from scratch, and given that many people make their code available
online, modifying existing code to suit your purpose might make it
easier for you to get started.</p>
</section><section id="seeking-help"><h2 class="section-heading">Seeking help<a class="anchor" aria-label="anchor" href="#seeking-help"></a>
</h2>
<hr class="half-width">
<ul>
<li>check under the <em>Help</em> menu</li>
<li>type <code>help()</code>
</li>
<li>type <code>?object</code> or <code>help(object)</code> to get
information about an object</li>
<li><a href="https://www.python.org/doc" class="external-link">Python documentation</a></li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/" class="external-link">Pandas
documentation</a></li>
</ul>
<p>Finally, a generic Google or internet search “Python task” will often
either send you to the appropriate module documentation or a helpful
forum where someone else has already asked your question.</p>
<p>I am stuck… I get an error message that I don’t understand. Start by
googling the error message. However, this doesn’t always work very well,
because often, package developers rely on the error catching provided by
Python. You end up with general error messages that might not be very
helpful to diagnose a problem (e.g. “subscript out of bounds”). If the
message is very generic, you might also include the name of the function
or package you’re using in your query.</p>
<p>However, you should check Stack Overflow. Search using the
<code>[python]</code> tag. Most questions have already been answered,
but the challenge is to use the right words in the search to find the
answers: <a href="https://stackoverflow.com/questions/tagged/python?tab=Votes" class="external-link">https://stackoverflow.com/questions/tagged/python?tab=Votes</a></p>
<div class="section level3">
<h3 id="asking-for-help">Asking for help<a class="anchor" aria-label="anchor" href="#asking-for-help"></a>
</h3>
<p>The key to receiving help from someone is for them to rapidly grasp
your problem. You should make it as easy as possible to pinpoint where
the issue might be.</p>
<p>Try to use the correct words to describe your problem. For instance,
a package is not the same thing as a library. Most people will
understand what you meant, but others have really strong feelings about
the difference in meaning. The key point is that it can make things
confusing for people trying to help you. Be as precise as possible when
describing your problem.</p>
<p>If possible, try to reduce what doesn’t work to a simple reproducible
example. If you can reproduce the problem using a very small data frame
instead of your 50,000 rows and 10,000 columns one, provide the small
one with the description of your problem. When appropriate, try to
generalize what you are doing so even people who are not in your field
can understand the question. For instance, instead of using a subset of
your real dataset, create a small (3 columns, 5 rows) generic one.</p>
</div>
<div class="section level3">
<h3 id="where-to-ask-for-help">Where to ask for help?<a class="anchor" aria-label="anchor" href="#where-to-ask-for-help"></a>
</h3>
<ul>
<li>The person sitting next to you during the workshop. Don’t hesitate
to talk to your neighbor during the workshop, compare your answers, and
ask for help. You might also be interested in organizing regular
meetings following the workshop to keep learning from each other.</li>
<li>Your friendly colleagues: if you know someone with more experience
than you, they might be able and willing to help you.</li>
<li>
<a href="https://stackoverflow.com/questions/tagged/python?tab=Votes" class="external-link">Stack
Overflow</a>: if your question hasn’t been answered before and is well
crafted, chances are you will get an answer in less than 5 min. Remember
to follow their guidelines on how to ask a good question.</li>
<li><a href="https://www.python.org/community/lists" class="external-link">Python mailing
lists</a></li>
</ul>
</div>
</section><section id="more-resources"><h2 class="section-heading">More resources<a class="anchor" aria-label="anchor" href="#more-resources"></a>
</h2>
<hr class="half-width">
<ul>
<li><p><a href="https://pypi.org/" class="external-link">PyPI - the Python Package
Index</a></p></li>
<li><p><a href="https://docs.python-guide.org" class="external-link">The Hitchhiker’s Guide to
Python</a></p></li>
<li><p><a href="https://diveintopython3.net/" class="external-link">Dive into Python
3</a></p></li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python is an open source and platform independent programming
language.</li>
<li>Jupyter Notebook and the Spyder IDE are great tools to code in and
interact with Python. With the large Python community it is easy to find
help on the internet.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-01-short-introduction-to-Python"><p>Content from <a href="01-short-introduction-to-Python.html">Short Introduction to Programming in Python</a></p>
<hr>
<p>Last updated on 2024-02-21 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/01-short-introduction-to-Python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I program in Python?</li>
<li>How can I represent my data in Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the advantages of using programming vs. completing
repetitive tasks by hand.</li>
<li>Define the following data types in Python: strings, integers, and
floats.</li>
<li>Perform mathematical operations in Python using basic
operators.</li>
<li>Define the following as it relates to Python: lists, tuples, and
dictionaries.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="interpreter"><h2 class="section-heading">Interpreter<a class="anchor" aria-label="anchor" href="#interpreter"></a>
</h2>
<hr class="half-width">
<p>Python is an interpreted language which can be used in two ways:</p>
<ul>
<li>“Interactively”: when you use it as an “advanced calculator”
executing one command at a time. To start Python in this mode, execute
<code>python</code> on the command line:</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> python</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Python 3.5.1 (default, Oct 23 2015, 18:05:06)
[GCC 4.8.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;</code></pre>
</div>
<p>Chevrons <code>&gt;&gt;&gt;</code> indicate an interactive prompt in
Python, meaning that it is waiting for your input.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hello World"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hello World</code></pre>
</div>
<ul>
<li>“Scripting” Mode: executing a series of “commands” saved in text
file, usually with a <code>.py</code> extension after the name of your
file:</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> python my_script.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hello World</code></pre>
</div>
</section><section id="introduction-to-variables-in-python"><h2 class="section-heading">Introduction to variables in Python<a class="anchor" aria-label="anchor" href="#introduction-to-variables-in-python"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="assigning-values-to-variables">Assigning values to variables<a class="anchor" aria-label="anchor" href="#assigning-values-to-variables"></a>
</h3>
<p>One of the most basic things we can do in Python is assign values to
variables:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span>  <span class="co"># An example of assigning a value to a new text variable,</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                         <span class="co"># also known as a string data type in Python</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>number <span class="op">=</span> <span class="dv">42</span>              <span class="co"># An example of assigning a numeric value, or an integer data type</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>pi_value <span class="op">=</span> <span class="fl">3.1415</span>        <span class="co"># An example of assigning a floating point value (the float data type)</span></span></code></pre>
</div>
<p>Here we’ve assigned data to the variables <code>text</code>,
<code>number</code> and <code>pi_value</code>, using the assignment
operator <code>=</code>. To review the value of a variable, we can type
the name of the variable into the interpreter and press
<kbd>Return</kbd>:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>text</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">"Data Carpentry"</span></span></code></pre>
</div>
<p>Everything in Python has a type. To get the type of something, we can
pass it to the built-in function <code>type</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">type</span>(text)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'str'&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">type</span>(number)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'int'&gt;</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="bu">type</span>(pi_value)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'float'&gt;</code></pre>
</div>
<p>The variable <code>text</code> is of type <code>str</code>, short for
“string”. Strings hold sequences of characters, which can be letters,
numbers, punctuation or more exotic forms of text (even emoji!).</p>
<p>We can also see the value of something using another built-in
function, <code>print</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Data Carpentry</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="bu">print</span>(number)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42</span></span></code></pre>
</div>
<p>This may seem redundant, but in fact it’s the only way to display
output in a script:</p>
<p><em>example.py</em></p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># A Python script file</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Comments in Python start with #</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># The next line assigns the string "Data Carpentry" to the variable "text".</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># The next line does nothing!</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>text</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># The next line uses the print function to print out the value we assigned to "text"</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<p><em>Running the script</em></p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="ex">$</span> python example.py</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Data Carpentry</code></pre>
</div>
<p>Notice that “Data Carpentry” is printed only once.</p>
<p><strong>Tip</strong>: <code>print</code> and <code>type</code> are
built-in functions in Python. Later in this lesson, we will introduce
methods and user-defined functions. <a href="https://docs.python.org/3/" class="external-link">The Python documentation</a> is
excellent for reference on the differences between them.</p>
<p><strong>Tip</strong>: When editing scripts like <em>example.py</em>,
be careful not to use word processors such as MS Word, as they may
introduce extra information that confuses Python. In this lesson we will
be using either Jupyter notebooks or the Spyder IDE, and for your
everyday work you may also choose any text editor such as Notepad++,
VSCode, Vim, or Emacs.</p>
</div>
<div class="section level3">
<h3 id="operators">Operators<a class="anchor" aria-label="anchor" href="#operators"></a>
</h3>
<p>We can perform mathematical calculations in Python using the basic
operators <code>+, -, /, *, %</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span>  <span class="co"># Addition</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="dv">6</span> <span class="op">*</span> <span class="dv">7</span>  <span class="co"># Multiplication</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="dv">2</span> <span class="op">**</span> <span class="dv">16</span>  <span class="co"># Power</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">65536</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="dv">13</span> <span class="op">%</span> <span class="dv">5</span>  <span class="co"># Modulo</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<p>We can also use comparison and logic operators:
<code>&lt;, &gt;, ==, !=, &lt;=, &gt;=</code> and statements of identity
such as <code>and, or, not</code>. The data type returned by this is
called a <em>boolean</em>.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="dv">3</span> <span class="op">&gt;</span> <span class="dv">4</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="va">True</span> <span class="kw">and</span> <span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="va">True</span> <span class="kw">or</span> <span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="va">True</span> <span class="kw">and</span> <span class="va">False</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
</div>
</section><section id="sequences-lists-and-tuples"><h2 class="section-heading">Sequences: Lists and Tuples<a class="anchor" aria-label="anchor" href="#sequences-lists-and-tuples"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="lists">Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<p><strong>Lists</strong> are a common data structure to hold an ordered
sequence of elements. Each element can be accessed by an index. Note
that Python indexes start with 0 instead of 1:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>numbers[<span class="dv">0</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span></code></pre>
</div>
<p>A <code>for</code> loop can be used to access the elements in a list
or other Python data structure one at a time:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="cf">for</span> num <span class="kw">in</span> numbers:</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>    <span class="bu">print</span>(num)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span>
<span><span class="fl">2</span></span>
<span><span class="fl">3</span></span></code></pre>
</div>
<p><strong>Indentation</strong> is very important in Python. Note that
the second line in the example above is indented. Just like three
chevrons <code>&gt;&gt;&gt;</code> indicate an interactive prompt in
Python, the three dots <code>...</code> are Python’s prompt for multiple
lines. This is Python’s way of marking a block of code. [Note: you do
not type <code>&gt;&gt;&gt;</code> or <code>...</code>.]</p>
<p>To add elements to the end of a list, we can use the
<code>append</code> method. Methods are a way to interact with an object
(a list, for example). We can invoke a method using the dot
<code>.</code> followed by the method name and a list of arguments in
parentheses. Let’s look at an example using <code>append</code>:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>numbers.append(<span class="dv">4</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="bu">print</span>(numbers)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1, 2, 3, 4]</code></pre>
</div>
<p>To find out what methods are available for an object, we can use the
built-in <code>help</code> command:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>help(numbers)

Help on list object:

class list(object)
 |  list() -&gt; new empty list
 |  list(iterable) -&gt; new list initialized from iterable's items
 ...</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tuples">Tuples<a class="anchor" aria-label="anchor" href="#tuples"></a>
</h3>
<p>A <strong>tuple</strong> is similar to a list in that it’s an ordered
sequence of elements. However, tuples can not be changed once created
(they are “immutable”). Tuples are created by placing comma-separated
values inside parentheses <code>()</code>.</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Tuples use parentheses</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>a_tuple <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>another_tuple <span class="op">=</span> (<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="co"># Note: lists use square brackets</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>a_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span></code></pre>
</div>
<div id="tuples-vs.-lists" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="tuples-vs.-lists" class="callout-inner">
<h3 class="callout-title">Tuples<em>vs.</em>Lists<a class="anchor" aria-label="anchor" href="#tuples-vs.-lists"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens when you execute <code>a_list[1] = 5</code>?</li>
<li>What happens when you execute <code>a_tuple[2] = 5</code>?</li>
<li>What does <code>type(a_tuple)</code> tell you about
<code>a_tuple</code>?</li>
<li>What information does the built-in function <code>len()</code>
provide? Does it provide the same information on both tuples and lists?
Does the <code>help()</code> function confirm this?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>What happens when you execute <code>a_list[1] = 5</code>?</li>
</ol>
<p>The second value in <code>a_list</code> is replaced with
<code>5</code>.</p>
<ol start="2" style="list-style-type: decimal">
<li>What happens when you execute <code>a_tuple[2] = 5</code>?</li>
</ol>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>TypeError: 'tuple' object does not support item assignment</code></pre>
</div>
<p>As a tuple is immutable, it does not support item assignment.
Elements in a list can be altered individually.</p>
<ol start="3" style="list-style-type: decimal">
<li>What does <code>type(a_tuple)</code> tell you about
<code>a_tuple</code>?</li>
</ol>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'tuple'&gt;</code></pre>
</div>
<p>The function tells you that the variable <code>a_tuple</code> is an
object of the class <code>tuple</code>.</p>
<ol start="4" style="list-style-type: decimal">
<li>What information does the built-in function <code>len()</code>
provide? Does it provide the same information on both tuples and lists?
Does the <code>help()</code> function confirm this?</li>
</ol>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="bu">len</span>(a_list)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="bu">len</span>(a_tuple)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<p><code>len()</code> tells us the length of an object. It works the
same for both lists and tuples, providing us with the number of entries
in each case.</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="bu">help</span>(<span class="bu">len</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Help on built-in function len in module builtins:

len(obj, /)
    Return the number of items in a container.</code></pre>
</div>
<p>Lists and tuples are both types of container i.e. objects that can
contain multiple items, the key difference being that lists are mutable
i.e. they can be modified after they have been created, while tuples are
not: their value cannot be modified, only overwritten.</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="dictionaries"><h2 class="section-heading">Dictionaries<a class="anchor" aria-label="anchor" href="#dictionaries"></a>
</h2>
<hr class="half-width">
<p>A <strong>dictionary</strong> is a container that holds pairs of
objects - keys and values.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>translation <span class="op">=</span> {<span class="st">'one'</span>: <span class="st">'first'</span>, <span class="st">'two'</span>: <span class="st">'second'</span>}</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>translation[<span class="st">'one'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'first'</span></span></code></pre>
</div>
<p>Dictionaries work a lot like lists - except that you index them with
<em>keys</em>. You can think about a key as a name or unique identifier
for the value it corresponds to.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>rev <span class="op">=</span> {<span class="st">'first'</span>: <span class="st">'one'</span>, <span class="st">'second'</span>: <span class="st">'two'</span>}</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>rev[<span class="st">'first'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'one'</span></span></code></pre>
</div>
<p>To add an item to the dictionary we assign a value to a new key:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>rev[<span class="st">'third'</span>] <span class="op">=</span> <span class="st">'three'</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>rev</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'first': 'one', 'second': 'two', 'third': 'three'}</code></pre>
</div>
<p>Using <code>for</code> loops with dictionaries is a little more
complicated. We can do this in two ways:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> rev.items():</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>    <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, value)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'first'</span> <span class="op">-&gt;</span> <span class="va">one</span></span>
<span><span class="st">'second'</span> <span class="op">-&gt;</span> <span class="va">two</span></span>
<span><span class="st">'third'</span> <span class="op">-&gt;</span> <span class="va">three</span></span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> rev.keys():</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>    <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, rev[key])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'first'</span> <span class="op">-&gt;</span> <span class="va">one</span></span>
<span><span class="st">'second'</span> <span class="op">-&gt;</span> <span class="va">two</span></span>
<span><span class="st">'third'</span> <span class="op">-&gt;</span> <span class="va">three</span></span></code></pre>
</div>
<div id="changing-dictionaries" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="changing-dictionaries" class="callout-inner">
<h3 class="callout-title">Changing dictionaries<a class="anchor" aria-label="anchor" href="#changing-dictionaries"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>First, print the value of the <code>rev</code> dictionary to the
screen.</li>
<li>Reassign the value that corresponds to the key <code>second</code>
so that it no longer reads “two” but instead <code>2</code>.</li>
<li>Print the value of <code>rev</code> to the screen again to see if
the value has changed.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="bu">print</span>(rev)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'first': 'one', 'second': 'two', 'third': 'three'}</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>and 3.</li>
</ol>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>rev[<span class="st">'second'</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="bu">print</span>(rev)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'first': 'one', 'second': 2, 'third': 'three'}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Assigning to Dictionaries</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>It can help to further demonstrate the freedom the user has to define
values to keys in a dictionary, by showing another example with a value
completely unrelated to the current contents of the dictionary, e.g.</p>
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>rev[<span class="dv">2</span>] <span class="op">=</span> <span class="st">"apple-sauce"</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="bu">print</span>(rev)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{1: 'one', 2: 'apple-sauce', 3: 'three'}</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="functions"><h2 class="section-heading">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<hr class="half-width">
<p>Defining a section of code as a <strong>function</strong> in Python
is done using the <code>def</code> keyword. For example a function that
takes two arguments and returns their sum can be defined as:</p>
<div class="codewrapper sourceCode" id="cb73">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="kw">def</span> add_function(a, b):</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>z <span class="op">=</span> add_function(<span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a><span class="bu">print</span>(z)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python is an interpreted language which can be used interactively
(executing one command at a time) or in scripting mode (executing a
series of commands saved in file).</li>
<li>One can assign a value to a variable in Python. Those variables can
be of several types, such as string, integer, floating point and complex
numbers.</li>
<li>Lists and tuples are similar in that they are ordered lists of
elements; they differ in that a tuple is immutable (cannot be
changed).</li>
<li>Dictionaries are data structures that provide mappings between keys
and values.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-starting-with-data"><p>Content from <a href="02-starting-with-data.html">Starting With Data</a></p>
<hr>
<p>Last updated on 2024-02-23 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/02-starting-with-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I import data in Python?</li>
<li>What is Pandas?</li>
<li>Why should I use Pandas to work with data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Navigate the workshop directory and download a dataset.</li>
<li>Explain what a library is and what libraries are used for.</li>
<li>Describe what the Python Data Analysis Library (Pandas) is.</li>
<li>Load the Python Data Analysis Library (Pandas).</li>
<li>Read tabular data into Python using Pandas.</li>
<li>Describe what a DataFrame is in Python.</li>
<li>Access and summarize data stored in a DataFrame.</li>
<li>Define indexing as it relates to data structures.</li>
<li>Perform basic mathematical operations and summary statistics on data
in a Pandas DataFrame.</li>
<li>Create simple plots.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="working-with-pandas-dataframes-in-python"><h2 class="section-heading">Working With Pandas DataFrames in Python<a class="anchor" aria-label="anchor" href="#working-with-pandas-dataframes-in-python"></a>
</h2>
<hr class="half-width">
<p>We can automate the process of performing data manipulations in
Python. It’s efficient to spend time building the code to perform these
tasks because once it’s built, we can use it over and over on different
datasets that use a similar format. This makes our data manipulation
processes reproducible. We can also share our code with colleagues and
they can replicate the same analysis starting with the same original
data.</p>
<div class="section level4">
<h4 id="starting-in-the-same-spot">Starting in the same spot<a class="anchor" aria-label="anchor" href="#starting-in-the-same-spot"></a>
</h4>
<p>To help the lesson run smoothly, let’s ensure everyone is in the same
directory. This should help us avoid path and file name issues. At this
time please navigate to the workshop directory. If you are working in
Jupyter Notebook be sure that you start your notebook in the workshop
directory.</p>
</div>
<div class="section level4">
<h4 id="our-data">Our Data<a class="anchor" aria-label="anchor" href="#our-data"></a>
</h4>
<p>For this lesson, we will be using the Portal Teaching data, a subset
of the data from Ernst et al. <a href="https://www.esapubs.org/archive/ecol/E090/118/default.htm" class="external-link">Long-term
monitoring and experimental manipulation of a Chihuahuan Desert
ecosystem near Portal, Arizona, USA</a>.</p>
<p>We will be using files from the <a href="https://figshare.com/articles/Portal_Project_Teaching_Database/1314459" class="external-link">Portal
Project Teaching Database</a>. This section will use the
<code>surveys.csv</code> file that can be downloaded here: <a href="https://ndownloader.figshare.com/files/2292172" class="external-link">https://ndownloader.figshare.com/files/2292172</a></p>
<p>We are studying the <strong>species</strong> and
<strong>weight</strong> of animals caught in sites in our study area.
The dataset is stored as a <code>.csv</code> file: each row holds
information for a single animal, and the columns represent:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>record_id</td>
<td>Unique id for the observation</td>
</tr>
<tr class="even">
<td>month</td>
<td>month of observation</td>
</tr>
<tr class="odd">
<td>day</td>
<td>day of observation</td>
</tr>
<tr class="even">
<td>year</td>
<td>year of observation</td>
</tr>
<tr class="odd">
<td>plot_id</td>
<td>ID of a particular site</td>
</tr>
<tr class="even">
<td>species_id</td>
<td>2-letter code</td>
</tr>
<tr class="odd">
<td>sex</td>
<td>sex of animal (“M”, “F”)</td>
</tr>
<tr class="even">
<td>hindfoot_length</td>
<td>length of the hindfoot in mm</td>
</tr>
<tr class="odd">
<td>weight</td>
<td>weight of the animal in grams</td>
</tr>
</tbody>
</table>
<p>The first few rows of our first file look like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id,month,day,year,plot_id,species_id,sex,hindfoot_length,weight
1,7,16,1977,2,NL,M,32,
2,7,16,1977,3,NL,M,33,
3,7,16,1977,2,DM,F,37,
4,7,16,1977,7,DM,M,36,
5,7,16,1977,3,DM,M,35,
6,7,16,1977,1,PF,M,14,
7,7,16,1977,2,PE,F,,
8,7,16,1977,1,DM,M,37,
9,7,16,1977,1,DM,F,34,</code></pre>
</div>
<hr>
</div>
<div class="section level3">
<h3 id="about-libraries">About Libraries<a class="anchor" aria-label="anchor" href="#about-libraries"></a>
</h3>
<p>A library in Python contains a set of tools (called functions) that
perform tasks on our data. Importing a library is like getting a piece
of lab equipment out of a storage locker and setting it up on the bench
for use in a project. Once a library is set up, it can be used or called
to perform the task(s) it was built to do.</p>
</div>
<div class="section level3">
<h3 id="pandas-in-python">Pandas in Python<a class="anchor" aria-label="anchor" href="#pandas-in-python"></a>
</h3>
<p>One of the best options for working with tabular data in Python is to
use the <a href="https://pandas.pydata.org" class="external-link">Python Data Analysis
Library</a> (a.k.a. Pandas). The Pandas library provides data
structures, produces high quality plots with <a href="https://matplotlib.org" class="external-link">matplotlib</a> and integrates nicely with
other libraries that use <a href="https://www.numpy.org/" class="external-link">NumPy</a>
(which is another Python library) arrays.</p>
<p>Python doesn’t load all of the libraries available to it by default.
We have to add an <code>import</code> statement to our code in order to
use library functions. To import a library, we use the syntax
<code>import libraryName</code>. If we want to give the library a
nickname to shorten the command, we can add
<code>as nickNameHere</code>. An example of importing the pandas library
using the common nickname <code>pd</code> is below.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>Each time we call a function that’s in a library, we use the syntax
<code>LibraryName.FunctionName</code>. Adding the library name with a
<code>.</code> before the function name tells Python where to find the
function. In the example above, we have imported Pandas as
<code>pd</code>. This means we don’t have to type out
<code>pandas</code> each time we call a Pandas function.</p>
</div>
</section><section id="reading-csv-data-using-pandas"><h2 class="section-heading">Reading CSV Data Using Pandas<a class="anchor" aria-label="anchor" href="#reading-csv-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We will begin by locating and reading our survey data which are in
CSV format. CSV stands for Comma-Separated Values and is a common way to
store formatted data. Other symbols may also be used, so you might see
tab-separated, colon-separated or space separated files. pandas can work
with each of these types of separators, as it allows you to specify the
appropriate separator for your data. CSV files (and other -separated
value file types) make it easy to share data, and can be imported and
exported from many applications, including Microsoft Excel. For more
details on CSV files, see the <a href="https://www.datacarpentry.org/spreadsheet-ecology-lesson/05-exporting-data" class="external-link">Data
Organisation in Spreadsheets</a> lesson. We can use Pandas’
<code>read_csv</code> function to pull the file directly into a <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html" class="external-link">DataFrame</a>.</p>
<div class="section level3">
<h3 id="so-whats-a-dataframe">So What’s a DataFrame?<a class="anchor" aria-label="anchor" href="#so-whats-a-dataframe"></a>
</h3>
<p>A DataFrame is a 2-dimensional data structure that can store data of
different types (including strings, numbers, categories and more) in
columns. It is similar to a spreadsheet or an SQL table or the
<code>data.frame</code> in R. A DataFrame always has an index (0-based).
An index refers to the position of an element in the data structure.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Note that pd.read_csv is used because we imported pandas as pd</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>The above command yields the <strong>output</strong> below:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      record_id month day year  plot_id species_id  sex hindfoot_length weight
0             1     7  16 1977        2         NL    M            32.0    NaN
1             2     7  16 1977        3         NL    M            33.0    NaN
2             3     7  16 1977        2         DM    F            37.0    NaN
3             4     7  16 1977        7         DM    M            36.0    NaN
4             5     7  16 1977        3         DM    M            35.0    NaN
...         ...   ... ...  ...      ...        ...  ...             ...    ...
35544     35545    12  31 2002       15         AH  NaN             NaN    NaN
35545     35546    12  31 2002       15         AH  NaN             NaN    NaN
35546     35547    12  31 2002       10         RM    F            15.0   14.0
35547     35548    12  31 2002        7         DO    M            36.0   51.0
35548     35549    12  31 2002        5        NaN  NaN             NaN    NaN

[35549 rows x 9 columns]</code></pre>
</div>
<p>We can see that there were 35,549 rows parsed. Each row has 9
columns. The first column is the index of the DataFrame. The index is
used to identify the position of the data, but it is not an actual
column of the DataFrame. It looks like the <code>read_csv</code>
function in Pandas read our file properly. However, we haven’t saved any
data to memory so we can work with it. We need to assign the DataFrame
to a variable. Remember that a variable is a name for a value, such as
<code>x</code>, or <code>data</code>. We can create a new object with a
variable name by assigning a value to it using <code>=</code>.</p>
<p>Let’s call the imported survey data <code>surveys_df</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>Note that Python does not produce any output on the screen when you
assign the imported DataFrame to a variable. We can view the value of
the <code>surveys_df</code> object by typing its name into the Python
command prompt.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>surveys_df</span></code></pre>
</div>
<p>which prints contents like above.</p>
<p>Note: if the output is too wide to print on your narrow terminal
window, you may see something slightly different as the large set of
data scrolls past. You may see simply the last column of data:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>17        NaN
18        NaN
19        NaN
20        NaN
21        NaN
22        NaN
23        NaN
24        NaN
25        NaN
26        NaN
27        NaN
28        NaN
29        NaN
...       ...
35519    36.0
35520    48.0
35521    45.0
35522    44.0
35523    27.0
35524    26.0
35525    24.0
35526    43.0
35527     NaN
35528    25.0
35529     NaN
35530     NaN
35531    43.0
35532    48.0
35533    56.0
35534    53.0
35535    42.0
35536    46.0
35537    31.0
35538    68.0
35539    23.0
35540    31.0
35541    29.0
35542    34.0
35543     NaN
35544     NaN
35545     NaN
35546    14.0
35547    51.0
35548     NaN

[35549 rows x 9 columns]</code></pre>
</div>
<p>Don’t worry: all the data is there! You can confirm this by scrolling
upwards, or by looking at the <code>[# of rows x # of columns]</code>
block at the end of the output.</p>
<p>You can also use <code>surveys_df.head()</code> to view only the
first few rows of the dataset in an output that is easier to fit in one
window. After doing this, you can see that pandas has neatly formatted
the data to fit our screen:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>surveys_df.head() <span class="co"># The head() method displays the first several lines of a file. It</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                  <span class="co"># is discussed below.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
5          6      7   16  1977        1         PF   M             14.0
6          7      7   16  1977        2         PE   F              NaN
7          8      7   16  1977        1         DM   M             37.0
8          9      7   16  1977        1         DM   F             34.0
9         10      7   16  1977        6         PF   F             20.0

   weight
5     NaN
6     NaN
7     NaN
8     NaN
9     NaN</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="exploring-our-species-survey-data">Exploring Our Species Survey Data<a class="anchor" aria-label="anchor" href="#exploring-our-species-survey-data"></a>
</h3>
<p>Again, we can use the <code>type</code> function to see what kind of
thing <code>surveys_df</code> is:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="bu">type</span>(surveys_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
<p>As expected, it’s a DataFrame (or, to use the full name that Python
uses to refer to it internally, a
<code>pandas.core.frame.DataFrame</code>).</p>
<p>What kind of things does <code>surveys_df</code> contain? DataFrames
have an attribute called <code>dtypes</code> that answers this:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>surveys_df.dtypes</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id            int64
month                int64
day                  int64
year                 int64
plot_id              int64
species_id          object
sex                 object
hindfoot_length    float64
weight             float64
dtype: object</code></pre>
</div>
<p>All the values in a single column have the same type. For example,
values in the month column have type <code>int64</code>, which is a kind
of integer. Cells in the month column cannot have fractional values, but
values in weight and hindfoot_length columns can, because they have type
<code>float64</code>. The <code>object</code> type doesn’t have a very
helpful name, but in this case it represents strings (such as ‘M’ and
‘F’ in the case of sex).</p>
<p>We’ll talk a bit more about what the different formats mean in a
different lesson.</p>
<div class="section level4">
<h4 id="useful-ways-to-view-dataframe-objects-in-python">Useful Ways to View DataFrame Objects in Python<a class="anchor" aria-label="anchor" href="#useful-ways-to-view-dataframe-objects-in-python"></a>
</h4>
<p>There are many ways to summarize and access the data stored in
DataFrames, using <strong>attributes</strong> and
<strong>methods</strong> provided by the DataFrame object.</p>
<p>Attributes are features of an object. For example, the
<code>shape</code> attribute will output the size (the number of rows
and columns) of an object. To access an attribute, use the DataFrame
object name followed by the attribute name
<code>df_object.attribute</code>. For example, using the DataFrame
<code>surveys_df</code> and attribute <code>columns</code>, an index of
all the column names in the DataFrame can be accessed with
<code>surveys_df.columns</code>.</p>
<p>Methods are like functions, but they only work on particular kinds of
objects. As an example, <strong>the <code>head()</code> method</strong>
works on DataFrames. Methods are called in a similar fashion to
attributes, using the syntax <code>df_object.method()</code>. Using
<code>surveys_df.head()</code> gets the first few rows in the DataFrame
<code>surveys_df</code> using the <code>head()</code> method. With a
method, we can supply extra information in the parentheses to control
behaviour.</p>
<p>Let’s look at the data using these.</p>
<div id="challenge---dataframes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---dataframes" class="callout-inner">
<h3 class="callout-title">Challenge - DataFrames<a class="anchor" aria-label="anchor" href="#challenge---dataframes"></a>
</h3>
<div class="callout-content">
<p>Using our DataFrame <code>surveys_df</code>, try out the
<strong>attributes</strong> &amp; <strong>methods</strong> below to see
what they return.</p>
<ol style="list-style-type: decimal">
<li><p><code>surveys_df.columns</code></p></li>
<li><p><code>surveys_df.shape</code> Take note of the output of
<code>shape</code> - what format does it return the shape of the
DataFrame in?</p></li>
</ol>
<p>HINT: <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" class="external-link">More
on tuples, here</a>.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><code>surveys_df.head()</code> Also, what does
<code>surveys_df.head(15)</code> do?</p></li>
<li><p><code>surveys_df.tail()</code></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<code>surveys_df.columns</code> provides the names of the columns in
the DataFrame.</li>
<li>
<code>surveys_df.shape</code> provides the dimensions of the
DataFrame as a tuple in <code>(r,c)</code> format, where <code>r</code>
is the number of rows and <code>c</code> the number of columns.</li>
<li>
<code>surveys_df.head()</code> returns the first 5 lines of the
DataFrame, annotated with column and row labels. Adding an integer as an
argument to the function specifies the number of lines to display from
the top of the DataFrame, e.g. <code>surveys_df.head(15)</code> will
return the first 15 lines.</li>
<li>
<code>surveys_df.tail()</code> will display the last 5 lines, and
behaves similarly to the <code>head()</code> method.</li>
</ol>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Recapping object (im)mutability</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Working through solutions to the challenge above can provide a good
opportunity to recap about mutability and immutability of different
objects. Show that the DataFrame index ( the <code>columns</code>
attribute) is immutable, e.g. 
<code>surveys_df.columns[4] = "plotid"</code> returns a
<code>TypeError</code>.</p>
<p>Adapting the name is done with the <code>rename</code> function:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>surveys_df.rename(columns<span class="op">=</span>{<span class="st">"plot_id"</span>: <span class="st">"plotid"</span>})`)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="calculating-statistics-from-data-in-a-pandas-dataframe">Calculating Statistics From Data In A Pandas DataFrame<a class="anchor" aria-label="anchor" href="#calculating-statistics-from-data-in-a-pandas-dataframe"></a>
</h3>
<p>We’ve read our data into Python. Next, let’s perform some quick
summary statistics to learn more about the data that we’re working with.
We might want to know how many animals were collected in each site, or
how many of each species were caught. We can perform summary stats
quickly using groups. But first we need to figure out what we want to
group by.</p>
<p>Let’s begin by exploring our data:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Look at the column names</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>surveys_df.columns</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index(['record_id', 'month', 'day', 'year', 'plot_id', 'species_id', 'sex',
       'hindfoot_length', 'weight'],
      dtype='object')</code></pre>
</div>
<p>Let’s get a list of all the species. The <code>pd.unique</code>
function tells us all of the unique values in the
<code>species_id</code> column.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>pd.unique(surveys_df[<span class="st">'species_id'</span>])</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array(['NL', 'DM', 'PF', 'PE', 'DS', 'PP', 'SH', 'OT', 'DO', 'OX', 'SS',
       'OL', 'RM', nan, 'SA', 'PM', 'AH', 'DX', 'AB', 'CB', 'CM', 'CQ',
       'RF', 'PC', 'PG', 'PH', 'PU', 'CV', 'UR', 'UP', 'ZL', 'UL', 'CS',
       'SC', 'BA', 'SF', 'RO', 'AS', 'SO', 'PI', 'ST', 'CU', 'SU', 'RX',
       'PB', 'PL', 'PX', 'CT', 'US'], dtype=object)</code></pre>
</div>
<div id="challenge---statistics" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---statistics" class="callout-inner">
<h3 class="callout-title">Challenge - Statistics<a class="anchor" aria-label="anchor" href="#challenge---statistics"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a list of unique site IDs (“plot_id”) found in the surveys
data. Call it <code>site_names</code>. How many unique sites are there
in the data? How many unique species are in the data?</p></li>
<li><p>What is the difference between <code>len(site_names)</code> and
<code>surveys_df['plot_id'].nunique()</code>?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><code>site_names = pd.unique(surveys_df["plot_id"])</code></li>
</ol>
<ul>
<li>How many unique sites are in the data? <code>site_names.size</code>
or <code>len(site_names)</code> provide the answer: 24</li>
<li>How many unique species are in the data?
<code>len(pd.unique(surveys_df["species_id"]))</code> tells us there are
49 species</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>
<code>len(site_names)</code> and
<code>surveys_df['plot_id'].nunique()</code> both provide the same
output: they are alternative ways of getting the unique values. The
<code>nunique</code> method combines the count and unique value
extraction, and can help avoid the creation of intermediate variables
like <code>site_names</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</section><section id="groups-in-pandas"><h2 class="section-heading">Groups in Pandas<a class="anchor" aria-label="anchor" href="#groups-in-pandas"></a>
</h2>
<hr class="half-width">
<p>We often want to calculate summary statistics grouped by subsets or
attributes within fields of our data. For example, we might want to
calculate the average weight of all individuals per site.</p>
<p>We can calculate basic statistics for all records in a single column
using the syntax below:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].describe()</span></code></pre>
</div>
<p>gives <strong>output</strong></p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>count    <span class="fl">32283.000000</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>mean        <span class="fl">42.672428</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>std         <span class="fl">36.631259</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="bu">min</span>          <span class="fl">4.000000</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="dv">25</span><span class="op">%</span>         <span class="fl">20.000000</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="dv">50</span><span class="op">%</span>         <span class="fl">37.000000</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="dv">75</span><span class="op">%</span>         <span class="fl">48.000000</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="bu">max</span>        <span class="fl">280.000000</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>Name: weight, dtype: float64</span></code></pre>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Important Bug Note</h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" aria-labelledby="headingInstructor2" data-bs-parent="#accordionInstructor2">
<div class="accordion-body">
<p>In pandas prior to version 0.18.1 there is a bug causing
<code>surveys_df['weight'].describe()</code> to return a runtime
error.</p>
</div>
</div>
</div>
</div>
<p>We can also extract one specific metric if we wish:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">min</span>()</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].<span class="bu">max</span>()</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].mean()</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].std()</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].count()</span></code></pre>
</div>
<p>But if we want to summarize by one or more variables, for example
sex, we can use <strong>Pandas’ <code>.groupby</code> method</strong>.
Once we’ve created a groupby DataFrame, we can quickly calculate summary
statistics by a group of our choice.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Group data by sex</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>grouped_data <span class="op">=</span> surveys_df.groupby(<span class="st">'sex'</span>)</span></code></pre>
</div>
<p>The <strong>pandas function <code>describe</code></strong> will
return descriptive stats including: mean, median, max, min, std and
count for a particular column in the data. Pandas’ <code>describe</code>
function will only return summary values for columns containing numeric
data.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Summary statistics for all numeric columns by sex</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>grouped_data.describe()</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># Provide the mean for each numeric column by sex</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>grouped_data.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<p><code>grouped_data.mean(numeric_only=True)</code>
<strong>OUTPUT:</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        record_id     month        day         year    plot_id  \
sex
F    18036.412046  6.583047  16.007138  1990.644997  11.440854
M    17754.835601  6.392668  16.184286  1990.480401  11.098282

     hindfoot_length     weight
sex
F          28.836780  42.170555
M          29.709578  42.995379
</code></pre>
</div>
<p>The <code>groupby</code> command is powerful in that it allows us to
quickly generate summary stats.</p>
<div id="challenge---summary-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---summary-data" class="callout-inner">
<h3 class="callout-title">Challenge - Summary Data<a class="anchor" aria-label="anchor" href="#challenge---summary-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>How many recorded individuals are female <code>F</code> and how many
male <code>M</code>?</li>
<li>What happens when you group by two columns using the following
syntax and then calculate mean values?</li>
</ol>
<ul>
<li><code>grouped_data2 = surveys_df.groupby(['plot_id', 'sex'])</code></li>
<li><code>grouped_data2.mean(numeric_only=True)</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Summarize weight values for each site in your data. HINT: you can
use the following syntax to only create summary statistics for one
column in your data. <code>by_site['weight'].describe()</code>
</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>The first column of output from <code>grouped_data.describe()</code>
(count) tells us that the data contains 15690 records for female
individuals and 17348 records for male individuals.
<ul>
<li>Note that these two numbers do not sum to 35549, the total number of
rows we know to be in the <code>surveys_df</code> DataFrame. Why do you
think some records were excluded from the grouping?</li>
</ul>
</li>
<li>Calling the <code>mean()</code> method on data grouped by these two
columns calculates and returns the mean value for each combination of
plot and sex.
<ul>
<li>Note that the mean is not meaningful for some variables, e.g. day,
month, and year. You can specify particular columns and particular
summary statistics using the <code>agg()</code> method (short for
<em>aggregate</em>), e.g. to obtain the last survey year, median
foot-length and mean weight for each plot/sex combination:</li>
</ul>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>surveys_df.groupby([<span class="st">'plot_id'</span>, <span class="st">'sex'</span>]).agg({<span class="st">"year"</span>: <span class="st">'max'</span>,</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>                                           <span class="st">"hindfoot_length"</span>: <span class="st">'median'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                                           <span class="st">"weight"</span>: <span class="st">'mean'</span>})</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li><code>surveys_df.groupby(['plot_id'])['weight'].describe()</code></li>
</ol>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          count       mean        std  min   25%   50%   75%    max
plot_id                                                            
1        1903.0  51.822911  38.176670  4.0  30.0  44.0  53.0  231.0
2        2074.0  52.251688  46.503602  5.0  24.0  41.0  50.0  278.0
3        1710.0  32.654386  35.641630  4.0  14.0  23.0  36.0  250.0
4        1866.0  47.928189  32.886598  4.0  30.0  43.0  50.0  200.0
5        1092.0  40.947802  34.086616  5.0  21.0  37.0  48.0  248.0
6        1463.0  36.738893  30.648310  5.0  18.0  30.0  45.0  243.0
7         638.0  20.663009  21.315325  4.0  11.0  17.0  23.0  235.0
8        1781.0  47.758001  33.192194  5.0  26.0  44.0  51.0  178.0
9        1811.0  51.432358  33.724726  6.0  36.0  45.0  50.0  275.0
10        279.0  18.541219  20.290806  4.0  10.0  12.0  21.0  237.0
11       1793.0  43.451757  28.975514  5.0  26.0  42.0  48.0  212.0
12       2219.0  49.496169  41.630035  6.0  26.0  42.0  50.0  280.0
13       1371.0  40.445660  34.042767  5.0  20.5  33.0  45.0  241.0
14       1728.0  46.277199  27.570389  5.0  36.0  44.0  49.0  222.0
15        869.0  27.042578  35.178142  4.0  11.0  18.0  26.0  259.0
16        480.0  24.585417  17.682334  4.0  12.0  20.0  34.0  158.0
17       1893.0  47.889593  35.802399  4.0  27.0  42.0  50.0  216.0
18       1351.0  40.005922  38.480856  5.0  17.5  30.0  44.0  256.0
19       1084.0  21.105166  13.269840  4.0  11.0  19.0  27.0  139.0
20       1222.0  48.665303  50.111539  5.0  17.0  31.0  47.0  223.0
21       1029.0  24.627794  21.199819  4.0  10.0  22.0  31.0  190.0
22       1298.0  54.146379  38.743967  5.0  29.0  42.0  54.0  212.0
23        369.0  19.634146  18.382678  4.0  10.0  14.0  23.0  199.0
24        960.0  43.679167  45.936588  4.0  19.0  27.5  45.0  251.0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="quickly-creating-summary-counts-in-pandas">Quickly Creating Summary Counts in Pandas<a class="anchor" aria-label="anchor" href="#quickly-creating-summary-counts-in-pandas"></a>
</h3>
<p>Let’s next count the number of samples for each species. We can do
this in a few ways, but we’ll use <code>groupby</code> combined with
<strong>a <code>count()</code> method</strong>.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># Count the number of samples by species</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>species_counts <span class="op">=</span> surveys_df.groupby(<span class="st">'species_id'</span>)[<span class="st">'record_id'</span>].count()</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="bu">print</span>(species_counts)</span></code></pre>
</div>
<p>Or, we can also count just the rows that have the species “DO”:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>surveys_df.groupby(<span class="st">'species_id'</span>)[<span class="st">'record_id'</span>].count()[<span class="st">'DO'</span>]</span></code></pre>
</div>
<div id="challenge---make-a-list" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---make-a-list" class="callout-inner">
<h3 class="callout-title">Challenge - Make a list<a class="anchor" aria-label="anchor" href="#challenge---make-a-list"></a>
</h3>
<div class="callout-content">
<p>What’s another way to create a list of species and associated
<code>count</code> of the records in the data? Hint: you can perform
<code>count</code>, <code>min</code>, etc. functions on groupby
DataFrames in the same way you can perform them on regular
DataFrames.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>As well as calling <code>count()</code> on the <code>record_id</code>
column of the grouped DataFrame as above, an equivalent result can be
obtained by extracting <code>record_id</code> from the result of
<code>count()</code> called directly on the grouped DataFrame:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>surveys_df.groupby(<span class="st">'species_id'</span>).count()[<span class="st">'record_id'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species_id
AB      303
AH      437
AS        2
BA       46
CB       50
CM       13
CQ       16
CS        1
CT        1
CU        1
CV        1
DM    10596
DO     3027
DS     2504
DX       40
NL     1252
OL     1006
OT     2249
OX       12
PB     2891
PC       39
PE     1299
PF     1597
PG        8
PH       32
PI        9
PL       36
PM      899
PP     3123
PU        5
PX        6
RF       75
RM     2609
RO        8
RX        2
SA       75
SC        1
SF       43
SH      147
SO       43
SS      248
ST        1
SU        5
UL        4
UP        8
UR       10
US        4
ZL        2</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="basic-math-functions">Basic Math Functions<a class="anchor" aria-label="anchor" href="#basic-math-functions"></a>
</h3>
<p>If we wanted to, we could apply a mathematical operation like
addition or division on an entire column of our data. For example, let’s
multiply all weight values by 2.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Multiply all weight values by 2</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>]<span class="op">*</span><span class="dv">2</span></span></code></pre>
</div>
<p>A more practical use of this might be to normalize the data according
to a mean, area, or some other value calculated from our data.</p>
</div>
</section><section id="quick-easy-plotting-data-using-pandas"><h2 class="section-heading">Quick &amp; Easy Plotting Data Using Pandas<a class="anchor" aria-label="anchor" href="#quick-easy-plotting-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We can plot our summary stats using Pandas, too.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Make sure figures appear inline in Ipython Notebook</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co"># Create a quick bar chart</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>species_counts.plot(kind<span class="op">=</span><span class="st">'bar'</span>)<span class="op">;</span></span></code></pre>
</div>
<p><img src="../fig/countPerSpecies.png" alt="Weight by Species Site" class="figure">
Count per species site</p>
<p>We can also look at how many animals were captured in each site:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>total_count <span class="op">=</span> surveys_df.groupby(<span class="st">'plot_id'</span>)[<span class="st">'record_id'</span>].nunique()</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co"># Let's plot that too</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>total_count.plot(kind<span class="op">=</span><span class="st">'bar'</span>)<span class="op">;</span></span></code></pre>
</div>
<div id="challenge---plots" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---plots" class="callout-inner">
<h3 class="callout-title">Challenge - Plots<a class="anchor" aria-label="anchor" href="#challenge---plots"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a plot of average weight across all species per site.</li>
<li>Create a plot of total males versus total females for the entire
dataset.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><code>surveys_df.groupby('plot_id').mean()["weight"].plot(kind='bar')</code></li>
</ol>
<figure><img src="../fig/01_chall_bar_meanweight.png" alt="average weight across all species for each plot" class="figure mx-auto d-block"></figure><ol start="2" style="list-style-type: decimal">
<li><code>surveys_df.groupby('sex').count()["record_id"].plot(kind='bar')</code></li>
</ol>
<figure><img src="../fig/01_chall_bar_totalsex.png" alt="total males versus total females for the entire dataset" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="summary-plotting-challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="summary-plotting-challenge" class="callout-inner">
<h3 class="callout-title">Summary Plotting Challenge<a class="anchor" aria-label="anchor" href="#summary-plotting-challenge"></a>
</h3>
<div class="callout-content">
<p>Create a stacked bar plot, with weight on the Y axis, and the stacked
variable being sex. The plot should show total weight by sex for each
site. Some tips are below to help you solve this challenge:</p>
<ul>
<li>For more information on pandas plots, see <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html#basic-plotting-plot" class="external-link">pandas’
documentation page on visualization</a>.</li>
<li>You can use the code that follows to create a stacked bar plot but
the data to stack need to be in individual columns. Here’s a simple
example with some data where ‘a’, ‘b’, and ‘c’ are the groups, and ‘one’
and ‘two’ are the subgroups.</li>
</ul>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>d <span class="op">=</span> {<span class="st">'one'</span> : pd.Series([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>], index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>]), <span class="st">'two'</span> : pd.Series([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>, <span class="fl">4.</span>], index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])}</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>pd.DataFrame(d)</span></code></pre>
</div>
<p>shows the following data</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      one  two
  a    1    1
  b    2    2
  c    3    3
  d  NaN    4</code></pre>
</div>
<p>We can plot the above with</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Plot stacked data so columns 'one' and 'two' are stacked</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>my_df <span class="op">=</span> pd.DataFrame(d)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>my_df.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">"The title of my graph"</span>)</span></code></pre>
</div>
<figure><img src="../fig/stackedBar1.png" alt="Stacked Bar Plot" class="figure mx-auto d-block"></figure><ul>
<li>You can use the <code>.unstack()</code> method to transform grouped
data into columns for each plotting. Try running <code>.unstack()</code>
on some DataFrames above and see what it yields.</li>
</ul>
<p>Start by transforming the grouped data (by site and sex) into an
unstacked layout, then create a stacked plot.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Solution to Summary Challenge</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>First we group data by site and by sex, and then calculate a total
for each site.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>, <span class="st">'sex'</span>])</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
<p>This calculates the sums of weights for each sex within each site as
a table</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>site  sex
plot_id  sex
1        F      38253
         M      59979
2        F      50144
         M      57250
3        F      27251
         M      28253
4        F      39796
         M      49377
&lt;other sites removed for brevity&gt;</code></pre>
</div>
<p>Below we’ll use <code>.unstack()</code> on our grouped data to figure
out the total weight that each sex contributed to each site.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>, <span class="st">'sex'</span>])</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>site_sex_count.unstack()</span></code></pre>
</div>
<p>The <code>unstack</code> method above will display the following
output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sex          F      M
plot_id
1        38253  59979
2        50144  57250
3        27251  28253
4        39796  49377
&lt;other sites removed for brevity&gt;</code></pre>
</div>
<p>Now, create a stacked bar plot with that data where the weights for
each sex are stacked by site.</p>
<p>Rather than display it as a table, we can plot the above data by
stacking the values of each sex as follows:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>by_site_sex <span class="op">=</span> surveys_df.groupby([<span class="st">'plot_id'</span>, <span class="st">'sex'</span>])</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>site_sex_count <span class="op">=</span> by_site_sex[<span class="st">'weight'</span>].<span class="bu">sum</span>()</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>spc <span class="op">=</span> site_sex_count.unstack()</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>s_plot <span class="op">=</span> spc.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">"Total weight by site and sex"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>s_plot.set_ylabel(<span class="st">"Weight"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>s_plot.set_xlabel(<span class="st">"Plot"</span>)</span></code></pre>
</div>
<figure><img src="../fig/stackedBar.png" alt="Stacked Bar Plot" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Libraries enable us to extend the functionality of Python.</li>
<li>Pandas is a popular library for working with data.</li>
<li>A Dataframe is a Pandas data structure that allows one to access
data by column (name or index) or row.</li>
<li>Aggregating data using the <code>groupby()</code> function enables
you to generate useful summaries of data quickly.</li>
<li>Plots can be created from DataFrames or subsets of data that have
been generated with <code>groupby()</code>.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-03-index-slice-subset"><p>Content from <a href="03-index-slice-subset.html">Indexing, Slicing and Subsetting DataFrames in Python</a></p>
<hr>
<p>Last updated on 2024-02-26 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/03-index-slice-subset.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I access specific data within my data set?</li>
<li>How can Python and Pandas help me to analyse my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what 0-based indexing is.</li>
<li>Manipulate and extract data using column headings and index
locations.</li>
<li>Employ slicing to select sets of data from a DataFrame.</li>
<li>Employ label and integer-based indexing to select ranges of data in
a dataframe.</li>
<li>Reassign values within subsets of a DataFrame.</li>
<li>Create a copy of a DataFrame.</li>
<li>Query / select a subset of data using a set of criteria using the
following operators: <code>==</code>, <code>!=</code>,
<code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>,
<code>&lt;=</code>.</li>
<li>Locate subsets of data using masks.</li>
<li>Describe BOOLEAN objects in Python and manipulate data using
BOOLEANs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Tip: use <code>.head()</code> method throughout this lesson to keep
your display neater for students. Encourage students to try with and
without <code>.head()</code> to reinforce this useful tool and then to
use it or not at their preference.</p>
<p>For example, if a student worries about keeping up in pace with
typing, let them know they can skip the <code>.head()</code>, but that
you’ll use it to keep more lines of previous steps visible.</p>
</div>
</div>
</div>
</div>
<p>In the first episode of this lesson, we read a CSV file into a
pandas’ DataFrame. We learned how to:</p>
<ul>
<li>save a DataFrame to a named object,</li>
<li>perform basic math on data,</li>
<li>calculate summary statistics, and</li>
<li>create plots based on the data we loaded into pandas.</li>
</ul>
<p>In this lesson, we will explore ways to access different parts of the
data using:</p>
<ul>
<li>indexing,</li>
<li>slicing, and</li>
<li>subsetting.</li>
</ul>
<section id="loading-our-data"><h2 class="section-heading">Loading our data<a class="anchor" aria-label="anchor" href="#loading-our-data"></a>
</h2>
<hr class="half-width">
<p>We will continue to use the surveys dataset that we worked with in
the last episode. Let’s reopen and read in the data again:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Make sure pandas is loaded</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Read in the survey CSV</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
</section><section id="indexing-and-slicing-in-python"><h2 class="section-heading">Indexing and Slicing in Python<a class="anchor" aria-label="anchor" href="#indexing-and-slicing-in-python"></a>
</h2>
<hr class="half-width">
<p>We often want to work with subsets of a <strong>DataFrame</strong>
object. There are different ways to accomplish this including: using
labels (column headings), numeric ranges, or specific x,y index
locations.</p>
</section><section id="selecting-data-using-labels-column-headings"><h2 class="section-heading">Selecting data using Labels (Column Headings)<a class="anchor" aria-label="anchor" href="#selecting-data-using-labels-column-headings"></a>
</h2>
<hr class="half-width">
<p>We use square brackets <code>[]</code> to select a subset of a Python
object. For example, we can select all data from a column named
<code>species_id</code> from the <code>surveys_df</code> DataFrame by
name. There are two ways to do this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># TIP: use the .head() method we saw earlier to make output shorter</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Method 1: select a 'subset' of the data using the column name</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>surveys_df[<span class="st">'species_id'</span>]</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Method 2: use the column name as an 'attribute'; gives the same output</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>surveys_df.species_id</span></code></pre>
</div>
<p>We can also create a new object that contains only the data within
the <code>species_id</code> column as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Creates an object, surveys_species, that only contains the `species_id` column</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>surveys_species <span class="op">=</span> surveys_df[<span class="st">'species_id'</span>]</span></code></pre>
</div>
<p>We can pass a list of column names too, as an index to select columns
in that order. This is useful when we need to reorganize our data.</p>
<p><strong>NOTE:</strong> If a column name is not contained in the
DataFrame, an exception (error) will be raised.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Select the species and plot columns from the DataFrame</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>surveys_df[[<span class="st">'species_id'</span>, <span class="st">'plot_id'</span>]]</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># What happens when you flip the order?</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>surveys_df[[<span class="st">'plot_id'</span>, <span class="st">'species_id'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># What happens if you ask for a column that doesn't exist?</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>surveys_df[<span class="st">'speciess'</span>]</span></code></pre>
</div>
<p>Python tells us what type of error it is in the traceback, at the
bottom it says <code>KeyError: 'speciess'</code> which means that
<code>speciess</code> is not a valid column name (nor a valid key in the
related Python data type dictionary).</p>
<div id="reminder" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reminder" class="callout-inner">
<h3 class="callout-title">Reminder<a class="anchor" aria-label="anchor" href="#reminder"></a>
</h3>
<div class="callout-content">
<p>The Python language and its modules (such as Pandas) define reserved
words that should not be used as identifiers when assigning objects and
variable names. Examples of reserved words in Python include Boolean
values <code>True</code> and <code>False</code>, operators
<code>and</code>, <code>or</code>, and <code>not</code>, among others.
The full list of reserved words for Python version 3 is provided at <a href="https://docs.python.org/3/reference/lexical_analysis.html#identifiers" class="external-link">https://docs.python.org/3/reference/lexical_analysis.html#identifiers</a>.</p>
<p>When naming objects and variables, it’s also important to avoid using
the names of built-in data structures and methods. For example, a
<em>list</em> is a built-in data type. It is possible to use the word
‘list’ as an identifier for a new object, for example
<code>list = ['apples', 'oranges', 'bananas']</code>. However, you would
then be unable to create an empty list using <code>list()</code> or
convert a tuple to a list using <code>list(sometuple)</code>.</p>
</div>
</div>
</div>
</section><section id="extracting-range-based-subsets-slicing"><h2 class="section-heading">Extracting Range based Subsets: Slicing<a class="anchor" aria-label="anchor" href="#extracting-range-based-subsets-slicing"></a>
</h2>
<hr class="half-width">
<div id="reminder-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reminder-1" class="callout-inner">
<h3 class="callout-title">Reminder<a class="anchor" aria-label="anchor" href="#reminder-1"></a>
</h3>
<div class="callout-content">
<p>Python uses 0-based indexing.</p>
</div>
</div>
</div>
<p>Let’s remind ourselves that Python uses 0-based indexing. This means
that the first element in an object is located at position
<code>0</code>. This is different from other tools like R and Matlab
that index elements within objects starting at 1.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Create a list of numbers:</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code></pre>
</div>
<p><img src="../fig/slicing-indexing.png" alt="indexing diagram" class="figure"><img src="../fig/slicing-slicing.png" alt="slicing diagram" class="figure"></p>
<div id="challenge---extracting-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---extracting-data" class="callout-inner">
<h3 class="callout-title">Challenge - Extracting data<a class="anchor" aria-label="anchor" href="#challenge---extracting-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>
<p>What value does the code below return?</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>a[<span class="dv">0</span>]</span></code></pre>
</div>
</li>
<li>
<p>How about this:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>a[<span class="dv">5</span>]</span></code></pre>
</div>
</li>
<li><p>In the example above, calling <code>a[5]</code> returns an error.
Why is that?</p></li>
<li>
<p>What about?</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>a[<span class="bu">len</span>(a)]</span></code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p><code>a[0]</code> returns <code>1</code>, as Python starts with
element 0 (this may be different from what you have previously
experience with other languages e.g. MATLAB and R)</p></li>
<li><p><code>a[5]</code> raises an <code>IndexError</code></p></li>
<li><p>The error is raised because the list <code>a</code> has no
element with index 5: it has only five entries, indexed from 0 to
4.</p></li>
<li>
<p><code>a[len(a)]</code> also raises an <code>IndexError</code>.
<code>len(a)</code> returns <code>5</code>, making
<code>a[len(a)]</code> equivalent to <code>a[5]</code>. To retreive the
final element of a list, us the index <code>-1</code>, e.g.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>a[<span class="op">-</span><span class="dv">1</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">5</span></span></code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="slicing-subsets-of-rows-in-python"><h2 class="section-heading">Slicing Subsets of Rows in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-in-python"></a>
</h2>
<hr class="half-width">
<p>Slicing using the <code>[]</code> operator selects a set of rows
and/or columns from a DataFrame. To slice out a set of rows, you use the
following syntax: <code>data[start:stop]</code>. When slicing in pandas
the start bound is included in the output. The stop bound is one step
BEYOND the row you want to select. So if you want to select rows 0, 1
and 2 your code would look like this:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Select rows 0, 1, 2 (row 3 is not selected)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>surveys_df[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre>
</div>
<p>The stop bound in Python is different from what you might be used to
in languages like Matlab and R.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Select the first 5 rows (rows 0, 1, 2, 3, 4)</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>surveys_df[:<span class="dv">5</span>]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># Select the last element in the list</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># (the slice starts at the last element, and ends at the end of the list)</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>surveys_df[<span class="op">-</span><span class="dv">1</span>:]</span></code></pre>
</div>
<p>We can also reassign values within subsets of our DataFrame.</p>
<p>But before we do that, let’s look at the difference between the
concept of copying objects and the concept of referencing objects in
Python.</p>
</section><section id="copying-objects-vs-referencing-objects-in-python"><h2 class="section-heading">Copying Objects vs Referencing Objects in Python<a class="anchor" aria-label="anchor" href="#copying-objects-vs-referencing-objects-in-python"></a>
</h2>
<hr class="half-width">
<p>Let’s start with an example:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Using the 'copy() method'</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>true_copy_surveys_df <span class="op">=</span> surveys_df.copy()</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Using the '=' operator</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>ref_surveys_df <span class="op">=</span> surveys_df</span></code></pre>
</div>
<p>You might think that the code
<code>ref_surveys_df = surveys_df</code> creates a fresh distinct copy
of the <code>surveys_df</code> DataFrame object. However, using the
<code>=</code> operator in the simple statement <code>y = x</code> does
<strong>not</strong> create a copy of our DataFrame. Instead,
<code>y = x</code> creates a new variable <code>y</code> that references
the <strong>same</strong> object that <code>x</code> refers to. To state
this another way, there is only <strong>one</strong> object (the
DataFrame), and both <code>x</code> and <code>y</code> refer to it.</p>
<p>In contrast, the <code>copy()</code> method for a DataFrame creates a
true copy of the DataFrame.</p>
<p>Let’s look at what happens when we reassign the values within a
subset of the DataFrame that references another DataFrame object:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Assign the value `0` to the first three rows of data in the DataFrame</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>ref_surveys_df[<span class="dv">0</span>:<span class="dv">3</span>] <span class="op">=</span> <span class="dv">0</span></span></code></pre>
</div>
<p>Let’s try the following code:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># ref_surveys_df was created using the '=' operator</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>ref_surveys_df.head()</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># true_copy_surveys_df was created using the copy() function</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>true_copy_surveys_df.head()</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># surveys_df is the original dataframe</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>surveys_df.head()</span></code></pre>
</div>
<p>What is the difference between these three dataframes?</p>
<p>When we assigned the first 3 rows the value of <code>0</code> using
the <code>ref_surveys_df</code> DataFrame, the <code>surveys_df</code>
DataFrame is modified too. Remember we created the reference
<code>ref_surveys_df</code> object above when we did
<code>ref_surveys_df = surveys_df</code>. Remember
<code>surveys_df</code> and <code>ref_surveys_df</code> refer to the
same exact DataFrame object. If either one changes the object, the other
will see the same changes to the reference object.</p>
<p>However - <code>true_copy_surveys_df</code> was created via the
<code>copy()</code> function. It retains the original values for the
first three rows.</p>
<p><strong>To review and recap</strong>:</p>
<ul>
<li>
<p><strong>Copy</strong> uses the dataframe’s <code>copy()</code>
method</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>true_copy_surveys_df <span class="op">=</span> surveys_df.copy()</span></code></pre>
</div>
</li>
<li>
<p>A <strong>Reference</strong> is created using the <code>=</code>
operator</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>ref_surveys_df <span class="op">=</span> surveys_df</span></code></pre>
</div>
</li>
</ul>
<p>Okay, that’s enough of that. Let’s create a brand new clean dataframe
from the original data CSV file.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
</section><section id="slicing-subsets-of-rows-and-columns-in-python"><h2 class="section-heading">Slicing Subsets of Rows and Columns in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-and-columns-in-python"></a>
</h2>
<hr class="half-width">
<p>We can select specific ranges of our data in both the row and column
directions using either label or integer-based indexing.</p>
<ul>
<li><p><code>iloc</code> is primarily an <em>integer</em> based indexing
counting from 0. That is, your specify rows and columns giving a number.
Thus, the first row is row 0, the second column is column 1,
etc.</p></li>
<li><p><code>loc</code> is primarily a <em>label</em> based indexing
where you can refer to rows and columns by their name. E.g., column
‘month’. Note that <em>integers</em> may be used, but they are
interpreted as a <em>label</em>.</p></li>
</ul>
<p>To select a subset of rows <strong>and</strong> columns from our
DataFrame, we can use the <code>iloc</code> method. For example, we can
select month, day and year (columns 2, 3 and 4 if we start counting at
1), like this:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># iloc[row slicing, column slicing]</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>surveys_df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]</span></code></pre>
</div>
<p>which gives the <strong>output</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   month  day  year
0      7   16  1977
1      7   16  1977
2      7   16  1977</code></pre>
</div>
<p>Notice that we asked for a slice from 0:3. This yielded 3 rows of
data. When you ask for 0:3, you are actually telling Python to start at
index 0 and select rows 0, 1, 2 <strong>up to but not including
3</strong>.</p>
<p>Let’s explore some other ways to index and select subsets of
data:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Select all columns for rows of index values 0 and 10</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>], :]</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># What does this do?</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>surveys_df.loc[<span class="dv">0</span>, [<span class="st">'species_id'</span>, <span class="st">'plot_id'</span>, <span class="st">'weight'</span>]]</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># What happens when you type the code below?</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>surveys_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">35549</span>], :]</span></code></pre>
</div>
<p><strong>NOTE</strong>: Labels must be found in the DataFrame or you
will get a <code>KeyError</code>.</p>
<p>Indexing by labels <code>loc</code> differs from indexing by integers
<code>iloc</code>. With <code>loc</code>, both the start bound and the
stop bound are <strong>inclusive</strong>. When using <code>loc</code>,
integers <em>can</em> be used, but the integers refer to the index label
and not the position. For example, using <code>loc</code> and select 1:4
will get a different result than using <code>iloc</code> to select rows
1:4.</p>
<p>We can also select a specific data value using a row and column
location within the DataFrame and <code>iloc</code> indexing:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Syntax for iloc indexing to finding a specific data element</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>dat.iloc[row, column]</span></code></pre>
</div>
<p>In this <code>iloc</code> example,</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>surveys_df.iloc[<span class="dv">2</span>, <span class="dv">6</span>]</span></code></pre>
</div>
<p>gives the <strong>output</strong></p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'F'</span></span></code></pre>
</div>
<p>Remember that Python indexing begins at 0. So, the index location [2,
6] selects the element that is 3 rows down and 7 columns over in the
DataFrame.</p>
<p>It is worth noting that rows are selected when using <code>loc</code>
with a single list of labels (or <code>iloc</code> with a single list of
integers). However, unlike <code>loc</code> or <code>iloc</code>,
indexing a data frame directly with labels will select columns (e.g.
<code>surveys_df[['species_id', 'plot_id', 'weight']]</code>), while
ranges of integers will select rows
(e.g. <code>surveys\_df[0:13]</code>). Direct indexing of rows is
redundant with using <code>iloc</code>, and will raise a
<code>KeyError</code> if a single integer or list is used; the error
will also occur if index labels are used without <code>loc</code> (or
column labels used with it). A useful rule of thumb is the following:
integer-based slicing is best done with <code>iloc</code> and will avoid
errors (and is generally consistent with indexing of Numpy arrays),
label-based slicing of rows is done with <code>loc</code>, and slicing
of columns by directly indexing column names.</p>
<div id="challenge---range" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---range" class="callout-inner">
<h3 class="callout-title">Challenge - Range<a class="anchor" aria-label="anchor" href="#challenge---range"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens when you execute:
<ul>
<li><code>surveys_df[0:1]</code></li>
<li><code>surveys_df[0]</code></li>
<li><code>surveys_df[:4]</code></li>
<li><code>surveys_df[:-1]</code></li>
</ul>
</li>
<li>What happens when you call:
<ul>
<li><code>surveys_df.iloc[0:1]</code></li>
<li><code>surveys_df.iloc[0]</code></li>
<li><code>surveys_df.iloc[:4, :]</code></li>
<li><code>surveys_df.iloc[0:4, 1:4]</code></li>
<li><code>surveys_df.loc[0:4, 1:4]</code></li>
</ul>
</li>
<li>How are the last two commands different?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Selection Challenges</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<ul>
<li>
<code>surveys_df[0:3]</code> returns the first three rows of the
DataFrame:</li>
</ul>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      record_id  month  day  year  plot_id species_id sex  hindfoot_length  weight
0          1      7   16  1977        2         NL   M             32.0     NaN
1          2      7   16  1977        3         NL   M             33.0     NaN
2          3      7   16  1977        2         DM   F             37.0     NaN</code></pre>
</div>
<ul>
<li>
<code>surveys_df[0]</code> results in a ‘KeyError’, since direct
indexing of a row is redundant with <code>iloc</code>.</li>
<li>
<code>surveys_df[0:1]</code> can be used to obtain only the first
row.</li>
<li>
<code>surveys_df[:5]</code> slices from the first row to the
fifth:</li>
</ul>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  weight
0          1      7   16  1977        2         NL   M             32.0     NaN
1          2      7   16  1977        3         NL   M             33.0     NaN
2          3      7   16  1977        2         DM   F             37.0     NaN
3          4      7   16  1977        7         DM   M             36.0     NaN
4          5      7   16  1977        3         DM   M             35.0     NaN</code></pre>
</div>
<ul>
<li>
<code>surveys_df[:-1]</code> provides everything except the final
row of the DataFrame. You can use negative index numbers to count
backwards from the last entry.</li>
</ul>
</li>
<li><ul>
<li>
<code>surveys_df.iloc[0:1]</code> returns the first row</li>
<li>
<code>surveys_df.iloc[0]</code> returns the first row as a named
list</li>
<li>
<code>surveys_df.iloc[:4, :]</code> returns all columns of the first
four rows</li>
<li>
<code>surveys_df.iloc[0:4, 1:4]</code> selects specified columns of
the first four rows</li>
<li>
<code>surveys_df.loc[0:4, 1:4]</code> results in a ‘TypeError’ - see
below.</li>
</ul></li>
<li>While <code>iloc</code> uses integers as indices and slices
accordingly, <code>loc</code> works with labels. It is like accessing
values from a dictionary, asking for the key names. Column names 1:4 do
not exist, so the call to <code>loc</code> above results in an error.
Check also the difference between <code>surveys_df.loc[0:4]</code> and
<code>surveys_df.iloc[0:4]</code>.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="subsetting-data-using-criteria"><h2 class="section-heading">Subsetting Data using Criteria<a class="anchor" aria-label="anchor" href="#subsetting-data-using-criteria"></a>
</h2>
<hr class="half-width">
<p>We can also select a subset of our data using criteria. For example,
we can select all rows that have a year value of 2002:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span></code></pre>
</div>
<p>Which produces the following output:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>record_id  month  day  year  plot_id species_id  sex  hindfoot_length  weight</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="dv">33320</span>      <span class="dv">33321</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DM    M     <span class="dv">38</span>      <span class="dv">44</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="dv">33321</span>      <span class="dv">33322</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DO    M     <span class="dv">37</span>      <span class="dv">58</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="dv">33322</span>      <span class="dv">33323</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         PB    M     <span class="dv">28</span>      <span class="dv">45</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="dv">33323</span>      <span class="dv">33324</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         AB  NaN    NaN     NaN</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="dv">33324</span>      <span class="dv">33325</span>      <span class="dv">1</span>   <span class="dv">12</span>  <span class="dv">2002</span>        <span class="dv">1</span>         DO    M     <span class="dv">35</span>      <span class="dv">29</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>...</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="dv">35544</span>      <span class="dv">35545</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">15</span>         AH  NaN    NaN     NaN</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="dv">35545</span>      <span class="dv">35546</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">15</span>         AH  NaN    NaN     NaN</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="dv">35546</span>      <span class="dv">35547</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>       <span class="dv">10</span>         RM    F     <span class="dv">15</span>      <span class="dv">14</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="dv">35547</span>      <span class="dv">35548</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>        <span class="dv">7</span>         DO    M     <span class="dv">36</span>      <span class="dv">51</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="dv">35548</span>      <span class="dv">35549</span>     <span class="dv">12</span>   <span class="dv">31</span>  <span class="dv">2002</span>        <span class="dv">5</span>        NaN  NaN    NaN     NaN</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>[<span class="dv">2229</span> rows x <span class="dv">9</span> columns]</span></code></pre>
</div>
<p>Or we can select all rows that do not contain the year 2002:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>surveys_df[surveys_df.year <span class="op">!=</span> <span class="dv">2002</span>]</span></code></pre>
</div>
<p>We can define sets of criteria too:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>surveys_df[(surveys_df.year <span class="op">&gt;=</span> <span class="dv">1980</span>) <span class="op">&amp;</span> (surveys_df.year <span class="op">&lt;=</span> <span class="dv">1985</span>)]</span></code></pre>
</div>
<div class="section level3">
<h3 id="python-syntax-cheat-sheet">Python Syntax Cheat Sheet<a class="anchor" aria-label="anchor" href="#python-syntax-cheat-sheet"></a>
</h3>
<p>We can use the syntax below when querying data by criteria from a
DataFrame. Experiment with selecting various subsets of the “surveys”
data.</p>
<ul>
<li>Equals: <code>==</code>
</li>
<li>Not equals: <code>!=</code>
</li>
<li>Greater than: <code>&gt;</code>
</li>
<li>Less than: <code>&lt;</code>
</li>
<li>Greater than or equal to: <code>&gt;=</code>
</li>
<li>Less than or equal to: <code>&lt;=</code>
</li>
</ul>
<div id="challenge---queries" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---queries" class="callout-inner">
<h3 class="callout-title">Challenge - Queries<a class="anchor" aria-label="anchor" href="#challenge---queries"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Select a subset of rows in the <code>surveys_df</code> DataFrame
that contain data from the year 1999 and that contain weight values less
than or equal to 8. How many rows did you end up with? What did your
neighbor get?</p></li>
<li>
<p>You can use the <code>isin</code> command in Python to query a
DataFrame based upon a list of values as follows:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>surveys_df[surveys_df[<span class="st">'species_id'</span>].isin([listGoesHere])]</span></code></pre>
</div>
<p>Use the <code>isin</code> function to find all plots that contain
particular species in the “surveys” DataFrame. How many records contain
these values?</p>
</li>
<li><p>Experiment with other queries. Create a query that finds all rows
with a weight value greater than or equal to 0.</p></li>
<li><p>The <code>~</code> symbol in Python can be used to return the
OPPOSITE of the selection that you specify. It is equivalent to
<strong>is not in</strong>. Write a query that selects all rows with sex
NOT equal to ‘M’ or ‘F’ in the “surveys” data.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>surveys_df[(surveys_df[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">1999</span>) <span class="op">&amp;</span> (surveys_df[<span class="st">"weight"</span>] <span class="op">&lt;=</span> <span class="dv">8</span>)]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       record_id  month  day  year  plot_id species_id sex  hindfoot_length  weight
29082      29083      1   16  1999       21         RM   M             16.0     8.0
29196      29197      2   20  1999       18         RM   M             18.0     8.0
29421      29422      3   15  1999       16         RM   M             15.0     8.0
29903      29904     10   10  1999        4         PP   M             20.0     7.0
29905      29906     10   10  1999        4         PP   M             21.0     4.0</code></pre>
</div>
<p>If you are only interested in how many rows meet the criteria, the
sum of <code>True</code> values could be used instead:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="bu">sum</span>((surveys_df[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">1999</span>) <span class="op">&amp;</span> (surveys_df[<span class="st">"weight"</span>] <span class="op">&lt;=</span> <span class="dv">8</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">5</span></span></code></pre>
</div>
</li>
<li>
<p>For example, using <code>PB</code> and <code>PL</code>:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>surveys_df[surveys_df[<span class="st">'species_id'</span>].isin([<span class="st">'PB'</span>, <span class="st">'PL'</span>])][<span class="st">'plot_id'</span>].unique()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([ 1, 10,  6, 24,  2, 23, 19, 12, 20, 22,  3,  9, 14, 13, 21,  7, 11,
   15,  4, 16, 17,  8, 18,  5])</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>surveys_df[surveys_df[<span class="st">'species_id'</span>].isin([<span class="st">'PB'</span>, <span class="st">'PL'</span>])][<span class="st">'plot_id'</span>].unique().shape</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(24,)</code></pre>
</div>
</li>
<li><p><code>surveys_df[surveys_df["weight"] &gt;= 0]</code></p></li>
<li>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>surveys_df[<span class="op">~</span>surveys_df[<span class="st">"sex"</span>].isin([<span class="st">'M'</span>, <span class="st">'F'</span>])]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       record_id  month  day  year  plot_id species_id  sex  hindfoot_length  weight
13            14      7   16  1977        8         DM  NaN              NaN     NaN
18            19      7   16  1977        4         PF  NaN              NaN     NaN
33            34      7   17  1977       17         DM  NaN              NaN     NaN
56            57      7   18  1977       22         DM  NaN              NaN     NaN
76            77      8   19  1977        4         SS  NaN              NaN     NaN
...          ...    ...  ...   ...      ...        ...  ...              ...     ...
35527      35528     12   31  2002       13         US  NaN              NaN     NaN
35543      35544     12   31  2002       15         US  NaN              NaN     NaN
35544      35545     12   31  2002       15         AH  NaN              NaN     NaN
35545      35546     12   31  2002       15         AH  NaN              NaN     NaN
35548      35549     12   31  2002        5        NaN  NaN              NaN     NaN

[2511 rows x 9 columns]</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" aria-labelledby="headingInstructor2" data-bs-parent="#accordionInstructor2">
<div class="accordion-body">
<p>When working through the solutions to the challenges above, you could
introduce already that all these slice operations are actually based on
a <em>Boolean indexing</em> operation (next section in the lesson). The
filter provides for each record if it satisfies (True) or not (False).
The slicing itself interprets the True/False of each record.</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="using-masks-to-identify-a-specific-condition"><h2 class="section-heading">Using masks to identify a specific condition<a class="anchor" aria-label="anchor" href="#using-masks-to-identify-a-specific-condition"></a>
</h2>
<hr class="half-width">
<p>A <strong>mask</strong> can be useful to locate where a particular
subset of values exist or don’t exist - for example, NaN, or “Not a
Number” values. To understand masks, we also need to understand
<code>BOOLEAN</code> objects in Python.</p>
<p>Boolean values include <code>True</code> or <code>False</code>. For
example,</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Set x to 5</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co"># What does the code below return?</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>x <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a><span class="co"># How about this?</span></span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>x <span class="op">==</span> <span class="dv">5</span></span></code></pre>
</div>
<p>When we ask Python whether <code>x</code> is greater than 5, it
returns <code>False</code>. This is Python’s way to say “No”. Indeed,
the value of <code>x</code> is 5, and 5 is not greater than 5.</p>
<p>To create a boolean mask:</p>
<ul>
<li>Set the True / False criteria
(e.g. <code>values &gt; 5 = True</code>)</li>
<li>Python will then assess each value in the object to determine
whether the value meets the criteria (True) or not (False).</li>
<li>Python creates an output object that is the same shape as the
original object, but with a <code>True</code> or <code>False</code>
value for each index location.</li>
</ul>
<p>Let’s try this out. Let’s identify all locations in the survey data
that have null (missing or NaN) data values. We can use the
<code>isnull</code> method to do this. The <code>isnull</code> method
will compare each cell with a null value. If an element has a null
value, it will be assigned a value of <code>True</code> in the output
object.</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>pd.isnull(surveys_df)</span></code></pre>
</div>
<p>A snippet of the output is below:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>      record_id  month    day   year plot_id species_id    sex  hindfoot_length weight</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="dv">0</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="dv">1</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="dv">2</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="dv">3</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="dv">4</span>         <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">False</span>  <span class="va">False</span>   <span class="va">False</span>      <span class="va">True</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>[<span class="dv">35549</span> rows x <span class="dv">9</span> columns]</span></code></pre>
</div>
<p>To select the rows where there are null values, we can use the mask
as an index to subset our data as follows:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># To select just the rows with NaN values, we can use the 'any()' method</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>surveys_df[pd.isnull(surveys_df).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre>
</div>
<p>Note that the <code>weight</code> column of our DataFrame contains
many <code>null</code> or <code>NaN</code> values. We will explore ways
of dealing with this in the next episode on <a href="04-data-types-and-format.html">Data Types and Formats</a>.</p>
<p>We can run <code>isnull</code> on a particular column too. What does
the code below do?</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># What does this do?</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>empty_weights <span class="op">=</span> surveys_df[pd.isnull(surveys_df[<span class="st">'weight'</span>])][<span class="st">'weight'</span>]</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="bu">print</span>(empty_weights)</span></code></pre>
</div>
<p>Let’s take a minute to look at the statement above. We are using the
Boolean object <code>pd.isnull(surveys_df['weight'])</code> as an index
to <code>surveys_df</code>. We are asking Python to select rows that
have a <code>NaN</code> value of weight.</p>
<div id="challenge---putting-it-all-together" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---putting-it-all-together" class="callout-inner">
<h3 class="callout-title">Challenge - Putting it all together<a class="anchor" aria-label="anchor" href="#challenge---putting-it-all-together"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a new DataFrame that only contains observations with sex
values that are <strong>not</strong> female or male. Print the number of
rows in this new DataFrame. Verify the result by comparing the number of
rows in the new DataFrame with the number of rows in the surveys
DataFrame where sex is null.</li>
<li>Create a new DataFrame that contains only observations that are of
sex male or female and where weight values are greater than 0. Create a
stacked bar plot of average weight by plot with male vs female values
stacked for each plot.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>new <span class="op">=</span> surveys_df[<span class="op">~</span>surveys_df[<span class="st">'sex'</span>].isin([<span class="st">'M'</span>, <span class="st">'F'</span>])].copy()</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(new))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">2511</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="bu">sum</span>(surveys_df[<span class="st">'sex'</span>].isnull()) <span class="op">==</span> <span class="bu">len</span>(new)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
</li>
<li><div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># selection of the data with isin</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>stack_selection <span class="op">=</span> surveys_df[(surveys_df[<span class="st">'sex'</span>].isin([<span class="st">'M'</span>, <span class="st">'F'</span>])) <span class="op">&amp;</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>              surveys_df[<span class="st">"weight"</span>] <span class="op">&gt;</span> <span class="fl">0.</span>][[<span class="st">"sex"</span>, <span class="st">"weight"</span>, <span class="st">"plot_id"</span>]]</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="co"># calculate the mean weight for each plot id and sex combination:</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>stack_selection <span class="op">=</span> stack_selection.groupby([<span class="st">"plot_id"</span>, <span class="st">"sex"</span>]).mean().unstack()</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="co"># and we can make a stacked bar plot from this:</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>stack_selection.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div></li>
</ol>
</div>
</div>
</div>
</div>
<div id="accordionInstructor3" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor3" aria-expanded="false" aria-controls="collapseInstructor3">
  <h3 class="accordion-header" id="headingInstructor3">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor3" class="accordion-collapse collapse" aria-labelledby="headingInstructor3" data-bs-parent="#accordionInstructor3">
<div class="accordion-body">
<p>Referring to the challenge solution above, as we know the other
values are all Nan values, we could also select all not null values:</p>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>stack_selection <span class="op">=</span> surveys_df[(surveys_df[<span class="st">'sex'</span>].notnull()) <span class="op">&amp;</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>          surveys_df[<span class="st">"weight"</span>] <span class="op">&gt;</span> <span class="fl">0.</span>][[<span class="st">"sex"</span>, <span class="st">"weight"</span>, <span class="st">"plot_id"</span>]]</span></code></pre>
</div>
<figure><img src="../fig/02_chall_stack_levelissue.png" alt="average weight for each plot per sex" class="figure mx-auto d-block"></figure><p>However, due to the <code>unstack</code> command, the legend header
contains two levels. In order to remove this, the column naming needs to
be simplified:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>stack_selection.columns <span class="op">=</span> stack_selection.columns.droplevel()</span></code></pre>
</div>
<figure><img src="../fig/02_chall_stack_level.png" alt="average weight for each plot per sex" class="figure mx-auto d-block"></figure><p>This is just a preview, more in next episode.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>In Python, portions of data can be accessed using indices, slices,
column headings, and condition-based subsetting.</li>
<li>Python uses 0-based indexing, in which the first element in a list,
tuple or any other data structure has an index of 0.</li>
<li>Pandas enables common data exploration steps such as data indexing,
slicing and conditional subsetting.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-data-types-and-format"><p>Content from <a href="04-data-types-and-format.html">Data Types and Formats</a></p>
<hr>
<p>Last updated on 2023-06-05 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/04-data-types-and-format.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What types of data can be contained in a DataFrame?</li>
<li>Why is the data type important?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how information is stored in a pandas DataFrame.</li>
<li>Define the two main types of data in pandas: text and numerics.</li>
<li>Examine the structure of a DataFrame.</li>
<li>Modify the format of values in a DataFrame.</li>
<li>Describe how data types impact operations.</li>
<li>Define, manipulate, and interconvert integers and floats in
Python/pandas.</li>
<li>Analyze datasets having missing/null values (NaN values).</li>
<li>Write manipulated data to a file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The format of individual columns and rows will impact analysis
performed on a dataset read into a pandas DataFrame. For example, you
can’t perform mathematical calculations on a string (text formatted
data). This might seem obvious, however sometimes numeric values are
read into pandas as strings. In this situation, when you then try to
perform calculations on the string-formatted numeric data, you get an
error.</p>
<p>In this lesson we will review ways to explore and better understand
the structure and format of our data.</p>
<section id="types-of-data"><h2 class="section-heading">Types of Data<a class="anchor" aria-label="anchor" href="#types-of-data"></a>
</h2>
<hr class="half-width">
<p>How information is stored in a DataFrame or a Python object affects
what we can do with it and the outputs of calculations as well. There
are two main types of data that we will explore in this lesson: numeric
and text data types.</p>
</section><section id="numeric-data-types"><h2 class="section-heading">Numeric Data Types<a class="anchor" aria-label="anchor" href="#numeric-data-types"></a>
</h2>
<hr class="half-width">
<p>Numeric data types include integers and floats. A <strong>floating
point</strong> (known as a float) number has decimal points even if that
decimal point value is 0. For example: 1.13, 2.0, 1234.345. If we have a
column that contains both integers and floating point numbers, pandas
will assign the entire column to the float data type so the decimal
points are not lost.</p>
<p>An <strong>integer</strong> will never have a decimal point. Thus if
we wanted to store 1.13 as an integer it would be stored as 1.
Similarly, 1234.345 would be stored as 1234. You will often see the data
type <code>Int64</code> in pandas which stands for 64 bit integer. The
64 refers to the memory allocated to store data in each cell which
effectively relates to how many digits it can store in each “cell”.
Allocating space ahead of time allows computers to optimize storage and
processing efficiency.</p>
</section><section id="text-data-type"><h2 class="section-heading">Text Data Type<a class="anchor" aria-label="anchor" href="#text-data-type"></a>
</h2>
<hr class="half-width">
<p>The text data type is known as a <em>string</em> in Python, or
<em>object</em> in pandas. Strings can contain numbers and / or
characters. For example, a string might be a word, a sentence, or
several sentences. A pandas object might also be a plot name like
<code>'plot1'</code>. A string can also contain or consist of numbers.
For instance, <code>'1234'</code> could be stored as a string, as could
<code>'10.23'</code>. However <strong>strings that contain numbers can
not be used for mathematical operations</strong>!</p>
<p>pandas and base Python use slightly different names for data types.
More on this is in the table below:</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="17%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Pandas Type</th>
<th>Native Python Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>The most general dtype. Will be assigned to your column if column
has mixed types (numbers and strings).</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>Numeric characters. 64 refers to the memory allocated to hold this
character.</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>Numeric characters with decimals. If a column contains numbers and
NaNs (see below), pandas will default to float64, in case your missing
value has a decimal.</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/A (but see the <a href="https://doc.python.org/2/library/datetime.html" class="external-link">datetime</a>
module in Python’s standard library)</td>
<td>Values meant to hold time data. Look into these for time series
experiments.</td>
</tr>
</tbody>
</table></section><section id="checking-the-format-of-our-data"><h2 class="section-heading">Checking the format of our data<a class="anchor" aria-label="anchor" href="#checking-the-format-of-our-data"></a>
</h2>
<hr class="half-width">
<p>Now that we’re armed with a basic understanding of numeric and text
data types, let’s explore the format of our survey data. We’ll be
working with the same <code>surveys.csv</code> dataset that we’ve used
in previous lessons.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Make sure pandas is loaded</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Note that pd.read_csv is used because we imported pandas as pd</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>Remember that we can check the type of an object like this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">type</span>(surveys_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">pandas.core.frame.DataFrame</span></span></code></pre>
</div>
<p>Next, let’s look at the structure of our <code>surveys_df</code>
data. In pandas, we can check the type of one column in a DataFrame
using the syntax <code>dataframe_name['column_name'].dtype</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>surveys_df[<span class="st">'sex'</span>].dtype</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">dtype</span><span class="op">(</span><span class="st">'O'</span><span class="op">)</span></span></code></pre>
</div>
<p>A type ‘O’ just stands for “object” which in pandas is a string
(text).</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>].dtype</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">dtype</span><span class="op">(</span><span class="st">'int64'</span><span class="op">)</span></span></code></pre>
</div>
<p>The type <code>int64</code> tells us that pandas is storing each
value within this column as a 64 bit integer. We can use the
<code>dataframe_name.dtypes</code> command to view the data type for
each column in a DataFrame (all at once).</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>surveys_df.dtypes</span></code></pre>
</div>
<p>which returns:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>record_id            int64</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>month                int64</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>day                  int64</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>year                 int64</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>plot_id              int64</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>species_id          <span class="bu">object</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>sex                 <span class="bu">object</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>hindfoot_length    float64</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>weight             float64</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>dtype: <span class="bu">object</span></span></code></pre>
</div>
<p>Note that most of the columns in our <code>survey_df</code> data are
of type <code>int64</code>. This means that they are 64 bit integers.
But the <code>weight</code> column is a floating point value which means
it contains decimals. The <code>species_id</code> and <code>sex</code>
columns are objects which means they contain strings.</p>
</section><section id="working-with-integers-and-floats"><h2 class="section-heading">Working With Integers and Floats<a class="anchor" aria-label="anchor" href="#working-with-integers-and-floats"></a>
</h2>
<hr class="half-width">
<p>So we’ve learned that computers store numbers in one of two ways: as
integers or as floating-point numbers (or floats). Integers are the
numbers we usually count with. Floats have fractional parts (decimal
places). Let’s next consider how the data type can impact mathematical
operations on our data. Addition, subtraction, division and
multiplication work on floats and integers as we’d expect.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">+</span><span class="dv">5</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">10</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">24</span><span class="op">-</span><span class="dv">4</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">20</span></span></code></pre>
</div>
<p>If we divide one integer by another, we get a float. The result on
Python 3 is different than in Python 2, where the result is an integer
(integer division).</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">9</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.5555555555555556</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">10</span><span class="op">/</span><span class="dv">3</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3.3333333333333335</span></span></code></pre>
</div>
<p>We can also convert a floating point number to an integer or an
integer to floating point number. Notice that Python by default rounds
down when it converts from floating point to integer.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Convert a to an integer</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">7.83</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="bu">int</span>(a)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">7</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Convert b to a float</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="bu">float</span>(b)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">7.0</span></span></code></pre>
</div>
</section><section id="working-with-our-survey-data"><h2 class="section-heading">Working With Our Survey Data<a class="anchor" aria-label="anchor" href="#working-with-our-survey-data"></a>
</h2>
<hr class="half-width">
<p>Getting back to our data, we can modify the format of values within
our data, if we want. For instance, we could convert the
<code>record_id</code> field to floating point values.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Convert the record_id field from an integer to a float</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>] <span class="op">=</span> surveys_df[<span class="st">'record_id'</span>].astype(<span class="st">'float64'</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>surveys_df[<span class="st">'record_id'</span>].dtype</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fu">dtype</span><span class="op">(</span><span class="st">'float64'</span><span class="op">)</span></span></code></pre>
</div>
<div id="changing-types" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="changing-types" class="callout-inner">
<h3 class="callout-title">Changing Types<a class="anchor" aria-label="anchor" href="#changing-types"></a>
</h3>
<div class="callout-content">
<p>Try converting the column <code>plot_id</code> to floats using</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>surveys_df[<span class="st">'plot_id'</span>].astype(<span class="st">"float"</span>)</span></code></pre>
</div>
<p>Next try converting <code>weight</code> to an integer. What goes
wrong here? What is pandas telling you? We will talk about some
solutions to this later.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>surveys_df[<span class="st">'plot_id'</span>].astype(<span class="st">"float"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0         2.0
1         3.0
2         2.0
3         7.0
4         3.0
         ... 
35544    15.0
35545    15.0
35546    10.0
35547     7.0
35548     5.0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].astype(<span class="st">"int"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>pandas.errors.IntCastingNaNError: Cannot convert non-finite values (NA or inf) to integer</code></pre>
</div>
<p>Pandas cannot convert types from float to int if the column contains
NaN values.</p>
</div>
</div>
</div>
</div>
</section><section id="missing-data-values---nan"><h2 class="section-heading">Missing Data Values - NaN<a class="anchor" aria-label="anchor" href="#missing-data-values---nan"></a>
</h2>
<hr class="half-width">
<p>What happened in the last challenge activity? Notice that this raises
a casting error:
<code>pandas.errors.IntCastingNaNError: Cannot convert non-finite values (NA or inf) to integer</code>
(in older versions of pandas, this may be called a
<code>ValueError</code> instead). If we look at the <code>weight</code>
column in the surveys data we notice that there are NaN
(<strong>N</strong>ot <strong>a</strong> <strong>N</strong>umber)
values. <strong>NaN</strong> values are undefined values that cannot be
represented mathematically. pandas, for example, will read an empty cell
in a CSV or Excel sheet as <code>NaN</code>. NaNs have some desirable
properties: if we were to average the <code>weight</code> column without
replacing our NaNs, Python would know to skip over those cells.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>surveys_df[<span class="st">'weight'</span>].mean()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">42.672428212991356</span></span></code></pre>
</div>
<p>Dealing with missing data values is always a challenge. It’s
sometimes hard to know why values are missing - was it because of a data
entry error? Or data that someone was unable to collect? Should the
value be 0? We need to know how missing values are represented in the
dataset in order to make good decisions. If we’re lucky, we have some
metadata that will tell us more about how null values were handled.</p>
<p>For instance, in some disciplines, like Remote Sensing, missing data
values are often defined as -9999. Having a bunch of -9999 values in
your data could really alter numeric calculations. Often in
spreadsheets, cells are left empty where no data are available. pandas
will, by default, replace those missing values with <code>NaN</code>.
However, it is good practice to get in the habit of intentionally
marking cells that have no data with a no data value! That way there are
no questions in the future when you (or someone else) explores your
data.</p>
<div class="section level3">
<h3 id="where-are-the-nans">Where Are the NaN’s?<a class="anchor" aria-label="anchor" href="#where-are-the-nans"></a>
</h3>
<p>Let’s explore the <code>NaN</code> values in our data a bit further.
Using the tools we learned in lesson 02, we can figure out how many rows
contain <code>NaN</code> values for <code>weight</code>. We can also
create a new subset from our data that only contains rows with
<code>weight &gt; 0</code> (i.e., select meaningful weight values):</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="bu">len</span>(surveys_df[surveys_df[<span class="st">'weight'</span>].isna()])</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co"># How many rows have weight values?</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="bu">len</span>(surveys_df[surveys_df[<span class="st">'weight'</span>] <span class="op">&gt;</span> <span class="dv">0</span>])</span></code></pre>
</div>
<p>We can replace all <code>NaN</code> values with zeroes using the
<code>.fillna()</code> method (after making a copy of the data so we
don’t lose our work):</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>df1 <span class="op">=</span> surveys_df.copy()</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co"># Fill all NaN values with 0</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>df1[<span class="st">'weight'</span>] <span class="op">=</span> df1[<span class="st">'weight'</span>].fillna(<span class="dv">0</span>)</span></code></pre>
</div>
<p>However <code>NaN</code> and <code>0</code> yield different analysis
results. The mean value when <code>NaN</code> values are replaced with
<code>0</code> is different from when <code>NaN</code> values are simply
thrown out or ignored.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>df1[<span class="st">'weight'</span>].mean()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">38.751976145601844</span></span></code></pre>
</div>
<p>We can fill <code>NaN</code> values with any value that we chose. The
code below fills all <code>NaN</code> values with a mean for all weight
values.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>df1[<span class="st">'weight'</span>] <span class="op">=</span> surveys_df[<span class="st">'weight'</span>].fillna(surveys_df[<span class="st">'weight'</span>].mean())</span></code></pre>
</div>
<p>We could also chose to create a subset of our data, only keeping rows
that do not contain <code>NaN</code> values.</p>
<p>The point is to make conscious decisions about how to manage missing
data. This is where we think about how our data will be used and how
these values will impact the scientific conclusions made from the
data.</p>
<p>pandas gives us all of the tools that we need to account for these
issues. We just need to be cautious about how the decisions that we make
impact scientific results.</p>
<div id="counting" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="counting" class="callout-inner">
<h3 class="callout-title">Counting<a class="anchor" aria-label="anchor" href="#counting"></a>
</h3>
<div class="callout-content">
<p>Count the number of missing values per column.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Hints</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>The method <code>.count()</code> gives you the number of non-NaN
observations per column. Try looking to the <code>.isna()</code>
method.</p>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> surveys_df.columns:</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>    <span class="bu">print</span>(c, <span class="bu">len</span>(surveys_df[surveys_df[c].isna()]))</span></code></pre>
</div>
<p>Or, since we’ve been using the <code>pd.isnull</code> function so
far:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> surveys_df.columns:</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>    <span class="bu">print</span>(c, <span class="bu">len</span>(surveys_df[pd.isnull(surveys_df[c])]))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id 0
month 0
day 0
year 0
plot_id 0
species_id 763
sex 2511
hindfoot_length 4111
weight 3266</code></pre>
</div>
<p>Note that <code>isnull</code> and <code>isna</code> are equivalent:
they behave identically.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="writing-out-data-to-csv"><h2 class="section-heading">Writing Out Data to CSV<a class="anchor" aria-label="anchor" href="#writing-out-data-to-csv"></a>
</h2>
<hr class="half-width">
<p>We’ve learned about manipulating data to get desired outputs. But
we’ve also discussed keeping data that has been manipulated separate
from our raw data. Something we might be interested in doing is working
with only the columns that have full data. First, let’s reload the data
so we’re not mixing up all of our previous manipulations.</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<p>Next, let’s drop all the rows that contain missing values. We will
use the command <code>dropna</code>. By default, <code>dropna</code>
removes rows that contain missing data for even just one column.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>df_na <span class="op">=</span> surveys_df.dropna()</span></code></pre>
</div>
<p>If you now type <code>df_na</code>, you should observe that the
resulting DataFrame has 30676 rows and 9 columns, much smaller than the
35549 row original.</p>
<p>We can now use the <code>to_csv</code> command to export a DataFrame
in CSV format. Note that the code below will by default save the data
into the current working directory. We can save it to a different folder
by adding the foldername and a slash before the filename:
<code>df.to_csv('foldername/out.csv')</code>. We use
<code>'index=False'</code> so that pandas doesn’t include the index
number for each line.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Write DataFrame to CSV</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>df_na.to_csv(<span class="st">'data_output/surveys_complete.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>We will use this data file later in the workshop. Check out your
working directory to make sure the CSV wrote out properly, and that you
can open it! If you want, try to bring it back into Python to make sure
it imports properly.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Processed Data Checkpoint</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>If learners have trouble generating the output, or anything happens
with that, the folder <a href="https://github.com/datacarpentry/python-ecology-lesson/tree/main/sample_output" class="external-link"><code>sample_output</code></a>
in this repository contains the file <code>surveys_complete.csv</code>
with the data they should generate.</p>
</div>
</div>
</div>
</div>
</section><section id="recap"><h2 class="section-heading">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
</h2>
<hr class="half-width">
<p>What we’ve learned:</p>
<ul>
<li>How to explore the data types of columns within a DataFrame</li>
<li>How to change the data type</li>
<li>What NaN values are, how they might be represented, and what this
means for your work</li>
<li>How to replace NaN values, if desired</li>
<li>How to use <code>to_csv</code> to write manipulated data to a
file.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>pandas uses other names for data types than Python, for example:
<code>object</code> for textual data.</li>
<li>A column in a DataFrame can only have one data type.</li>
<li>The data type in a DataFrame’s single column can be checked using
<code>dtype</code>.</li>
<li>Make conscious decisions about how to manage missing data.</li>
<li>A DataFrame can be saved to a CSV file using the <code>to_csv</code>
function.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-05-merging-data"><p>Content from <a href="05-merging-data.html">Combining DataFrames with Pandas</a></p>
<hr>
<p>Last updated on 2024-02-21 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/05-merging-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I work with data from multiple sources?</li>
<li>How can I combine data from different data sets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Combine data from multiple files into a single DataFrame using merge
and concat.</li>
<li>Combine two DataFrames using a unique ID found in both
DataFrames.</li>
<li>Employ <code>to_csv</code> to export a DataFrame in CSV format.</li>
<li>Join DataFrames using common fields (join keys).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In many “real world” situations, the data that we want to use come in
multiple files. We often need to combine these files into a single
DataFrame to analyze the data. The pandas package provides <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html" class="external-link">various
methods for combining DataFrames</a> including <code>merge</code> and
<code>concat</code>.</p>
<p>To work through the examples below, we first need to load the species
and surveys files into pandas DataFrames. In a Jupyter Notebook or
iPython:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>surveys_df</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       record_id  month  day  year  plot species  sex  hindfoot_length weight
0              1      7   16  1977     2      NA    M               32  NaN
1              2      7   16  1977     3      NA    M               33  NaN
2              3      7   16  1977     2      DM    F               37  NaN
3              4      7   16  1977     7      DM    M               36  NaN
4              5      7   16  1977     3      DM    M               35  NaN
...          ...    ...  ...   ...   ...     ...  ...              ...  ...
35544      35545     12   31  2002    15      AH  NaN              NaN  NaN
35545      35546     12   31  2002    15      AH  NaN              NaN  NaN
35546      35547     12   31  2002    10      RM    F               15   14
35547      35548     12   31  2002     7      DO    M               36   51
35548      35549     12   31  2002     5     NaN  NaN              NaN  NaN

[35549 rows x 9 columns]</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>species_df <span class="op">=</span> pd.read_csv(<span class="st">"data/species.csv"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                         keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>species_df</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  species_id             genus          species     taxa
0          AB        Amphispiza        bilineata     Bird
1          AH  Ammospermophilus          harrisi   Rodent
2          AS        Ammodramus       savannarum     Bird
3          BA           Baiomys          taylori   Rodent
4          CB   Campylorhynchus  brunneicapillus     Bird
..        ...               ...              ...      ...
49         UP            Pipilo              sp.     Bird
50         UR            Rodent              sp.   Rodent
51         US           Sparrow              sp.     Bird
52         ZL       Zonotrichia       leucophrys     Bird
53         ZM           Zenaida         macroura     Bird

[54 rows x 4 columns]</code></pre>
</div>
<p>Take note that the <code>read_csv</code> method we used can take some
additional options which we didn’t use previously. Many functions in
Python have a set of options that can be set by the user if needed. In
this case, we have told pandas to assign empty values in our CSV to
<code>NaN</code> with the parameters <code>keep_default_na=False</code>
and <code>na_values=[""]</code>. We have explicitly requested to change
empty values in the CSV to NaN, this is however also the default
behaviour of <code>read_csv</code>. <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html#pandas.read_csv" class="external-link">More
about all of the <code>read_csv</code> options here and their
defaults.</a></p>
<section id="concatenating-dataframes"><h2 class="section-heading">Concatenating DataFrames<a class="anchor" aria-label="anchor" href="#concatenating-dataframes"></a>
</h2>
<hr class="half-width">
<p>We can use the <code>concat</code> function in pandas to append
either columns or rows from one DataFrame to another. Let’s grab two
subsets of our data to see how this works.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Read in first 10 lines of surveys table</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>survey_sub <span class="op">=</span> surveys_df.head(<span class="dv">10</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Grab the last 10 rows</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>survey_sub_last10 <span class="op">=</span> surveys_df.tail(<span class="dv">10</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Reset the index values to the second dataframe appends properly</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>survey_sub_last10 <span class="op">=</span> survey_sub_last10.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># drop=True option avoids adding new index column with old index values</span></span></code></pre>
</div>
<p>When we concatenate DataFrames, we need to specify the axis.
<code>axis=0</code> tells pandas to stack the second DataFrame UNDER the
first one. It will automatically detect whether the column names are the
same and will stack accordingly. <code>axis=1</code> will stack the
columns in the second DataFrame to the RIGHT of the first DataFrame. To
stack the data vertically, we need to make sure we have the same columns
and associated column format in both datasets. When we stack
horizontally, we want to make sure what we are doing makes sense
(i.e. the data are related in some way).</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Stack the DataFrames on top of each other</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>vertical_stack <span class="op">=</span> pd.concat([survey_sub, survey_sub_last10], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># Place the DataFrames side by side</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([survey_sub, survey_sub_last10], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<div class="section level4">
<h4 id="row-index-values-and-concat">Row Index Values and Concat<a class="anchor" aria-label="anchor" href="#row-index-values-and-concat"></a>
</h4>
<p>Have a look at the <code>vertical_stack</code> DataFrame. Notice
anything unusual? The row indexes for the two DataFrames
<code>survey_sub</code> and <code>survey_sub_last10</code> have been
repeated. We can reindex the new DataFrame using the
<code>reset_index()</code> method.</p>
</div>
<div class="section level3">
<h3 id="writing-out-data-to-csv">Writing Out Data to CSV<a class="anchor" aria-label="anchor" href="#writing-out-data-to-csv"></a>
</h3>
<p>We can use the <code>to_csv</code> command to export a DataFrame in
CSV format. Note that the code below will by default save the data into
the current working directory. We can save it to a different folder by
adding the foldername and a slash to the file
<code>vertical_stack.to_csv('foldername/out.csv')</code>. We use the
<code>index=False</code> so that pandas doesn’t include the index number
for each line.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Write DataFrame to CSV</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>vertical_stack.to_csv(<span class="st">'data/out.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>Check out your working directory to make sure the CSV wrote out
properly, and that you can open it! If you want, try to bring it back
into pandas to make sure it imports properly.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># For kicks read our output back into Python and make sure all looks good</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>new_output <span class="op">=</span> pd.read_csv(<span class="st">'data/out.csv'</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code></pre>
</div>
<div id="challenge---combine-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---combine-data" class="callout-inner">
<h3 class="callout-title">Challenge - Combine Data<a class="anchor" aria-label="anchor" href="#challenge---combine-data"></a>
</h3>
<div class="callout-content">
<p>In the data folder, there is another folder called
<code>yearly_files</code> that contains survey data broken down into
individual files by year. Read the data from two of these files,
<code>surveys2001.csv</code> and <code>surveys2002.csv</code>, into
pandas and combine the files to make one new DataFrame. Create a plot of
average plot weight by year grouped by sex. Export your results as a CSV
and make sure it reads back into pandas properly.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># read the files:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>survey2001 <span class="op">=</span> pd.read_csv(<span class="st">"data/yearly_files/surveys2001.csv"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>survey2002 <span class="op">=</span> pd.read_csv(<span class="st">"data/yearly_files/surveys2002.csv"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># concatenate</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>survey_all <span class="op">=</span> pd.concat([survey2001, survey2002], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># get the weight for each year, grouped by sex:</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>weight_year <span class="op">=</span> survey_all.groupby([<span class="st">'year'</span>, <span class="st">'sex'</span>]).mean()[<span class="st">"wgt"</span>].unstack()</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># plot:</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>weight_year.plot(kind<span class="op">=</span><span class="st">"bar"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>plt.tight_layout()  <span class="co"># tip: use this to improve the plot layout. </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Try running the code without this line to see </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># what difference applying plt.tight_layout() makes.</span></span></code></pre>
</div>
<figure><img src="../fig/04_chall_weight_year.png" alt="average weight for each year, grouped by sex" class="figure mx-auto d-block"></figure><div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># writing to file:</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>weight_year.to_csv(<span class="st">"weight_for_year.csv"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># reading it back in:</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>pd.read_csv(<span class="st">"weight_for_year.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="joining-dataframes"><h2 class="section-heading">Joining DataFrames<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
</h2>
<hr class="half-width">
<p>When we concatenated our DataFrames, we simply added them to each
other - stacking them either vertically or side by side. Another way to
combine DataFrames is to use columns in each dataset that contain common
values (a common unique identifier). Combining DataFrames using a common
field is called “joining”. The columns containing the common values are
called “join key(s)”. Joining DataFrames in this way is often useful
when one DataFrame is a “lookup table” containing additional data that
we want to include in the other.</p>
<p>NOTE: This process of joining tables is similar to what we do with
tables in an SQL database.</p>
<p>For example, the <code>species.csv</code> file that we’ve been
working with is a lookup table. This table contains the genus, species
and taxa code for 55 species. The species code is unique for each line.
These species are identified in our survey data as well using the unique
species code. Rather than adding three more columns for the genus,
species and taxa to each of the 35,549 line <code>survey</code>
DataFrame, we can maintain the shorter table with the species
information. When we want to access that information, we can create a
query that joins the additional columns of information to the
<code>survey</code> DataFrame.</p>
<p>Storing data in this way has many benefits.</p>
<ol style="list-style-type: decimal">
<li>It ensures consistency in the spelling of species attributes (genus,
species and taxa) given each species is only entered once. Imagine the
possibilities for spelling errors when entering the genus and species
thousands of times!</li>
<li>It also makes it easy for us to make changes to the species
information once without having to find each instance of it in the
larger survey data.</li>
<li>It optimizes the size of our data.</li>
</ol>
<div class="section level3">
<h3 id="joining-two-dataframes">Joining Two DataFrames<a class="anchor" aria-label="anchor" href="#joining-two-dataframes"></a>
</h3>
<p>To better understand joins, let’s grab the first 10 lines of our data
as a subset to work with. We’ll use the <code>.head()</code> method to
do this. We’ll also read in a subset of the species table.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Read in first 10 lines of surveys table</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>survey_sub <span class="op">=</span> surveys_df.head(<span class="dv">10</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Import a small subset of the species data designed for this part of the lesson.</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># It is stored in the data folder.</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>species_sub <span class="op">=</span> pd.read_csv(<span class="st">'data/speciesSubset.csv'</span>, keep_default_na<span class="op">=</span><span class="va">False</span>, na_values<span class="op">=</span>[<span class="st">""</span>])</span></code></pre>
</div>
<p>In this example, <code>species_sub</code> is the lookup table
containing genus, species, and taxa names that we want to join with the
data in <code>survey_sub</code> to produce a new DataFrame that contains
all of the columns from both <code>species_df</code> <em>and</em>
<code>survey_df</code>.</p>
</div>
<div class="section level3">
<h3 id="identifying-join-keys">Identifying join keys<a class="anchor" aria-label="anchor" href="#identifying-join-keys"></a>
</h3>
<p>To identify appropriate join keys we first need to know which
field(s) are shared between the files (DataFrames). We might inspect
both DataFrames to identify these columns. If we are lucky, both
DataFrames will have columns with the same name that also contain the
same data. If we are less lucky, we need to identify a
(differently-named) column in each DataFrame that contains the same
information.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>species_sub.columns</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index([u'species_id', u'genus', u'species', u'taxa'], dtype='object')</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>survey_sub.columns</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index([u'record_id', u'month', u'day', u'year', u'plot_id', u'species_id',
       u'sex', u'hindfoot_length', u'weight'], dtype='object')</code></pre>
</div>
<p>In our example, the join key is the column containing the two-letter
species identifier, which is called <code>species_id</code>.</p>
<p>Now that we know the fields with the common species ID attributes in
each DataFrame, we are almost ready to join our data. However, since
there are <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">different
types of joins</a>, we also need to decide which type of join makes
sense for our analysis.</p>
</div>
<div class="section level3">
<h3 id="inner-joins">Inner joins<a class="anchor" aria-label="anchor" href="#inner-joins"></a>
</h3>
<p>The most common type of join is called an <strong>inner
join</strong>. An inner join combines two DataFrames based on a join key
and returns a new DataFrame that contains <em>only</em> those rows that
have matching values in <em>both</em> of the original DataFrames. An
example of an inner join, adapted from <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">Jeff
Atwood’s blogpost about SQL joins</a> is below:</p>
<figure><img src="../fig/inner-join.png" alt="Inner join -- courtesy of codinghorror.com" class="figure mx-auto d-block"></figure><p>The pandas function for performing joins is called <code>merge</code>
and an Inner join is the default option:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>merged_inner <span class="op">=</span> pd.merge(left<span class="op">=</span>survey_sub, right<span class="op">=</span>species_sub, left_on<span class="op">=</span><span class="st">'species_id'</span>, right_on<span class="op">=</span><span class="st">'species_id'</span>)</span></code></pre>
</div>
<p>In this case, <code>species_id</code> is the only column name in both
DataFrames, so if we skipped the <code>left_on</code> and
<code>right_on</code> arguments, <code>pandas</code> would guess that we
wanted to use that column to join. However, it is usually better to be
explicit.</p>
<p>So what is the size of the output data?</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>merged_inner.shape</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(8, 12)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>merged_inner</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
0          1      7   16  1977        2         NL   M               32
1          2      7   16  1977        3         NL   M               33
2          3      7   16  1977        2         DM   F               37
3          4      7   16  1977        7         DM   M               36
4          5      7   16  1977        3         DM   M               35
5          8      7   16  1977        1         DM   M               37
6          9      7   16  1977        1         DM   F               34
7          7      7   16  1977        2         PE   F              NaN

   weight       genus   species    taxa
0     NaN     Neotoma  albigula  Rodent
1     NaN     Neotoma  albigula  Rodent
2     NaN   Dipodomys  merriami  Rodent
3     NaN   Dipodomys  merriami  Rodent
4     NaN   Dipodomys  merriami  Rodent
5     NaN   Dipodomys  merriami  Rodent
6     NaN   Dipodomys  merriami  Rodent
7     NaN  Peromyscus  eremicus  Rodent</code></pre>
</div>
<p>The result of an inner join of <code>survey_sub</code> and
<code>species_sub</code> is a new DataFrame that contains the combined
set of columns from <code>survey_sub</code> and
<code>species_sub</code>. It <em>only</em> contains rows that have
two-letter species codes that are the same in both the
<code>survey_sub</code> and <code>species_sub</code> DataFrames. In
other words, if a row in <code>survey_sub</code> has a value of
<code>species_id</code> that does <em>not</em> appear in the
<code>species_id</code> column of <code>species</code>, it will not be
included in the DataFrame returned by an inner join. Similarly, if a row
in <code>species_sub</code> has a value of <code>species_id</code> that
does <em>not</em> appear in the <code>species_id</code> column of
<code>survey_sub</code>, that row will not be included in the DataFrame
returned by an inner join.</p>
<p>The two DataFrames that we want to join are passed to the
<code>merge</code> function using the <code>left</code> and
<code>right</code> argument. The <code>left_on='species_id'</code>
argument tells <code>merge</code> to use the <code>species_id</code>
column as the join key from <code>survey_sub</code> (the
<code>left</code> DataFrame). Similarly , the
<code>right_on='species_id'</code> argument tells <code>merge</code> to
use the <code>species_id</code> column as the join key from
<code>species_sub</code> (the <code>right</code> DataFrame). For inner
joins, the order of the <code>left</code> and <code>right</code>
arguments does not matter.</p>
<p>The result <code>merged_inner</code> DataFrame contains all of the
columns from <code>survey_sub</code> (<code>record_id</code>,
<code>month</code>, <code>day</code>, etc.) as well as all the columns
from <code>species_sub</code> (<code>species_id</code>,
<code>genus</code>, <code>species</code>, and <code>taxa</code>).</p>
<p>Notice that <code>merged_inner</code> has fewer rows than
<code>survey_sub</code>. This is an indication that there were rows in
<code>surveys_df</code> with value(s) for <code>species_id</code> that
do not exist as value(s) for <code>species_id</code> in
<code>species_df</code>.</p>
</div>
<div class="section level3">
<h3 id="left-joins">Left joins<a class="anchor" aria-label="anchor" href="#left-joins"></a>
</h3>
<p>What if we want to add information from <code>species_sub</code> to
<code>survey_sub</code> without losing any of the information from
<code>survey_sub</code>? In this case, we use a different type of join
called a “left outer join”, or a “left join”.</p>
<p>Like an inner join, a left join uses join keys to combine two
DataFrames. Unlike an inner join, a left join will return <em>all</em>
of the rows from the <code>left</code> DataFrame, even those rows whose
join key(s) do not have values in the <code>right</code> DataFrame. Rows
in the <code>left</code> DataFrame that are missing values for the join
key(s) in the <code>right</code> DataFrame will simply have null (i.e.,
NaN or None) values for those columns in the resulting joined
DataFrame.</p>
<p>Note: a left join will still discard rows from the <code>right</code>
DataFrame that do not have values for the join key(s) in the
<code>left</code> DataFrame.</p>
<figure><img src="../fig/left-join.png" alt="Left Join" class="figure mx-auto d-block"></figure><p>A left join is performed in pandas by calling the same
<code>merge</code> function used for inner join, but using the
<code>how='left'</code> argument:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>merged_left <span class="op">=</span> pd.merge(left<span class="op">=</span>survey_sub, right<span class="op">=</span>species_sub, how<span class="op">=</span><span class="st">'left'</span>, left_on<span class="op">=</span><span class="st">'species_id'</span>, right_on<span class="op">=</span><span class="st">'species_id'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>merged_left</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
0          1      7   16  1977        2         NL   M               32
1          2      7   16  1977        3         NL   M               33
2          3      7   16  1977        2         DM   F               37
3          4      7   16  1977        7         DM   M               36
4          5      7   16  1977        3         DM   M               35
5          6      7   16  1977        1         PF   M               14
6          7      7   16  1977        2         PE   F              NaN
7          8      7   16  1977        1         DM   M               37
8          9      7   16  1977        1         DM   F               34
9         10      7   16  1977        6         PF   F               20

   weight       genus   species    taxa
0     NaN     Neotoma  albigula  Rodent
1     NaN     Neotoma  albigula  Rodent
2     NaN   Dipodomys  merriami  Rodent
3     NaN   Dipodomys  merriami  Rodent
4     NaN   Dipodomys  merriami  Rodent
5     NaN         NaN       NaN     NaN
6     NaN  Peromyscus  eremicus  Rodent
7     NaN   Dipodomys  merriami  Rodent
8     NaN   Dipodomys  merriami  Rodent
9     NaN         NaN       NaN     NaN</code></pre>
</div>
<p>The result DataFrame from a left join (<code>merged_left</code>)
looks very much like the result DataFrame from an inner join
(<code>merged_inner</code>) in terms of the columns it contains.
However, unlike <code>merged_inner</code>, <code>merged_left</code>
contains the <em>same number of rows</em> as the original
<code>survey_sub</code> DataFrame. When we inspect
<code>merged_left</code>, we find there are rows where the information
that should have come from <code>species_sub</code> (i.e.,
<code>species_id</code>, <code>genus</code>, and <code>taxa</code>) is
missing (they contain <code>NaN</code> values):</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>merged_left[merged_left[<span class="st">'genus'</span>].isna()]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   record_id  month  day  year  plot_id species_id sex  hindfoot_length  \
5          6      7   16  1977        1         PF   M               14
9         10      7   16  1977        6         PF   F               20

   weight genus species taxa
5     NaN   NaN     NaN  NaN
9     NaN   NaN     NaN  NaN</code></pre>
</div>
<p>These rows are the ones where the value of <code>species_id</code>
from <code>survey_sub</code> (in this case, <code>PF</code>) does not
occur in <code>species_sub</code>.</p>
</div>
<div class="section level3">
<h3 id="other-join-types">Other join types<a class="anchor" aria-label="anchor" href="#other-join-types"></a>
</h3>
<p>The pandas <code>merge</code> function supports other join types:</p>
<ul>
<li>Right (outer) join: Invoked by passing <code>how='right'</code> as
an argument. Similar to a left join, except <em>all</em> rows from the
<code>right</code> DataFrame are kept, while rows from the
<code>left</code> DataFrame without matching join key(s) values are
discarded.</li>
<li>Full (outer) join: Invoked by passing <code>how='outer'</code> as an
argument. This join type returns the all pairwise combinations of rows
from both DataFrames; i.e., the <em>Cartesian product</em> and the
result DataFrame will use <code>NaN</code> where data is missing in one
of the dataframes. This join type is very rarely used, but can be
helpful to see all the qualities of both tables, including each common
and duplicate column.</li>
<li>Self-join: Joins a data frame with itself. Self-joins can be useful
when you want to, for instance, compare records within the same dataset
based on a given criteria. A fuller discussion of how and when it might
be useful to do so can be found in <a href="https://blog.devgenius.io/self-join-and-cross-join-in-pandas-dataframe-b30bfbc0e52a" class="external-link">Self-Join
and Cross Join in Pandas DataFrame</a>
</li>
</ul>
</div>
</section><section id="final-challenges"><h2 class="section-heading">Final Challenges<a class="anchor" aria-label="anchor" href="#final-challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge---distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---distributions" class="callout-inner">
<h3 class="callout-title">Challenge - Distributions<a class="anchor" aria-label="anchor" href="#challenge---distributions"></a>
</h3>
<div class="callout-content">
<p>Create a new DataFrame by joining the contents of the
<code>surveys.csv</code> and <code>species.csv</code> tables. Then
calculate and plot the distribution of:</p>
<ol style="list-style-type: decimal">
<li>taxa by plot</li>
<li>taxa by sex by plot</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>merged_left <span class="op">=</span> pd.merge(left<span class="op">=</span>surveys_df,right<span class="op">=</span>species_df, how<span class="op">=</span><span class="st">'left'</span>, on<span class="op">=</span><span class="st">"species_id"</span>)</span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>taxa per plot (number of species of each taxa per plot):</li>
</ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>merged_left.groupby([<span class="st">"plot_id"</span>])[<span class="st">"taxa"</span>].nunique().plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span></code></pre>
</div>
<figure><img src="../fig/04_chall_ntaxa_per_site.png" alt="taxa per plot" class="figure mx-auto d-block"></figure><p><em>Suggestion</em>: It is also possible to plot the number of
individuals for each taxa in each plot (stacked bar chart):</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>merged_left.groupby([<span class="st">"plot_id"</span>, <span class="st">"taxa"</span>]).count()[<span class="st">"record_id"</span>].unstack().plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">3</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.05</span>)) <span class="co"># stop the legend from overlapping with the bar plot</span></span></code></pre>
</div>
<figure><img src="../fig/04_chall_taxa_per_site.png" alt="taxa per plot" class="figure mx-auto d-block"></figure><ol start="2" style="list-style-type: decimal">
<li>taxa by sex by plot: Providing the Nan values with the M|F values
(can also already be changed to ‘x’):</li>
</ol>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>merged_left.loc[merged_left[<span class="st">"sex"</span>].isnull(), <span class="st">"sex"</span>] <span class="op">=</span> <span class="st">'M|F'</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>ntaxa_sex_site<span class="op">=</span> merged_left.groupby([<span class="st">"plot_id"</span>, <span class="st">"sex"</span>])[<span class="st">"taxa"</span>].nunique().reset_index(level<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>ntaxa_sex_site <span class="op">=</span> ntaxa_sex_site.pivot_table(values<span class="op">=</span><span class="st">"taxa"</span>, columns<span class="op">=</span><span class="st">"sex"</span>, index<span class="op">=</span>ntaxa_sex_site.index)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>ntaxa_sex_site.plot(kind<span class="op">=</span><span class="st">"bar"</span>, legend<span class="op">=</span><span class="va">False</span>, stacked<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">3</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.08</span>),</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>           fontsize<span class="op">=</span><span class="st">'small'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<figure><img src="../fig/04_chall_ntaxa_per_site_sex.png" alt="taxa per plot per sex" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Suggestion (for discussion only)</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>The number of individuals for each taxa in each plot per sex can be
derived as well.</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>sex_taxa_site  <span class="op">=</span> merged_left.groupby([<span class="st">"plot_id"</span>, <span class="st">"taxa"</span>, <span class="st">"sex"</span>]).count()[<span class="st">'record_id'</span>]</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>sex_taxa_site.unstack(level<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">2</span>]).plot(kind<span class="op">=</span><span class="st">'bar'</span>, logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">3</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.15</span>),</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>           fontsize<span class="op">=</span><span class="st">'small'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<figure><img src="../fig/04_chall_sex_taxa_site_intro.png" alt="taxa per plot per sex" class="figure mx-auto d-block"></figure><p>This is not really the best plot choice, e.g. it is not easily
readable. A first option to make this better, is to make facets.
However, pandas/matplotlib do not provide this by default. Just as a
pure matplotlib example (<code>M|F</code> if for not-defined sex
records):</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="cf">for</span> sex, ax <span class="kw">in</span> <span class="bu">zip</span>([<span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M|F"</span>], axs):</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    sex_taxa_site[sex_taxa_site[<span class="st">"sex"</span>] <span class="op">==</span> sex].plot(kind<span class="op">=</span><span class="st">'bar'</span>, ax<span class="op">=</span>ax, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    ax.set_ylabel(sex)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> ax.is_last_row():</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>        ax.set_xticks([])</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>        ax.set_xlabel(<span class="st">""</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>axs[<span class="dv">0</span>].legend(loc<span class="op">=</span><span class="st">'upper center'</span>, ncol<span class="op">=</span><span class="dv">5</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.3</span>),</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="st">'small'</span>, frameon<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<figure><img src="../fig/04_chall_sex_taxa_site.png" alt="taxa per plot per sex" class="figure mx-auto d-block"></figure><p>However, it would be better to link to <a href="https://stanford.edu/~mwaskom/software/seaborn" class="external-link">Seaborn</a> and <a href="https://github.com/ellisonbg/altair" class="external-link">Altair</a> for this kind of
multivariate visualisation.</p>
</div>
</div>
</div>
</div>
<div id="challenge---diversity-index" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---diversity-index" class="callout-inner">
<h3 class="callout-title">Challenge - Diversity Index<a class="anchor" aria-label="anchor" href="#challenge---diversity-index"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>In the data folder, there is a <code>plots.csv</code> file that
contains information about the type associated with each plot. Use that
data to summarize the number of plots by plot type.</p></li>
<li><p>Calculate a diversity index of your choice for control vs rodent
exclosure plots. The index should consider both species abundance and
number of species. You might choose to use the simple <a href="https://www.amnh.org/explore/curriculum-collections/biodiversity-counts/plant-ecology/how-to-calculate-a-biodiversity-index" class="external-link">biodiversity
index described here</a> which calculates diversity as: the number of
species in the plot / the total number of individuals in the plot =
Biodiversity index.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>plot_info <span class="op">=</span> pd.read_csv(<span class="st">"data/plots.csv"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>plot_info.groupby(<span class="st">"plot_type"</span>).count()</span></code></pre>
</div></li>
<li>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>merged_site_type <span class="op">=</span> pd.merge(merged_left, plot_info, on<span class="op">=</span><span class="st">'plot_id'</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co"># For each plot, get the number of species for each plot</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>nspecies_site <span class="op">=</span> merged_site_type.groupby([<span class="st">"plot_id"</span>])[<span class="st">"species"</span>].nunique().rename(<span class="st">"nspecies"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># For each plot, get the number of individuals</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>nindividuals_site <span class="op">=</span> merged_site_type.groupby([<span class="st">"plot_id"</span>]).count()[<span class="st">'record_id'</span>].rename(<span class="st">"nindiv"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a><span class="co"># combine the two series</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>diversity_index <span class="op">=</span> pd.concat([nspecies_site, nindividuals_site], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co"># calculate the diversity index</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>diversity_index[<span class="st">'diversity'</span>] <span class="op">=</span> diversity_index[<span class="st">'nspecies'</span>]<span class="op">/</span>diversity_index[<span class="st">'nindiv'</span>]</span></code></pre>
</div>
<p>Making a bar chart from this diversity index:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>diversity_index[<span class="st">'diversity'</span>].plot(kind<span class="op">=</span><span class="st">"barh"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>plt.xlabel(<span class="st">"Diversity index"</span>)</span></code></pre>
</div>
<figure><img src="../fig/04_chall_diversity_index.png" alt="horizontal bar chart of diversity index by plot" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Pandas’ <code>merge</code> and <code>concat</code> can be used to
combine subsets of a DataFrame, or even data from different files.</li>
<li>
<code>join</code> function combines DataFrames based on index or
column.</li>
<li>Joining two DataFrames can be done in multiple ways (left, right,
and inner) depending on what data must be in the final DataFrame.</li>
<li>
<code>to_csv</code> can be used to write out DataFrames in CSV
format.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-06-loops-and-functions"><p>Content from <a href="06-loops-and-functions.html">Data Workflows and Automation</a></p>
<hr>
<p>Last updated on 2023-05-18 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/06-loops-and-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I automate operations in Python?</li>
<li>What are functions and why should I use them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe why for loops are used in Python.</li>
<li>Employ for loops to automate data analysis.</li>
<li>Write unique filenames in Python.</li>
<li>Build reusable code in Python.</li>
<li>Write functions using conditional statements (if, then, else).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>So far, we’ve used Python and the pandas library to explore and
manipulate individual datasets by hand, much like we would do in a
spreadsheet. The beauty of using a programming language like Python,
though, comes from the ability to automate data processing through the
use of loops and functions.</p>
<section id="for-loops"><h2 class="section-heading">For loops<a class="anchor" aria-label="anchor" href="#for-loops"></a>
</h2>
<hr class="half-width">
<p>Loops allow us to repeat a workflow (or series of actions) a given
number of times or while some condition is true. We would use a loop to
automatically process data that’s stored in multiple files (daily values
with one file per year, for example). Loops lighten our work load by
performing repeated tasks without our direct involvement and make it
less likely that we’ll introduce errors by making mistakes while
processing each file by hand.</p>
<p>Let’s write a simple for loop that simulates what a kid might see
during a visit to the zoo:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="bu">print</span>(animals)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['lion', 'tiger', 'crocodile', 'vulture', 'hippo']</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="bu">print</span>(creature)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">lion</span></span>
<span><span class="va">tiger</span></span>
<span><span class="va">crocodile</span></span>
<span><span class="va">vulture</span></span>
<span><span class="va">hippo</span></span></code></pre>
</div>
<p>The line defining the loop must start with <code>for</code> and end
with a colon, and the body of the loop must be indented.</p>
<p>In this example, <code>creature</code> is the loop variable that
takes the value of the next entry in <code>animals</code> every time the
loop goes around. We can call the loop variable anything we like. After
the loop finishes, the loop variable will still exist and will have the
value of the last entry in the collection:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="cf">pass</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The loop variable is now: '</span> <span class="op">+</span> creature)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The loop variable is now: hippo</code></pre>
</div>
<p>We are not asking Python to print the value of the loop variable
anymore, but the for loop still runs and the value of
<code>creature</code> changes on each pass through the loop. The
statement <code>pass</code> in the body of the loop means “do
nothing”.</p>
<div id="challenge---loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---loops" class="callout-inner">
<h3 class="callout-title">Challenge - Loops<a class="anchor" aria-label="anchor" href="#challenge---loops"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>What happens if we don’t include the <code>pass</code>
statement?</p></li>
<li><p>Rewrite the loop so that the animals are separated by commas, not
new lines (Hint: You can concatenate strings using a plus sign. For
example, <code>print(string1 + string2)</code> outputs
‘string1string2’).</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'crocodile'</span>, <span class="st">'vulture'</span>, <span class="st">'hippo'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>IndentationError: expected an indented block</code></pre>
</div>
</li>
<li>
<p>Using the <code>end</code> argument to <code>print</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>    <span class="bu">print</span>(creature <span class="op">+</span> <span class="st">','</span>, end<span class="op">=</span><span class="st">''</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lion,tiger,crocodile,vulture,hippo,</code></pre>
</div>
<p>This puts a comma on the end of the list, which is not ideal. To
avoid this, we need to use an altogether different approach: string
objects in Python have a <code>join</code> method, which can be used to
concatenate items in a list with the string in between, e.g.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">', '</span>.join(animals)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'lion, tiger, crocodile, vulture, hippo'</span></span></code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="automating-data-processing-using-for-loops"><h2 class="section-heading">Automating data processing using For Loops<a class="anchor" aria-label="anchor" href="#automating-data-processing-using-for-loops"></a>
</h2>
<hr class="half-width">
<p>The file we’ve been using so far, <code>surveys.csv</code>, contains
25 years of data and is very large. We would like to separate the data
for each year into a separate file.</p>
<p>Let’s start by making a new directory inside the folder
<code>data</code> to store all of these files using the module
<code>os</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>os.mkdir(<span class="st">'data/yearly_files'</span>)</span></code></pre>
</div>
<p>The command <code>os.mkdir</code> is equivalent to <code>mkdir</code>
in the shell. Just so we are sure, we can check that the new directory
was created within the <code>data</code> folder:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>os.listdir(<span class="st">'data'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['plots.csv',
 'portal_mammals.sqlite',
 'species.csv',
 'survey2001.csv',
 'survey2002.csv',
 'surveys.csv',
 'surveys2002_temp.csv',
 'yearly_files']</code></pre>
</div>
<p>The command <code>os.listdir</code> is equivalent to <code>ls</code>
in the shell.</p>
<p>In previous lessons, we saw how to use the library pandas to load the
species data into memory as a DataFrame, how to select a subset of the
data using some criteria, and how to write the DataFrame into a CSV
file. Let’s write a script that performs those three steps in sequence
for the year 2002:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># Select only data for the year 2002</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>surveys2002 <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># Write the new DataFrame to a CSV file</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>surveys2002.to_csv(<span class="st">'data/yearly_files/surveys2002.csv'</span>)</span></code></pre>
</div>
<p>To create yearly data files, we could repeat the last two commands
over and over, once for each year of data. Repeating code is neither
elegant nor practical, and is very likely to introduce errors into your
code. We want to turn what we’ve just written into a loop that repeats
the last two commands for every year in the dataset.</p>
<p>Let’s start by writing a loop that prints the names of the files we
want to create - the dataset we are using covers 1977 through 2002, and
we’ll create a separate file for each of those years. Listing the
filenames is a good way to confirm that the loop is behaving as we
expect.</p>
<p>We have seen that we can loop over a list of items, so we need a list
of years to loop over. We can get the years in our DataFrame with:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>surveys_df[<span class="st">'year'</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0        1977
1        1977
2        1977
3        1977
         ...
35545    2002
35546    2002
35547    2002
35548    2002</code></pre>
</div>
<p>but we want only unique years, which we can get using the
<code>unique</code> method which we have already seen.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>surveys_df[<span class="st">'year'</span>].unique()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987,
       1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998,
       1999, 2000, 2001, 2002], dtype=int64)</code></pre>
</div>
<p>Putting this into our for loop we get</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> surveys_df[<span class="st">'year'</span>].unique():</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>   filename<span class="op">=</span><span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>   <span class="bu">print</span>(filename)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1977.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1978.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1979.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1980.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1981.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1982.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1983.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1984.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1985.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1986.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1987.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1988.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1989.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1990.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1991.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1992.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1993.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1994.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1995.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1996.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1997.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1998.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys1999.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2000.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2001.csv</span></span>
<span><span class="va">data</span><span class="op">/</span><span class="va">yearly_files</span><span class="op">/</span><span class="va">surveys2002.csv</span></span></code></pre>
</div>
<p>We can now add the rest of the steps we need to create separate text
files:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> surveys_df[<span class="st">'year'</span>].unique():</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>    surveys_year <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> year]</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a CSV file</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>    surveys_year.to_csv(filename)</span></code></pre>
</div>
<p>Look inside the <code>yearly_files</code> directory and check a
couple of the files you just created to confirm that everything worked
as expected.</p>
</section><section id="writing-unique-file-names"><h2 class="section-heading">Writing Unique File Names<a class="anchor" aria-label="anchor" href="#writing-unique-file-names"></a>
</h2>
<hr class="half-width">
<p>Notice that the code above created a unique filename for each
year.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">'data/yearly_files/surveys'</span> <span class="op">+</span> <span class="bu">str</span>(year) <span class="op">+</span> <span class="st">'.csv'</span></span></code></pre>
</div>
<p>Let’s break down the parts of this name:</p>
<ul>
<li>The first part is some text that specifies the directory to store
our data file in (data/yearly_files/) and the first part of the file
name (surveys): <code>'data/yearly_files/surveys'</code>
</li>
<li>We can concatenate this with the value of a variable, in this case
<code>year</code> by using the plus <code>+</code> sign and the variable
we want to add to the file name: <code>+ str(year)</code>
</li>
<li>Then we add the file extension as another text string:
<code>+ '.csv'</code>
</li>
</ul>
<p>Notice that we use single quotes to add text strings. The variable is
not surrounded by quotes. This code produces the string
<code>data/yearly_files/surveys2002.csv</code> which contains the path
to the new filename AND the file name itself.</p>
<div id="challenge---modifying-loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---modifying-loops" class="callout-inner">
<h3 class="callout-title">Challenge - Modifying loops<a class="anchor" aria-label="anchor" href="#challenge---modifying-loops"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Some of the surveys you saved are missing data (they have null
values that show up as NaN - Not A Number - in the DataFrames and do not
show up in the text files). Modify the for loop so that the entries with
null values are not included in the yearly files.</p></li>
<li><p>Let’s say you only want to look at data from a given multiple of
years. How would you modify your loop in order to generate a data file
for only every 5th year, starting from 1977?</p></li>
<li><p>Instead of splitting out the data by years, a colleague wants to
do analyses each species separately. How would you write a unique CSV
file for each species?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>surveys_year <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> year].dropna()</span></code></pre>
</div></li>
<li>
<p>You could just make a list manually, however, why not check the
first and last year making use of the code itself?</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>n_year <span class="op">=</span> <span class="dv">5</span>  <span class="co"># better overview by making variable from it</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>first_year <span class="op">=</span> surveys_df[<span class="st">'year'</span>].<span class="bu">min</span>()</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>last_year <span class="op">=</span> surveys_df[<span class="st">'year'</span>].<span class="bu">max</span>()</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(first_year, last_year, n_year):</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    <span class="bu">print</span>(year)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    surveys_year <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> year].dropna()</span></code></pre>
</div>
</li>
<li><div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="cf">for</span> species <span class="kw">in</span> surveys_df[<span class="st">'species_id'</span>].dropna().unique():</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>    surveys_species <span class="op">=</span> surveys_df[surveys_df.species_id <span class="op">==</span> species]</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'episodes/data/species_files/surveys'</span> <span class="op">+</span> species <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    surveys_species.to_csv(filename)</span></code></pre>
</div></li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="building-reusable-and-modular-code-with-functions"><h2 class="section-heading">Building reusable and modular code with functions<a class="anchor" aria-label="anchor" href="#building-reusable-and-modular-code-with-functions"></a>
</h2>
<hr class="half-width">
<p>Suppose that separating large data files into individual yearly files
is a task that we frequently have to perform. We could write a
<strong>for loop</strong> like the one above every time we needed to do
it but that would be time consuming and error prone. A more elegant
solution would be to create a reusable tool that performs this task with
minimum input from the user. To do this, we are going to turn the code
we’ve already written into a function.</p>
<p>Functions are reusable, self-contained pieces of code that are called
with a single command. They can be designed to accept arguments as input
and return values, but they don’t need to do either. Variables declared
inside functions only exist while the function is running and if a
variable within the function (a local variable) has the same name as a
variable somewhere else in the code, the local variable hides but
doesn’t overwrite the other.</p>
<p>Every method used in Python (for example, <code>print</code>) is a
function, and the libraries we import (say, <code>pandas</code>) are a
collection of functions. We will only use functions that are housed
within the same code that uses them, but we can also write functions
that can be used by different programs.</p>
<p>Functions are declared following this general structure:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>    <span class="co"># The body of the function is indented</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="co"># This function prints the two arguments to screen</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>    </span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>    <span class="co"># And returns their product</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span></code></pre>
</div>
<p>The function declaration starts with the word <code>def</code>,
followed by the function name and any arguments in parenthesis, and ends
in a colon. The body of the function is indented just like loops are. If
the function returns something when it is called, it includes a return
statement at the end.</p>
<p>This is how we call the function:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">2</span>, <span class="dv">5</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The function arguments are: 2 5 (this is done inside the function!)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Their product is:'</span>, product_of_inputs, <span class="st">'(this is done outside the function!)'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Their product is: 10 (this is done outside the function!)</code></pre>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>When teaching the challenge below, demonstrating the results in a
debugging environment can make function scope more clear.</p>
</div>
</div>
</div>
</div>
<div id="challenge---functions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---functions" class="callout-inner">
<h3 class="callout-title">Challenge - Functions<a class="anchor" aria-label="anchor" href="#challenge---functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Change the values of the arguments provided to the function and
check its output</li>
<li>Try calling the function by giving it the wrong number of arguments
(not 2) or not assigning the function call to a variable (no
<code>product_of_inputs =</code>)</li>
<li>Declare a variable inside the function and test to see where it
exists (Hint: can you print it from outside the function?)</li>
<li>Explore what happens when a variable both inside and outside the
function have the same name. What happens to the global variable when
you change the value of the local variable?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<p>For example, using an integer and a string:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">3</span>, <span class="st">'clap'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="bu">print</span>(product_of_inputs)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The function arguments are: 3 clap (this is done inside the function!)
clapclapclap</code></pre>
</div>
</li>
<li>
<p>For example, providing a third integer argument:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">3</span>, <span class="dv">18</span>, <span class="dv">33</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>TypeError: this_is_the_function_name() takes 2 positional arguments but 3 were given</code></pre>
</div>
<p>and proving the correct number of arguments but not capturing the
return value in a variable:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>this_is_the_function_name(<span class="dv">23</span>, <span class="dv">108</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The function arguments are: 23 108 (this is done inside the function!)
2484</code></pre>
</div>
</li>
<li>
<p>An example looking at variables defined outside and inside the
function. Note that the explanatory comments have been removed from the
function definition.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>var_defined_outside <span class="op">=</span> <span class="st">'outside'</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>    var_defined_inside <span class="op">=</span> <span class="st">'inside'</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'This variable was created '</span> <span class="op">+</span> var_defined_outside <span class="op">+</span> <span class="st">' the function'</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>this_is_the_function_name(<span class="fl">3.3</span>, <span class="fl">7.9</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'This variable was created'</span> <span class="op">+</span> var_defined_inside <span class="op">+</span> <span class="st">' the function'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The function arguments are: 3.3 7.9 (this is done inside the function!)
This variable was created outside the function
26.07</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>NameError: name 'var_defined_inside' is not defined</code></pre>
</div>
<p>We can see from these results that variables defined outside the
function are available for use inside them, while variables defined
inside a function are not available outside them.</p>
</li>
<li>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>shared_variable_name <span class="op">=</span> <span class="st">'who would I be'</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>    shared_variable_name <span class="op">=</span> <span class="st">'without you'</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="bu">print</span>(shared_variable_name)</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>this_is_the_function_name(<span class="dv">2</span>, <span class="dv">3</span>) <span class="co"># does calling the function change the variable's value?</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a><span class="bu">print</span>(shared_variable_name)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>who would I be
The function arguments are: 2 3 (this is done inside the function!)
6
who would I be</code></pre>
</div>
<p>And what about if we modify the variable inside the function?</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>    shared_variable_name <span class="op">=</span> <span class="st">'without you'</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>    shared_variable_name <span class="op">=</span> shared_variable_name <span class="op">+</span> <span class="st">', without them?'</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>    <span class="bu">print</span>(shared_variable_name)</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>this_is_the_function_name(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="bu">print</span>(shared_variable_name)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>without you, without them?
The function arguments are: 2 3 (this is done inside the function!)
6
who would I be</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<p>We can now turn our code for saving yearly data files into a
function. There are many different “chunks” of this code that we can
turn into functions, and we can even create functions that call other
functions inside them. Let’s first write a function that separates data
for just one year and saves that data to a file:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data):</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="co">    this_year -- year for which data is extracted</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/function_surveys'</span> <span class="op">+</span> <span class="bu">str</span>(this_year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>    surveys_year.to_csv(filename)</span></code></pre>
</div>
<p>The text between the two sets of triple double quotes is called a
docstring and contains the documentation for the function. It does
nothing when the function is running and is therefore not necessary, but
it is good practice to include docstrings as a reminder of what the code
does. Docstrings in functions also become part of their ‘official’
documentation, and we can see them by typing
<code>help(function_name)</code>:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="bu">help</span>(one_year_csv_writer)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Help on function one_year_csv_writer in module __main__:

one_year_csv_writer(this_year, all_data)
    Writes a csv file for data from a given year.
    this_year -- year for which data is extracted
    all_data -- DataFrame with multi-year data</code></pre>
</div>
<p>Or, when working in the Jupyter environment, adding a <code>?</code>
(question mark) after the function name:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>one_year_csv_writer?</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>one_year_csv_writer(<span class="dv">2002</span>, surveys_df)</span></code></pre>
</div>
<p>We changed the root of the name of the CSV file so we can distinguish
it from the one we wrote before. Check the <code>yearly_files</code>
directory for the file. Did it do what you expect?</p>
<p>What we really want to do, though, is create files for multiple years
without having to request them one by one. Let’s write another function
that replaces the entire <code>for</code> loop by looping through a
sequence of years and repeatedly calling the function we just wrote,
<code>one_year_csv_writer</code>:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data):</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="co">    Writes separate CSV files for each year of data.</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want</span></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>        one_year_csv_writer(year, all_data)</span></code></pre>
</div>
<p>Because people will naturally expect that the end year for the files
is the last year with data, the for loop inside the function ends at
<code>end_year + 1</code>. By writing the entire loop into a function,
we’ve made a reusable tool for whenever we need to break a large data
file into yearly files. Because we can specify the first and last year
for which we want files, we can even use this function to create files
for a subset of the years available. This is how we call this
function:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="co"># Create CSV files</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>yearly_data_csv_writer(<span class="dv">1977</span>, <span class="dv">2002</span>, surveys_df)</span></code></pre>
</div>
<p>BEWARE! If you are using Jupyter Notebooks and you modify a function,
you MUST re-run that cell in order for the changed function to be
available to the rest of the code. Nothing will visibly happen when you
do this, though, because defining a function without <em>calling</em> it
doesn’t produce an output. Any cells that use the now-changed functions
will also have to be re-run for their output to change.</p>
<div id="challenge-more-functions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-more-functions" class="callout-inner">
<h3 class="callout-title">Challenge: More functions<a class="anchor" aria-label="anchor" href="#challenge-more-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Add two arguments to the functions we wrote that take the path of
the directory where the files will be written and the root of the file
name. Create a new set of files with a different name in a different
directory.</li>
<li>How could you use the function <code>yearly_data_csv_writer</code>
to create a CSV file for only one year? (Hint: think about the syntax
for <code>range</code>)</li>
<li>Make the functions return a list of the files they have written.
There are many ways you can do this (and you should try them all!):
either of the functions can print to screen, either can use a return
statement to give back numbers or strings to their function call, or you
can use some combination of the two. You could also try using the
<code>os</code> library to list the contents of directories.</li>
<li>Explore what happens when variables are declared inside each of the
functions versus in the main (non-indented) body of your code. What is
the scope of the variables (where are they visible)? What happens when
they have the same name but are given different values?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save, root_name):</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a><span class="co">    this_year : int</span></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a><span class="co">    all_data: pd.DataFrame</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a><span class="co">        folder to save the data files</span></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a><span class="co">        root of the filenames to save the data</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>    filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>    surveys_year.to_csv(filename)</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>start_year <span class="op">=</span> <span class="dv">1978</span></span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>end_year <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>directory_name <span class="op">=</span> <span class="st">'different_directory'</span></span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>root_file_name <span class="op">=</span> <span class="st">'different_file_name'</span></span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>     one_year_csv_writer(year, surveys_df, directory_name, root_file_name)</span></code></pre>
</div></li>
<li><p><code>yearly_data_csv_writer(2000, 2000, surveys_df)</code></p></li>
<li>
<p>Building a list and returning it:</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data):</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="co">    this_year -- year for which data is extracted</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'data/yearly_files/function_surveys'</span> <span class="op">+</span> <span class="bu">str</span>(this_year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>    surveys_year.to_csv(filename)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>    <span class="cf">return</span> filename</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data):</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a><span class="co">    Writes separate CSV files for each year of data.</span></span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want</span></span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want</span></span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb56-27"><a href="#cb56-27" tabindex="-1"></a>    output_files <span class="op">=</span> []</span>
<span id="cb56-28"><a href="#cb56-28" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb56-29"><a href="#cb56-29" tabindex="-1"></a>        output_files.append(one_year_csv_writer(year, all_data))</span>
<span id="cb56-30"><a href="#cb56-30" tabindex="-1"></a>    <span class="cf">return</span> output_files</span>
<span id="cb56-31"><a href="#cb56-31" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" tabindex="-1"></a><span class="bu">print</span>(yearly_data_csv_writer(<span class="dv">2000</span>, <span class="dv">2001</span>, surveys_df))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['data/yearly_files/function_surveys2000.csv', 'data/yearly_files/function_surveys2001.csv']</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<p>The functions we wrote demand that we give them a value for every
argument. Ideally, we would like these functions to be as flexible and
independent as possible. Let’s modify the function
<code>yearly_data_csv_writer</code> so that the <code>start_year</code>
and <code>end_year</code> default to the full range of the data if they
are not supplied by the user. Arguments can be given default values with
an equal sign in the function declaration. Any arguments in the function
without default values (here, <code>all_data</code>) is a required
argument and MUST come before the argument with default values (which
are optional in the function call).</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year<span class="op">=</span><span class="dv">1977</span>, end_year<span class="op">=</span><span class="dv">2002</span>):</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co">    Modified from yearly_data_csv_writer to test default argument values!</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want (default 1977)</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want (default 2002)</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df)</span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Both optional arguments:	1988 1993
Default values:		1977 2002</code></pre>
</div>
<p>The “\t” in the <code>print</code> statements are tabs, used to make
the text align and be easier to read.</p>
<p>But what if our dataset doesn’t start in 1977 and end in 2002? We can
modify the function so that it looks for the start and end years in the
dataset if those dates are not provided:</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year<span class="op">=</span><span class="va">None</span>, end_year<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="co">    Modified from yearly_data_csv_writer to test default argument values!</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want, Check all_data! (default None)</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want; Check all_data! (default None)</span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>    <span class="cf">if</span> start_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>        start_year <span class="op">=</span> <span class="bu">min</span>(all_data.year)</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>    <span class="cf">if</span> end_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>        end_year <span class="op">=</span> <span class="bu">max</span>(all_data.year)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both optional arguments:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a></span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df)</span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Both optional arguments:	1988 1993
Default values:		1977 2002</code></pre>
</div>
<p>The default values of the <code>start_year</code> and
<code>end_year</code> arguments in the function
<code>yearly_data_arg_test</code> are now <code>None</code>. This is a
built-in constant in Python that indicates the absence of a value -
essentially, that the variable exists in the namespace of the function
(the directory of variable names) but that it doesn’t correspond to any
existing object.</p>
<div id="challenge---variables" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---variables" class="callout-inner">
<h3 class="callout-title">Challenge - Variables<a class="anchor" aria-label="anchor" href="#challenge---variables"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What type of object corresponds to a variable declared as
<code>None</code>? (Hint: create a variable set to <code>None</code> and
use the function <code>type()</code>)</li>
<li>Compare the behavior of the function
<code>yearly_data_arg_test</code> when the arguments have
<code>None</code> as a default and when they do not have default
values.</li>
<li>What happens if you only include a value for <code>start_year</code>
in the function call? Can you write the function call with only a value
for <code>end_year</code>? (Hint: think about how the function must be
assigning values to each of the arguments - this is related to the need
to put the arguments without default values before those with default
values in the function definition!)</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>nothing <span class="op">=</span> <span class="va">None</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="bu">type</span>(nothing)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">NoneType</span></span></code></pre>
</div>
</li>
<li>
<p>Removing <code>None</code> as the default value for the
<code>start_year</code> and <code>end_year</code> parameters results in
a <code>TypeError</code> because the function now expects three
arguments to be provided:</p>
<div class="codewrapper sourceCode" id="cb64">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_arg_test(all_data, start_year, end_year):</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="co">    Modified from yearly_data_csv_writer to test default argument values!</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want, Check all_data! (default None)</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want; Check all_data! (default None)</span></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>    <span class="cf">if</span> start_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>        start_year <span class="op">=</span> <span class="bu">min</span>(all_data.year)</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>    <span class="cf">if</span> end_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>        end_year <span class="op">=</span> <span class="bu">max</span>(all_data.year)</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>    <span class="cf">return</span> start_year, end_year</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>TypeError: yearly_data_arg_test() missing 2 required positional arguments: 'start_year' and 'end_year'</code></pre>
</div>
</li>
<li>
<p>Returning to the original definition of the function (i.e. with
the default <code>None</code> values):</p>
<div class="codewrapper sourceCode" id="cb66">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>yearly_data_arg_test(surveys_df, <span class="dv">1985</span>) <span class="co"># providing only the start year</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(1985, 2002)</code></pre>
</div>
<p>If we want to provide only the end year, we have to name the
arguments:</p>
<div class="codewrapper sourceCode" id="cb68">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>yearly_data_arg_test(surveys_df, end_year<span class="op">=</span><span class="dv">1985</span>) <span class="co"># providing only the start year</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(1977, 1985)</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="if-statements"><h2 class="section-heading">If Statements<a class="anchor" aria-label="anchor" href="#if-statements"></a>
</h2>
<hr class="half-width">
<p>The body of the test function now has two conditionals (if
statements) that check the values of <code>start_year</code> and
<code>end_year</code>. If statements execute a segment of code when some
condition is met. They commonly look something like this:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a><span class="cf">if</span> a<span class="op">&lt;</span><span class="dv">0</span>:  <span class="co"># Meets first condition?</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>    <span class="co"># if a IS less than zero</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a negative number'</span>)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a><span class="cf">elif</span> a<span class="op">&gt;</span><span class="dv">0</span>:  <span class="co"># Did not meet first condition. meets second condition?</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and IS more than zero</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a positive number'</span>)</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a><span class="cf">else</span>:  <span class="co"># Met neither condition</span></span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and ISN'T more than zero</span></span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a must be zero!'</span>)</span></code></pre>
</div>
<p>Which would return:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a is a positive number</code></pre>
</div>
<p>Change the value of <code>a</code> to see how this function works.
The statement <code>elif</code> means “else if”, and all of the
conditional statements must end in a colon.</p>
<p>The if statements in the function <code>yearly_data_arg_test</code>
check whether there is an object associated with the variable names
<code>start_year</code> and <code>end_year</code>. If those variables
are <code>None</code>, the if statements return the boolean
<code>True</code> and execute whatever is in their body. On the other
hand, if the variable names are associated with some value (they got a
number in the function call), the if statements return
<code>False</code> and do not execute. The opposite conditional
statements, which would return <code>True</code> if the variables were
associated with objects (if they had received value in the function
call), would be <code>if start_year</code> and
<code>if end_year</code>.</p>
<p>As we’ve written it so far, the function
<code>yearly_data_arg_test</code> associates values in the function call
with arguments in the function definition just based on their order. If
the function gets only two values in the function call, the first one
will be associated with <code>all_data</code> and the second with
<code>start_year</code>, regardless of what we intended them to be. We
can get around this problem by calling the function using keyword
arguments, where each of the arguments in the function definition is
associated with a keyword and the function call passes values to the
function using these keywords:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Default values:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, <span class="dv">1988</span>, <span class="dv">1993</span>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'No keywords:</span><span class="ch">\t\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, start_year<span class="op">=</span><span class="dv">1988</span>, end_year<span class="op">=</span><span class="dv">1993</span>)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, in order:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, end_year<span class="op">=</span><span class="dv">1993</span>, start_year<span class="op">=</span><span class="dv">1988</span>)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Both keywords, flipped:</span><span class="ch">\t\t</span><span class="st">'</span>, start, end)</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, start_year<span class="op">=</span><span class="dv">1988</span>)</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default end:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>start, end <span class="op">=</span> yearly_data_arg_test(surveys_df, end_year<span class="op">=</span><span class="dv">1993</span>)</span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'One keyword, default start:</span><span class="ch">\t</span><span class="st">'</span>, start, end)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Default values:		1977 2002
No keywords:		1988 1993
Both keywords, in order:	1988 1993
Both keywords, flipped:	1988 1993
One keyword, default end:	1988 2002
One keyword, default start:	1977 1993</code></pre>
</div>
<div id="challenge---modifying-functions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---modifying-functions" class="callout-inner">
<h3 class="callout-title">Challenge - Modifying functions<a class="anchor" aria-label="anchor" href="#challenge---modifying-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Rewrite the <code>one_year_csv_writer</code> and
<code>yearly_data_csv_writer</code> functions to have keyword arguments
with default values</p></li>
<li><p>Modify the functions so that they don’t create yearly files if
there is no data for a given year and display an alert to the user
(Hint: use conditional statements to do this. For an extra challenge,
use <code>try</code> statements!)</p></li>
<li>
<p>The code below checks to see whether a directory exists and
creates one if it doesn’t. Add some code to your function that writes
out the CSV files, to check for a directory to write to.</p>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="cf">if</span> <span class="st">'dir_name_here'</span> <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Processed directory exists'</span>)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>    os.mkdir(<span class="st">'dir_name_here'</span>)</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span></code></pre>
</div>
</li>
<li><p>The code that you have written so far to loop through the years
is good, however it is not necessarily reproducible with different
datasets. For instance, what happens to the code if we have additional
years of data in our CSV files? Using the tools that you learned in the
previous activities, make a list of all years represented in the data.
Then create a loop to process your data, that begins at the earliest
year and ends at the latest year using that list.</p></li>
</ol>
<p>HINT: you can create a loop with a list as follows:
<code>for years in year_list:</code></p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">Show me the solution</h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save<span class="op">=</span><span class="st">'./'</span>, root_name<span class="op">=</span><span class="st">'survey'</span>):</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a><span class="co">    this_year : int</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a><span class="co">    all_data: pd.DataFrame</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a><span class="co">        folder to save the data files</span></span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a><span class="co">        root of the filenames to save the data</span></span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a>    filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a>    surveys_year.to_csv(filename)</span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(all_data, start_year<span class="op">=</span><span class="va">None</span>, end_year<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a><span class="co">    Writes separate CSV files for each year of data.</span></span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" tabindex="-1"></a><span class="co">    start_year -- the first year of data we want</span></span>
<span id="cb75-29"><a href="#cb75-29" tabindex="-1"></a><span class="co">    end_year -- the last year of data we want</span></span>
<span id="cb75-30"><a href="#cb75-30" tabindex="-1"></a><span class="co">    all_data -- DataFrame with multi-year data</span></span>
<span id="cb75-31"><a href="#cb75-31" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb75-32"><a href="#cb75-32" tabindex="-1"></a>    <span class="cf">if</span> start_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb75-33"><a href="#cb75-33" tabindex="-1"></a>        start_year <span class="op">=</span> <span class="bu">min</span>(all_data.year)</span>
<span id="cb75-34"><a href="#cb75-34" tabindex="-1"></a>    <span class="cf">if</span> end_year <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb75-35"><a href="#cb75-35" tabindex="-1"></a>        end_year <span class="op">=</span> <span class="bu">max</span>(all_data.year)</span>
<span id="cb75-36"><a href="#cb75-36" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb75-37"><a href="#cb75-37" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb75-38"><a href="#cb75-38" tabindex="-1"></a>        one_year_csv_writer(year, all_data)</span></code></pre>
</div></li>
<li><div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save<span class="op">=</span><span class="st">'./'</span>, root_name<span class="op">=</span><span class="st">'survey'</span>):</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="co">    this_year : int</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a><span class="co">    all_data: pd.DataFrame</span></span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a><span class="co">        folder to save the data files</span></span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a><span class="co">        root of the filenames to save the data</span></span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(surveys_year) <span class="op">==</span> <span class="dv">0</span>: <span class="co"># 'if not len(surveys_year):' will also work </span></span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'no data available for '</span> <span class="op">+</span> this_year <span class="op">+</span> <span class="st">', output file not created'</span>)</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>        <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>        filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>        surveys_year.to_csv(filename)</span></code></pre>
</div></li>
<li>
<p>The solution below uses <code>not</code> to invert the check for
the directory, so a message is printed one time at most i.e. when the
directory is created:</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save<span class="op">=</span><span class="st">'./'</span>, root_name<span class="op">=</span><span class="st">'survey'</span>):</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="co">    this_year : int</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a><span class="co">    all_data: pd.DataFrame</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a><span class="co">        folder to save the data files</span></span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a><span class="co">        root of the filenames to save the data</span></span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>    surveys_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(surveys_year) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'no data available for '</span> <span class="op">+</span> this_year <span class="op">+</span> <span class="st">', output file not created'</span>)</span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb77-22"><a href="#cb77-22" tabindex="-1"></a>        <span class="cf">if</span> folder_to_save <span class="kw">not</span> <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb77-23"><a href="#cb77-23" tabindex="-1"></a>            os.mkdir(folder_to_save)</span>
<span id="cb77-24"><a href="#cb77-24" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span>
<span id="cb77-25"><a href="#cb77-25" tabindex="-1"></a>        <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb77-26"><a href="#cb77-26" tabindex="-1"></a>        filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb77-27"><a href="#cb77-27" tabindex="-1"></a>        surveys_year.to_csv(filename)</span></code></pre>
</div>
<p>The equivalent, without using <code>not</code> to invert the
conditional, would be:</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="cf">if</span> folder_to_save <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>    os.mkdir(folder_to_save)</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span></code></pre>
</div>
</li>
<li><div class="codewrapper sourceCode" id="cb79">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(all_data, yearcolumn<span class="op">=</span><span class="st">"year"</span>,</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>                           folder_to_save<span class="op">=</span><span class="st">'./'</span>, root_name<span class="op">=</span><span class="st">'survey'</span>):</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a><span class="co">    Writes separate csv files for each year of data.</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="co">    all_data --- DataFrame with multi-year data</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a><span class="co">    yearcolumn --- column name containing the year of the data</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a><span class="co">    folder_to_save --- folder name to store files</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a><span class="co">    root_name --- start of the file names stored</span></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>    years <span class="op">=</span> all_data[yearcolumn].unique()</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>    filenames <span class="op">=</span> []</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> years:</span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>        filenames.append(one_year_csv_writer(year, all_data, folder_to_save, root_name))</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>    <span class="cf">return</span> filenames</span></code></pre>
</div></li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Loops help automate repetitive tasks over sets of items.</li>
<li>Loops combined with functions provide a way to process data more
efficiently than we could by hand.</li>
<li>Conditional statements enable execution of different operations on
different data.</li>
<li>Functions enable code reuse.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-07-visualization-ggplot-python"><p>Content from <a href="07-visualization-ggplot-python.html">Making Plots With plotnine</a></p>
<hr>
<p>Last updated on 2024-03-29 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/07-visualization-ggplot-python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I visualize data in Python?</li>
<li>What is ‘grammar of graphics’?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a <code>plotnine</code> object.</li>
<li>Set universal plot settings.</li>
<li>Modify an existing plotnine object.</li>
<li>Change the aesthetics of a plot such as color.</li>
<li>Edit the axis labels.</li>
<li>Build complex plots using a step-by-step approach.</li>
<li>Create scatter plots, box plots, and time series plots.</li>
<li>Use the facet_wrap and facet_grid commands to create a collection of
plots splitting the data by a factor variable.</li>
<li>Create customized plot styles to meet their needs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="disclaimer"><h2 class="section-heading">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<hr class="half-width">
<p>Python has powerful built-in plotting capabilities such as
<code>matplotlib</code>, but for this episode, we will be using the <a href="https://github.com/has2k1/plotnine?tab=readme-ov-file" class="external-link">plotnine</a>
package, which facilitates the creation of highly-informative plots of
structured data based on the R implementation of <a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> and <a href="https://link.springer.com/book/10.1007%2F0-387-28695-0" class="external-link">The
Grammar of Graphics</a> by Leland Wilkinson. The <code>plotnine</code>
package is built on top of Matplotlib and interacts well with
Pandas.</p>
<div id="reminder" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reminder" class="callout-inner">
<h3 class="callout-title">Reminder<a class="anchor" aria-label="anchor" href="#reminder"></a>
</h3>
<div class="callout-content">
<p><code>plotnine</code> is not included in the standard Anaconda
installation and needs to be installed separately. If you haven’t done
so already, you can find installation instructions on the <a href="https://datacarpentry.org/python-ecology-lesson/#required-python-packages" class="external-link">Setup
page</a>.</p>
</div>
</div>
</div>
<p>Just as with the other packages, <code>plotnine</code> needs to be
imported. It is good practice to not just load an entire package such as
<code>from plotnine import *</code>, but to use an abbreviation as we
used <code>pd</code> for Pandas:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span></code></pre>
</div>
<p>From now on, the functions of <code>plotnine</code> are available
using <code>p9.</code>. For the exercise, we will use the
<code>surveys.csv</code> data set, with the <code>NA</code> values
removed</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>surveys_complete <span class="op">=</span> pd.read_csv(<span class="st">'data/surveys.csv'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>surveys_complete <span class="op">=</span> surveys_complete.dropna()</span></code></pre>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>If learners have trouble generating the output, or anything happens
with that, the folder <a href="https://github.com/datacarpentry/python-ecology-lesson/tree/main/sample_output" class="external-link"><code>sample_output</code></a>
in this repository contains the file <code>surveys_complete.csv</code>
with the data they should generate.</p>
</div>
</div>
</div>
</div>
</section><section id="plotting-with-plotnine"><h2 class="section-heading">Plotting with plotnine<a class="anchor" aria-label="anchor" href="#plotting-with-plotnine"></a>
</h2>
<hr class="half-width">
<p>The <code>plotnine</code> package (cfr. other packages conform The
Grammar of Graphics) supports the creation of complex plots from data in
a dataframe. It uses default settings, which help creating publication
quality plots with a minimal amount of settings and tweaking.</p>
<p><code>plotnine</code> graphics are built step by step by adding new
elements adding different elements on top of each other using the
<code>+</code> operator. Putting the individual steps together in
brackets <code>()</code> provides Python-compatible syntax.</p>
<p>To build a <code>plotnine</code> graphic we need to:</p>
<ul>
<li>Bind the plot to a specific data frame using the <code>data</code>
argument:</li>
</ul>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete))</span></code></pre>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<p>Note <code>plotnine</code> contains a <em>lot</em> of deprecation
warnings in some versions of python/matplotlib, warnings may need to be
suppressed with</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>warnings.filterwarnings(action<span class="op">=</span><span class="st">'once'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>As we have not defined anything else, just an empty figure is
available and presented.</p>
<ul>
<li>Define aesthetics (<code>aes</code>), by <strong>selecting
variables</strong> used in the plot and <code>mapping</code> them to a
presentation such as plotting size, shape, color, etc. You can interpret
this as: <strong>which</strong> of the variables will influence the
plotted objects/geometries:</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>)))</span></code></pre>
</div>
<p>The most important aes mappings are: <code>x</code>, <code>y</code>,
<code>alpha</code>, <code>color</code>, <code>colour</code>,
<code>fill</code>, <code>linetype</code>, <code>shape</code>,
<code>size</code> and <code>stroke</code>.</p>
<ul>
<li>Still no specific data is plotted, as we have to define what kind of
geometry will be used for the plot. The most straightforward is probably
using points. Points is one of the <code>geoms</code> options, the
graphical representation of the data in the plot. Others are lines,
bars,… To add a geom to the plot use <code>+</code> operator:</li>
</ul>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span></code></pre>
</div>
<p>The <code>+</code> in the <code>plotnine</code> package is
particularly useful because it allows you to modify existing
<code>plotnine</code> objects. This means you can easily set up plot
<em>templates</em> and conveniently explore different types of plots, so
the above plot can also be generated with code like this:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Create</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>surveys_plot <span class="op">=</span> p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                         mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Draw the plot</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>surveys_plot <span class="op">+</span> p9.geom_point()</span></code></pre>
</div>
<figure><img src="../fig/06_first_plot.png" alt="scatter plot of hindfoot length vs weight with black dots denoting individual sampled animals, showing 4 main clusters of dots in the middle and left middle sides" class="figure mx-auto d-block"></figure><div id="challenge---bar-chart" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---bar-chart" class="callout-inner">
<h3 class="callout-title">Challenge - bar chart<a class="anchor" aria-label="anchor" href="#challenge---bar-chart"></a>
</h3>
<div class="callout-content">
<p>Working on the <code>surveys_complete</code> data set, use the
<code>plot-id</code> column to create a <code>bar</code>-plot that
counts the number of records for each plot. (Check the documentation of
the bar geometry to handle the counts)</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Answers</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'plot_id'</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_challenge_bar.png" alt="bar chart of count of rodents caught at each plot site" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>Notes:</p>
<ul>
<li>Anything you put in the <code>ggplot()</code> function can be seen
by any geom layers that you add (i.e., these are universal plot
settings). This includes the <code>x</code> and <code>y</code> axis you
set up in <code>aes()</code>.</li>
<li>You can also specify aesthetics for a given <code>geom</code>
independently of the aesthetics defined globally in the
<code>ggplot()</code> function.</li>
</ul></section><section id="building-your-plots-iteratively"><h2 class="section-heading">Building your plots iteratively<a class="anchor" aria-label="anchor" href="#building-your-plots-iteratively"></a>
</h2>
<hr class="half-width">
<p>Building plots with <code>plotnine</code> is typically an iterative
process. We start by defining the dataset we’ll use, lay the axes, and
choose a geom. Hence, the <code>data</code>, <code>aes</code> and
<code>geom-*</code> are the elementary elements of any graph:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Then, we start modifying this plot to extract more information from
it. For instance, we can add transparency (alpha) to avoid
overplotting:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_alpha_plot.png" alt="scatter plot of hindfoot-length vs weight of rodents,  showing a curve increasing to a plateau" class="figure mx-auto d-block"></figure><p>We can also add colors for all the points</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_blue_plot.png" alt="scatter plot of hindfoot-length vs weight  of rodents, demonstrating overplotting" class="figure mx-auto d-block"></figure><p>Or to color each species in the plot differently, map the
<code>species_id</code> column to the color aesthetic:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_color_plot.png" alt="scatter plot of Hindfoot length vs weight with colors coordinating to specific species, showing abundance in the mid to lower left side of the plot" class="figure mx-auto d-block"></figure><p>Apart from the adaptations of the arguments and settings of the
<code>data</code>, <code>aes</code> and <code>geom-*</code> elements,
additional elements can be added as well, using the <code>+</code>
operator:</p>
<ul>
<li>Changing the labels:</li>
</ul>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_color_label_plot.png" alt="scatter plot of Hindfoot length vs weight (g) with colors coordinating to specific species, showing abundance in the mid to lower left side of the plot" class="figure mx-auto d-block"></figure><ul>
<li>Defining scale for colors, axes,… For example, a log-version of the
x-axis could support the interpretation of the lower numbers:</li>
</ul>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    <span class="op">+</span> p9.scale_x_log10()</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_log_plot.png" alt="Scatterplot of hindfoot length versus weight where logarithmic x-axis is used to distribute lower numbers" class="figure mx-auto d-block"></figure><ul>
<li>Changing the theme (<code>theme_*</code>) or some specific theming
(<code>theme</code>) elements. Usually plots with white background look
more readable when printed. We can set the background to white using the
function <code>theme_bw()</code>.</li>
</ul>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>, color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="op">+</span> p9.xlab(<span class="st">"Weight (g)"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="op">+</span> p9.scale_x_log10()</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="op">+</span> p9.theme_bw()</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="op">+</span> p9.theme(text<span class="op">=</span>p9.element_text(size<span class="op">=</span><span class="dv">16</span>))</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_white_plot.png" alt="Scatterplot of hindfoot length versus weight on a logarithmic x-axis using a white background" class="figure mx-auto d-block"></figure><div id="challenge---bar-plot-adaptations" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---bar-plot-adaptations" class="callout-inner">
<h3 class="callout-title">Challenge - Bar plot adaptations<a class="anchor" aria-label="anchor" href="#challenge---bar-plot-adaptations"></a>
</h3>
<div class="callout-content">
<p>Adapt the bar plot of the previous exercise by mapping the
<code>sex</code> variable to the color fill of the bar chart. Change the
<code>scale</code> of the color fill by providing the colors
<code>blue</code> and <code>orange</code> manually (see <a href="https://plotnine.org/reference/" class="external-link">API reference</a> to find the
appropriate function).</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Answers</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'plot_id'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                          fill<span class="op">=</span><span class="st">'sex'</span>))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="op">+</span> p9.scale_fill_manual([<span class="st">"blue"</span>, <span class="st">"orange"</span>])</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_challenge_color_bar.png" alt="Bar chart of counts of males (yellow) and females (blue) vs plot id, showing the number of females to be higher in all plots" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="plotting-distributions"><h2 class="section-heading">Plotting distributions<a class="anchor" aria-label="anchor" href="#plotting-distributions"></a>
</h2>
<hr class="half-width">
<p>Visualizing distributions is a common task during data exploration
and analysis. To visualize the distribution of <code>weight</code>
within each <code>species_id</code> group, a boxplot can be used:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="op">+</span> p9.geom_boxplot()</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_boxplot.png" alt="boxplot showing distribution of rodent weight for each species group" class="figure mx-auto d-block"></figure><p>By adding points of the individual observations to the boxplot, we
can have a better idea of the number of measurements and of their
distribution:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="op">+</span> p9.geom_jitter(alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_boxplot(alpha<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_point_boxplot.png" alt="Boxplot of weight by species overlaying observation points to visualize the distribution" class="figure mx-auto d-block"></figure><div id="challenge---distributions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---distributions" class="callout-inner">
<h3 class="callout-title">Challenge - distributions<a class="anchor" aria-label="anchor" href="#challenge---distributions"></a>
</h3>
<div class="callout-content">
<p>Boxplots are useful summaries, but hide the <em>shape</em> of the
distribution. For example, if there is a bimodal distribution, this
would not be observed with a boxplot. An alternative to the boxplot is
the violin plot (sometimes known as a beanplot), where the shape (of the
density of points) is drawn.</p>
<p>In many types of data, it is important to consider the <em>scale</em>
of the observations. For example, it may be worth changing the scale of
the axis to better distribute the observations in the space of the
plot.</p>
<ul>
<li>Replace the box plot with a violin plot, see
<code>geom_violin()</code>
</li>
<li>Represent weight on the log10 scale, see
<code>scale_y_log10()</code>
</li>
<li>Add color to the datapoints on your boxplot according to the plot
from which the sample was taken (<code>plot_id</code>)</li>
</ul>
<p>Hint: Check the class for <code>plot_id</code>. By using
<code>factor()</code> within the <code>aes</code> mapping of a variable,
<code>plotnine</code> will handle the values as category values.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Answers</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'species_id'</span>,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'factor(plot_id)'</span>))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_jitter(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    <span class="op">+</span> p9.geom_violin(alpha<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">"0.7"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="op">+</span> p9.scale_y_log10()</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_challenge_boxplot.png" alt="Violin plot of weight of species shown with weight scaled down and datapoints with color." class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="plotting-time-series-data"><h2 class="section-heading">Plotting time series data<a class="anchor" aria-label="anchor" href="#plotting-time-series-data"></a>
</h2>
<hr class="half-width">
<p>Let’s calculate the number of counts per year for each species. To do
that we need to group data first and count the species
(<code>species_id</code>) within each group.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>yearly_counts <span class="op">=</span> surveys_complete.groupby([<span class="st">'year'</span>, <span class="st">'species_id'</span>])[<span class="st">'species_id'</span>].count()</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>yearly_counts</span></code></pre>
</div>
<p>When checking the result of the previous calculation, we actually
have both the <code>year</code> and the <code>species_id</code> as a row
index. We can reset this index to use both as column variable:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>yearly_counts <span class="op">=</span> yearly_counts.reset_index(name<span class="op">=</span><span class="st">'counts'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>yearly_counts</span></code></pre>
</div>
<p>Timelapse data can be visualised as a line plot
(<code>geom_line</code>) with years on <code>x</code> axis and counts on
the <code>y</code> axis.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_counts,</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'counts'</span>))</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Unfortunately this does not work, because we plot data for all the
species together. We need to tell <code>plotnine</code> to draw a line
for each species by modifying the aesthetic function and map the
species_id to the color:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_counts,</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'counts'</span>,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_time_plot.png" alt="Line graph of count per year where data for each species is indicated by a different color" class="figure mx-auto d-block"></figure></section><section id="faceting"><h2 class="section-heading">Faceting<a class="anchor" aria-label="anchor" href="#faceting"></a>
</h2>
<hr class="half-width">
<p>As any other library supporting the Grammar of Graphics,
<code>plotnine</code> has a special technique called <em>faceting</em>
that allows to split one plot into multiple plots based on a factor
variable included in the dataset.</p>
<p>Consider our scatter plot of the <code>weight</code> versus the
<code>hindfoot_length</code> from the previous sections:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>)</span></code></pre>
</div>
<p>We can now keep the same code and at the <code>facet_wrap</code> on a
chosen variable to split out the graph and make a separate graph for
each of the groups in that variable. As an example, use
<code>sex</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"sex"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_facet_plot.png" alt="2 scatter plots, one for males and the other for females, of hindfoot length vs weight with colored dots denoting specific species, showing the trend is the same between both male and females of multiple species" class="figure mx-auto d-block"></figure><p>We can apply the same concept on any of the available categorical
variables:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"plot_id"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_facet_all_plot.png" alt="24 individual scatter plots of Hindfoot length vs weight of species with colors denoting species and numbers above plot representing 1 of the 24 plots, showing trends for each unique plot id studied" class="figure mx-auto d-block"></figure><p>The <code>facet_wrap</code> geometry extracts plots into an arbitrary
number of dimensions to allow them to cleanly fit on one page. On the
other hand, the <code>facet_grid</code> geometry allows you to
explicitly specify how you want your plots to be arranged via formula
notation (<code>rows ~ columns</code>; a <code>.</code> can be used as a
placeholder that indicates only one row or column).</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># only select the years of interest</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>survey_2000 <span class="op">=</span> surveys_complete[surveys_complete[<span class="st">"year"</span>].isin([<span class="dv">2000</span>, <span class="dv">2001</span>])]</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>survey_2000,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'hindfoot_length'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>    <span class="op">+</span> p9.facet_grid(<span class="st">"year ~ sex"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_select_plot.png" alt="Set of 4 color scatterplots showing the relationship between weight and hind foot length for 13 species, separated by sex and year" class="figure mx-auto d-block"></figure><div id="challenge---facetting" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---facetting" class="callout-inner">
<h3 class="callout-title">Challenge - facetting<a class="anchor" aria-label="anchor" href="#challenge---facetting"></a>
</h3>
<div class="callout-content">
<p>Create a separate plot for each of the species that depicts how the
average weight of the species changes through the years.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Answers</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>yearly_weight <span class="op">=</span> surveys_complete.groupby([<span class="st">'year'</span>, <span class="st">'species_id'</span>])[<span class="st">'weight'</span>].mean().reset_index()</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_weight, mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>, y<span class="op">=</span><span class="st">'weight'</span>))</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"species_id"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge---facetting-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---facetting-1" class="callout-inner">
<h3 class="callout-title">Challenge - facetting<a class="anchor" aria-label="anchor" href="#challenge---facetting-1"></a>
</h3>
<div class="callout-content">
<p>Based on the previous exercise, visually compare how the weights of
male and females has changed through time by creating a separate plot
for each sex and an individual color assigned to each
<code>species_id</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Answers</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>yearly_weight <span class="op">=</span> surveys_complete.groupby([<span class="st">'year'</span>, <span class="st">'species_id'</span>, <span class="st">'sex'</span>])[<span class="st">'weight'</span>].mean().reset_index()</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>yearly_weight,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'year'</span>,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>                          y<span class="op">=</span><span class="st">'weight'</span>,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>                          color<span class="op">=</span><span class="st">'species_id'</span>))</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    <span class="op">+</span> p9.geom_line()</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    <span class="op">+</span> p9.facet_wrap(<span class="st">"sex"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="further-customization"><h2 class="section-heading">Further customization<a class="anchor" aria-label="anchor" href="#further-customization"></a>
</h2>
<hr class="half-width">
<p>As the syntax of <code>plotnine</code> follows the original R package
<code>ggplot2</code>, the documentation of <code>ggplot2</code> can
provide information and inspiration to customize graphs. Take a look at
the <code>ggplot2</code> <a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html" class="external-link">cheat
sheet</a>, and think of ways to improve the plot. You can write down
some of your ideas as comments in the Etherpad.</p>
<p>The theming options provide a rich set of visual adaptations.
Consider the following example of a bar plot with the counts per
year.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_overlap_bars.png" alt="Bar graph of count per year showing overlapping x-axis labels" class="figure mx-auto d-block"></figure><p>Notice that we use the <code>year</code> here as a categorical
variable by using the <code>factor</code> functionality. However, by
doing so, we have the individual year labels overlapping with each
other. The <code>theme</code> functionality provides a way to rotate the
text of the x-axis labels:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>    <span class="op">+</span> p9.theme_bw()</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    <span class="op">+</span> p9.theme(axis_text_x <span class="op">=</span> p9.element_text(angle<span class="op">=</span><span class="dv">90</span>))</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_good_bars.png" alt="Bar graph of count per year demonstrating how the theme function rotates the x-axis labels" class="figure mx-auto d-block"></figure><p>When you like a specific set of theme-customizations you created, you
can save them as an object to easily apply them to other plots you may
create:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>my_custom_theme <span class="op">=</span> p9.theme(axis_text_x <span class="op">=</span> p9.element_text(color<span class="op">=</span><span class="st">"grey"</span>, size<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>                                                         angle<span class="op">=</span><span class="dv">90</span>, hjust<span class="op">=</span><span class="fl">.5</span>),</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                           axis_text_y <span class="op">=</span> p9.element_text(color<span class="op">=</span><span class="st">"grey"</span>, size<span class="op">=</span><span class="dv">10</span>))</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>(p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'factor(year)'</span>))</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    <span class="op">+</span> p9.geom_bar()</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    <span class="op">+</span> my_custom_theme</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>)</span></code></pre>
</div>
<figure><img src="../fig/06_theme_plot.png" alt="Bar graph of count per year demonstrating the use of a customized theme" class="figure mx-auto d-block"></figure><div id="challenge---customization" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---customization" class="callout-inner">
<h3 class="callout-title">Challenge - customization<a class="anchor" aria-label="anchor" href="#challenge---customization"></a>
</h3>
<div class="callout-content">
<p>Please take another five minutes to either improve one of the plots
generated in this exercise or create a beautiful graph of your own.</p>
<p>Here are some ideas:</p>
<ul>
<li>See if you can change thickness of lines for the line plot .</li>
<li>Can you find a way to change the name of the legend? What about its
labels?</li>
<li>Use a different color palette (see <a href="https://www.cookbook-r.com/Graphs/Colors_(ggplot2)" class="external-link">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)</a>)</li>
</ul>
</div>
</div>
</div>
<p>After creating your plot, you can save it to a file in your favourite
format. You can easily change the dimension (and its resolution) of your
plot by adjusting the appropriate arguments (<code>width</code>,
<code>height</code> and <code>dpi</code>):</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>my_plot <span class="op">=</span> (p9.ggplot(data<span class="op">=</span>surveys_complete,</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>           mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'weight'</span>, y<span class="op">=</span><span class="st">'hindfoot_length'</span>))</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>    <span class="op">+</span> p9.geom_point()</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>)</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>my_plot.save(<span class="st">"scatterplot.png"</span>, width<span class="op">=</span><span class="dv">10</span>, height<span class="op">=</span><span class="dv">10</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The <code>data</code>, <code>aes</code> variables and a
<code>geometry</code> are the main elements of a plotnine graph</li>
<li>With the <code>+</code> operator, additional <code>scale_*</code>,
<code>theme_*</code>, <code>xlab/ylab</code> and <code>facet_*</code>
elements are added</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-putting-it-all-together"><p>Content from <a href="08-putting-it-all-together.html">Data Ingest and Visualization - Matplotlib and Pandas</a></p>
<hr>
<p>Last updated on 2024-01-31 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/08-putting-it-all-together.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 105 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What other tools can I use to create plots apart from ggplot?</li>
<li>Why should I use Python to create plots?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Import the pyplot toolbox to create figures in Python.</li>
<li>Use matplotlib to make adjustments to Pandas or plotnine
objects.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="putting-it-all-together"><h2 class="section-heading">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<hr class="half-width">
<p>Up to this point, we have walked through tasks that are often
involved in handling and processing data using the workshop-ready
cleaned files that we have provided. In this wrap-up exercise, we will
perform many of the same tasks with real data sets. This lesson also
covers data visualization.</p>
<p>As opposed to the previous ones, this lesson does not give
step-by-step directions to each of the tasks. Use the lesson materials
you’ve already gone through as well as the Python documentation to help
you along.</p>
</section><section id="obtain-data"><h2 class="section-heading">Obtain data<a class="anchor" aria-label="anchor" href="#obtain-data"></a>
</h2>
<hr class="half-width">
<p>There are many repositories online from which you can obtain data. We
are providing you with one data file to use with these exercises, but
feel free to use any data that is relevant to your research. The file <a href="../data/bouldercreek_09_2013.txt"><code>bouldercreek_09_2013.txt</code></a>
contains stream discharge data, summarized at 15 minute intervals (in
cubic feet per second) for a streamgage on Boulder Creek at North 75th
Street (USGS gage06730200) for 1-30 September 2013. If you’d like to use
this dataset, please find it in the data folder.</p>
</section><section id="clean-up-your-data-and-open-it-using-python-and-pandas"><h2 class="section-heading">Clean up your data and open it using Python and Pandas<a class="anchor" aria-label="anchor" href="#clean-up-your-data-and-open-it-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>To begin, import your data file into Python using Pandas. Did it
fail? Your data file probably has a header that Pandas does not
recognize as part of the data table. Remove this header, but do not
simply delete it in a text editor! Use either a shell script or Python
to do this - you wouldn’t want to do it by hand if you had many files to
process.</p>
<p>If you are still having trouble importing the data as a table using
Pandas, check the documentation. You can open the docstring in a Jupyter
Notebook using a question mark. For example:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>pd.read_csv?</span></code></pre>
</div>
<p>Look through the function arguments to see if there is a default
value that is different from what your file requires (Hint: the problem
is most likely the delimiter or separator. Common delimiters are
<code>','</code> for comma, <code>' '</code> for space, and
<code>'\t'</code> for tab).</p>
<p>Create a DataFrame that includes only the values of the data that are
useful to you. In the streamgage file, those values might be the date,
time, and discharge measurements. Convert any measurements in imperial
units into SI units. You can also change the name of the columns in the
DataFrame like this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'1stcolumn'</span>:[<span class="dv">100</span>,<span class="dv">200</span>], <span class="st">'2ndcolumn'</span>:[<span class="dv">10</span>,<span class="dv">20</span>]}) <span class="co"># this just creates a DataFrame for the example!</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'With the old column names:</span><span class="ch">\n</span><span class="st">'</span>) <span class="co"># the \n makes a new line, so it's easier to see</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'FirstColumn'</span>, <span class="st">'SecondColumn'</span>] <span class="co"># rename the columns!</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n\n</span><span class="st">With the new column names:</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>With the old column names:

   1stcolumn  2ndcolumn
0        100         10
1        200         20


With the new column names:

   FirstColumn  SecondColumn
0          100            10
1          200            20</code></pre>
</div>
</section><section id="matplotlib-package"><h2 class="section-heading">Matplotlib package<a class="anchor" aria-label="anchor" href="#matplotlib-package"></a>
</h2>
<hr class="half-width">
<p><a href="https://matplotlib.org/" class="external-link">Matplotlib</a> is a Python package
that is widely used throughout the scientific Python community to create
high-quality and publication-ready graphics. It supports a wide range of
raster and vector graphics formats including PNG, PostScript, EPS, PDF
and SVG.</p>
<p>Moreover, matplotlib is the actual engine behind the plotting
capabilities of both Pandas and plotnine packages. For example, when we
call the <code>.plot</code> method on Pandas data objects, we actually
use the matplotlib package.</p>
<p>First, import the pyplot toolbox:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre>
</div>
<p>Now, let’s read data and plot it!</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>my_plot <span class="op">=</span> surveys.plot(<span class="st">"hindfoot_length"</span>, <span class="st">"weight"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>plt.show() <span class="co"># not necessary in Jupyter Notebooks</span></span></code></pre>
</div>
<figure><img src="../fig/08_scatter_surveys.png" alt="Scatter plot of survey data set" class="figure mx-auto d-block"></figure><div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip"></a>
</h3>
<div class="callout-content">
<p>By default, matplotlib creates a figure in a separate window. When
using Jupyter notebooks, we can make figures appear in-line within the
notebook by executing:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre>
</div>
</div>
</div>
</div>
<p>The returned object is a matplotlib object (check it yourself with
<code>type(my_plot)</code>), to which we may make further adjustments
and refinements using other matplotlib methods.</p>
<div id="tip-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-1" class="callout-inner">
<h3 class="callout-title">Tip<a class="anchor" aria-label="anchor" href="#tip-1"></a>
</h3>
<div class="callout-content">
<p>Matplotlib itself can be overwhelming, so a useful strategy is to do
as much as you easily can in a convenience layer, <em>i.e.</em> start
creating the plot in Pandas or plotnine, and then use matplotlib for the
rest.</p>
</div>
</div>
</div>
<p>We will cover a few basic commands for creating and formatting plots
with matplotlib in this lesson. A great resource for help creating and
styling your figures is the <a href="https://matplotlib.org/stable/gallery/" class="external-link">matplotlib gallery</a>,
which includes plots in many different styles and the source codes that
create them.</p>
<div class="section level3">
<h3 id="plt-pyplot-versus-object-based-matplotlib">
<code>plt</code> pyplot versus object-based matplotlib<a class="anchor" aria-label="anchor" href="#plt-pyplot-versus-object-based-matplotlib"></a>
</h3>
<p>Matplotlib integrates nicely with the NumPy package and can use NumPy
arrays as input to the available plot functions. Consider the following
example data, created with NumPy by drawing 1000 samples from a normal
distribution with a mean value of 0 and a standard deviation of 0.1:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>sample_data <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">1000</span>)</span></code></pre>
</div>
<p>To plot a histogram of our draws from the normal distribution, we can
use the <code>hist</code> function directly:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>plt.hist(sample_data)</span></code></pre>
</div>
<figure><img src="../fig/08-normal-distribution.png" alt="Histogram of 1000 samples from normal distribution" class="figure mx-auto d-block"></figure><div id="tip-cross-platform-visualization-of-figures" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-cross-platform-visualization-of-figures" class="callout-inner">
<h3 class="callout-title">Tip: Cross-Platform Visualization of
Figures<a class="anchor" aria-label="anchor" href="#tip-cross-platform-visualization-of-figures"></a>
</h3>
<div class="callout-content">
<p>Jupyter Notebooks make many aspects of data analysis and
visualization much simpler. This includes doing some of the labor of
visualizing plots for you. But, not every one of your collaborators will
be using a Jupyter Notebook. The <code>.show()</code> command allows you
to visualize plots when working at the command line, with a script, or
at the IPython interpreter. In the previous example, adding
<code>plt.show()</code> after the creation of the plot will enable your
colleagues who aren’t using a Jupyter notebook to reproduce your work on
their platform.</p>
</div>
</div>
</div>
<p>or create matplotlib <code>figure</code> and <code>axis</code>
objects first and subsequently add a histogram with 30 data bins:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()  <span class="co"># initiate an empty figure and axis matplotlib object</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>ax.hist(sample_data, <span class="dv">30</span>)</span></code></pre>
</div>
<p>Although the latter approach requires a little bit more code to
create the same plot, the advantage is that it gives us <strong>full
control</strong> over the plot and we can add new items such as labels,
grid lines, title, and other visual elements. For example, we can add
additional axes to the figure and customize their labels:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># prepare a matplotlib figure</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots()</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>ax1.hist(sample_data, <span class="dv">30</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'density'</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'value'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># define and sample beta distribution</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>beta_draws <span class="op">=</span> np.random.beta(a, b)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># add additional axes to the figure to plot beta distribution</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_axes([<span class="fl">0.125</span>, <span class="fl">0.575</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>])  <span class="co"># number coordinates correspond to left, bottom, width, height, respectively</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>ax2.hist(beta_draws)</span></code></pre>
</div>
<figure><img src="../fig/08-dualdistribution.png" alt="Plot with additional axes" class="figure mx-auto d-block"></figure><div id="challenge---drawing-from-distributions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---drawing-from-distributions" class="callout-inner">
<h3 class="callout-title">Challenge - Drawing from distributions<a class="anchor" aria-label="anchor" href="#challenge---drawing-from-distributions"></a>
</h3>
<div class="callout-content">
<p>Have a look at <a href="https://docs.scipy.org/doc/numpy/reference/random/index.html" class="external-link"><code>numpy.random</code>
documentation</a>. Choose a distribution you have no familiarity with,
and try to sample from and visualize it.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="link-matplotlib-pandas-and-plotnine">Link matplotlib, Pandas and plotnine<a class="anchor" aria-label="anchor" href="#link-matplotlib-pandas-and-plotnine"></a>
</h3>
<p>When we create a plot using pandas or plotnine, both libraries use
matplotlib to create those plots. The plots created in pandas or
plotnine are matplotlib objects, which enables us to use some of the
advanced plotting options available in the matplotlib library. Because
the objects output by pandas and plotnine can be read by matplotlib, we
have many more options than any one library can provide, offering a
consistent environment to make publication-quality visualizations.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>fig, ax1 <span class="op">=</span> plt.subplots() <span class="co"># prepare a matplotlib figure</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>surveys.plot(<span class="st">"hindfoot_length"</span>, <span class="st">"weight"</span>, kind<span class="op">=</span><span class="st">"scatter"</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># Provide further adaptations with matplotlib:</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>ax1.set_xlabel(<span class="st">"Hindfoot length"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>ax1.tick_params(labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>fig.suptitle(<span class="st">'Scatter plot of weight versus hindfoot length'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span></code></pre>
</div>
<figure><img src="../fig/08_scatter_surveys_extended.png" alt="Extended version of scatter plot surveys" class="figure mx-auto d-block"></figure><p>To retrieve the matplotlib figure object from plotnine for
customization, use the <code>draw()</code> function in plotnine:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> p9</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>myplot <span class="op">=</span> (p9.ggplot(data<span class="op">=</span>surveys,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                    mapping<span class="op">=</span>p9.aes(x<span class="op">=</span><span class="st">'hindfoot_length'</span>, y<span class="op">=</span><span class="st">'weight'</span>)) <span class="op">+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>              p9.geom_point())</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># convert output plotnine to a matplotlib object</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>my_plt_version <span class="op">=</span> myplot.draw()</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># Provide further adaptations with matplotlib:</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>p9_ax <span class="op">=</span> my_plt_version.axes[<span class="dv">0</span>] <span class="co"># each subplot is an item in a list</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>p9_ax.set_xlabel(<span class="st">"Hindfoot length"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>p9_ax.tick_params(labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>p9_ax.set_title(<span class="st">'Scatter plot of weight versus hindfoot length'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>plt.show() <span class="co"># not necessary in Jupyter Notebooks</span></span></code></pre>
</div>
<figure><img src="../fig/08_scatter_surveys_plotnine.png" alt="Extended version of plotnine scatter plot" class="figure mx-auto d-block"></figure><div id="challenge---pandas-and-matplotlib" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---pandas-and-matplotlib" class="callout-inner">
<h3 class="callout-title">Challenge - Pandas and matplotlib<a class="anchor" aria-label="anchor" href="#challenge---pandas-and-matplotlib"></a>
</h3>
<div class="callout-content">
<p>Load the streamgage data set with Pandas, subset the week of the 2013
Front Range flood (September 11 through 15) and create a hydrograph
(line plot) of the discharge data using Pandas, linking it to an empty
maptlotlib <code>ax</code> object. Create a second axis that displays
the whole dataset. Adapt the title and axes’ labels using
matplotlib.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Answers</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>discharge <span class="op">=</span> pd.read_csv(<span class="st">"data/bouldercreek_09_2013.txt"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                        skiprows<span class="op">=</span><span class="dv">27</span>, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                        names<span class="op">=</span>[<span class="st">"agency"</span>, <span class="st">"site_id"</span>, <span class="st">"datetime"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                               <span class="st">"timezone"</span>, <span class="st">"flow_rate"</span>, <span class="st">"discharge_cd"</span>])</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>discharge[<span class="st">"datetime"</span>] <span class="op">=</span> pd.to_datetime(discharge[<span class="st">"datetime"</span>])</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>flood <span class="op">=</span> discharge[(discharge[<span class="st">"datetime"</span>] <span class="op">&gt;=</span> <span class="st">"2013-09-11"</span>) <span class="op">&amp;</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>                  (discharge[<span class="st">"datetime"</span>] <span class="op">&lt;=</span> <span class="st">"2013-09-15"</span>)]</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>flood.plot(x<span class="op">=</span><span class="st">"datetime"</span>, y<span class="op">=</span><span class="st">"flow_rate"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>ax.set_xlabel(<span class="st">""</span>)  <span class="co"># no label</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Discharge, cubic feet per second"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>ax.legend().set_visible(<span class="va">False</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>ax.set_title(<span class="st">"Front Range flood event 2013"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_axes([<span class="fl">0.65</span>, <span class="fl">0.575</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>])</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co"># DataFrame.plot raises an error with an inset axis object,</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co"># so we use matplotlib's plot method instead</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>ax2.plot(<span class="st">"datetime"</span>, <span class="st">"flow_rate"</span>, data<span class="op">=</span>discharge)</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span></code></pre>
</div>
<figure><img src="../fig/08_flood_event.png" alt="Flood event plot" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="saving-matplotlib-figures">Saving matplotlib figures<a class="anchor" aria-label="anchor" href="#saving-matplotlib-figures"></a>
</h3>
<p>Once satisfied with the resulting plot, you can save the plot with
the <code>.savefig(*args)</code> method from matplotlib:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>fig.savefig(<span class="st">"my_plot_name.png"</span>)</span></code></pre>
</div>
<p>which will save the <code>fig</code> created using Pandas/matplotlib
as a png file with the name <code>my_plot_name</code></p>
<div id="tip-saving-figures-in-different-formats" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-saving-figures-in-different-formats" class="callout-inner">
<h3 class="callout-title">Tip: Saving figures in different formats<a class="anchor" aria-label="anchor" href="#tip-saving-figures-in-different-formats"></a>
</h3>
<div class="callout-content">
<p>Matplotlib recognizes the extension used in the filename and supports
(on most computers) png, pdf, ps, eps and svg formats.</p>
</div>
</div>
</div>
<div id="challenge---saving-figure-to-file" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---saving-figure-to-file" class="callout-inner">
<h3 class="callout-title">Challenge - Saving figure to file<a class="anchor" aria-label="anchor" href="#challenge---saving-figure-to-file"></a>
</h3>
<div class="callout-content">
<p>Check the documentation of the <code>savefig</code> method and check
how you can comply to journals requiring figures as <code>pdf</code>
file with dpi &gt;= 300.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Answers</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>fig.savefig(<span class="st">"my_plot_name.pdf"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="make-other-types-of-plots"><h2 class="section-heading">Make other types of plots:<a class="anchor" aria-label="anchor" href="#make-other-types-of-plots"></a>
</h2>
<hr class="half-width">
<p>Matplotlib can make many other types of plots in much the same way
that it makes two-dimensional line plots. Look through the examples in
<a href="https://matplotlib.org/stable/plot_types/" class="external-link">https://matplotlib.org/stable/plot_types/</a>
and try a few of them (click on the “Source code” link and copy and
paste into a new cell in Jupyter Notebook or save as a text file with a
<code>.py</code> extension and run in the command line).</p>
<div id="challenge---final-plot" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---final-plot" class="callout-inner">
<h3 class="callout-title">Challenge - Final Plot<a class="anchor" aria-label="anchor" href="#challenge---final-plot"></a>
</h3>
<div class="callout-content">
<p>Display your data using one or more plot types from the example
gallery. Which ones to choose will depend on the content of your own
data file. If you are using the streamgage file <a href="../data/bouldercreek_09_2013.txt"><code>bouldercreek_09_2013.txt</code></a>,
you could make a histogram of the number of days with a given mean
discharge, use bar plots to display daily discharge statistics, or
explore the different ways matplotlib can handle dates and times for
figures.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Matplotlib is the engine behind plotnine and Pandas plots.</li>
<li>The object-based nature of matplotlib plots enables their detailed
customization after they have been created.</li>
<li>Export plots to a file using the <code>savefig</code> method.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-09-working-with-sql"><p>Content from <a href="09-working-with-sql.html">Accessing SQLite Databases Using Python and Pandas</a></p>
<hr>
<p>Last updated on 2023-05-18 |
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/episodes/09-working-with-sql.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What if my data are stored in an SQL database? Can I manage them
with Python?</li>
<li>How can I write data from Python to be used with SQL?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the sqlite3 module to interact with a SQL database.</li>
<li>Access data stored in SQLite using Python.</li>
<li>Describe the difference in interacting with data stored as a CSV
file versus in SQLite.</li>
<li>Describe the benefits of accessing data using a database compared to
a CSV file.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="python-and-sql"><h2 class="section-heading">Python and SQL<a class="anchor" aria-label="anchor" href="#python-and-sql"></a>
</h2>
<hr class="half-width">
<p>When you open a CSV in python, and assign it to a variable name, you
are using your computers memory to save that variable. Accessing data
from a database like SQL is not only more efficient, but also it allows
you to subset and import only the parts of the data that you need.</p>
<p>In the following lesson, we’ll see some approaches that can be taken
to do so.</p>
<div class="section level3">
<h3 id="the-sqlite3-module">The <code>sqlite3</code> module<a class="anchor" aria-label="anchor" href="#the-sqlite3-module"></a>
</h3>
<p>The <a href="https://docs.python.org/3/library/sqlite3.html" class="external-link">sqlite3</a> module
provides a straightforward interface for interacting with SQLite
databases. A connection object is created using
<code>sqlite3.connect()</code>; the connection must be closed at the end
of the session with the <code>.close()</code> command. While the
connection is open, any interactions with the database require you to
make a cursor object with the <code>.cursor()</code> command. The cursor
is then ready to perform all kinds of operations with
<code>.execute()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># The result of a "cursor.execute" can be iterated over by row</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> cur.execute(<span class="st">'SELECT * FROM species;'</span>):</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co"># Be sure to close the connection</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>One of the most common ways to interact with a database is by
querying: retrieving data based on some search parameters. Use a SELECT
statement string. The query is returned as a single tuple or a tuple of
tuples. Add a WHERE statement to filter your results based on some
parameter.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Return all results of query</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>cur.execute(<span class="st">'SELECT plot_id FROM plots WHERE plot_type="Control"'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>cur.fetchall()</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Return first result of query</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>cur.execute(<span class="st">'SELECT species FROM species WHERE taxa="Bird"'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>cur.fetchone()</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co"># Be sure to close the connection</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
</section><section id="accessing-data-stored-in-sqlite-using-python-and-pandas"><h2 class="section-heading">Accessing data stored in SQLite using Python and Pandas<a class="anchor" aria-label="anchor" href="#accessing-data-stored-in-sqlite-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>Using pandas, we can import results of a SQLite query into a
dataframe. Note that you can use the same SQL commands / syntax that we
used in the SQLite lesson. An example of using pandas together with
sqlite is below:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Read sqlite query results into a pandas DataFrame</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from surveys"</span>, con)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</section><section id="storing-data-csv-vs-sqlite"><h2 class="section-heading">Storing data: CSV vs SQLite<a class="anchor" aria-label="anchor" href="#storing-data-csv-vs-sqlite"></a>
</h2>
<hr class="half-width">
<p>Storing your data in an SQLite database can provide substantial
performance improvements when reading/writing compared to CSV. The
difference in performance becomes more noticeable as the size of the
dataset grows (see for example <a href="https://sebastianraschka.com/Articles/2013_sqlite_database.html#results-and-conclusions" class="external-link">these
benchmarks</a>).</p>
<div id="challenge---sql" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---sql" class="callout-inner">
<h3 class="callout-title">Challenge - SQL<a class="anchor" aria-label="anchor" href="#challenge---sql"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a query that contains survey data collected between 1998 -
2001 for observations of sex “male” or “female” that includes
observation’s genus and species and site type for the sample. How many
records are returned?</li>
<li>Create a dataframe that contains the total number of observations
(count) made for all years, and sum of observation weights for each
site, ordered by site ID.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#Connect to the database</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># Return all results of query: year, plot type (site type), genus, species and sex</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># from the join of the tables surveys, plots and species, for the years 1998-2001 where sex is 'M' or 'F'.</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>cur.execute(<span class="st">'SELECT surveys.year,plots.plot_type,species.genus,species.species,surveys.sex </span><span class="ch">\</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="st">    FROM surveys INNER JOIN plots ON surveys.plot = plots.plot_id INNER JOIN species ON </span><span class="ch">\</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="st">    surveys.species = species.species_id WHERE surveys.year&gt;=1998 AND surveys.year&lt;=2001 </span><span class="ch">\</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="st">    AND ( surveys.sex = "M" OR surveys.sex = "F")'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The query returned '</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(cur.fetchall())) <span class="op">+</span> <span class="st">' records.'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co"># Close the connection</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The query returned 5546 records.</code></pre>
</div>
</li>
<li>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Create two sqlite queries results, read as pandas DataFrame</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># Include 'year' in both queries so we have something to merge (join) on.</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT year,COUNT(*) FROM surveys GROUP BY year"</span>, con)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT year,plot,SUM(wgt) FROM surveys GROUP BY </span><span class="ch">\</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="st">        year,plot ORDER BY plot ASC"</span>,con)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># Turn the plot_id column values into column names by pivoting</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>df2 <span class="op">=</span> df2.pivot(index<span class="op">=</span><span class="st">'year'</span>,columns<span class="op">=</span><span class="st">'plot'</span>)[<span class="st">'SUM(wgt)'</span>]</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>df <span class="op">=</span> pd.merge(df1, df2, on<span class="op">=</span><span class="st">'year'</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># Verify that result of the SQL queries is stored in the combined dataframe</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>year  COUNT(*)       1       2       3       4       5       6      7  \
0  1977       503   567.0   784.0   237.0   849.0   943.0   578.0  202.0   
1  1978      1048  4628.0  4789.0  1131.0  4291.0  4051.0  2371.0   43.0   
2  1979       719  1909.0  2501.0   430.0  2438.0  1798.0   988.0  141.0   
3  1980      1415  5374.0  4643.0  1817.0  7466.0  2743.0  3219.0  362.0   
4  1981      1472  6229.0  6282.0  1343.0  4553.0  3596.0  5430.0   24.0   

     8  ...      15     16      17      18     19      20     21      22  \
0   595.0  ...    48.0  132.0  1102.0   646.0  336.0   640.0   40.0   316.0   
1  3669.0  ...   734.0  548.0  4971.0  4393.0  124.0  2623.0  239.0  2833.0   
2  1954.0  ...   472.0  308.0  3736.0  3099.0  379.0  2617.0  157.0  2250.0   
3  3596.0  ...  1071.0  529.0  5877.0  5075.0  691.0  5523.0  321.0  3763.0   
4  4946.0  ...  1083.0  176.0  5050.0  4773.0  410.0  5379.0  600.0  5268.0   

   23      24  
0  169.0     NaN  
1    NaN     NaN  
2  137.0   901.0  
3  742.0  4392.0  
4   57.0  3987.0  

[5 rows x 26 columns]</code></pre>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="storing-data-create-new-tables-using-pandas"><h2 class="section-heading">Storing data: Create new tables using Pandas<a class="anchor" aria-label="anchor" href="#storing-data-create-new-tables-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We can also use pandas to create new tables within an SQLite
database. Here, we re-do an exercise we did before with CSV files using
our SQLite database. We first read in our survey data, then select only
those survey results for 2002, and then save it out to its own table so
we can work with it on its own later.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>surveys_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from surveys"</span>, con)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># Select only data for 2002</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>surveys2002 <span class="op">=</span> surveys_df[surveys_df.year <span class="op">==</span> <span class="dv">2002</span>]</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># Write the new DataFrame to a new SQLite table</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>surveys2002.to_sql(<span class="st">"surveys2002"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div id="challenge---saving-your-work" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---saving-your-work" class="callout-inner">
<h3 class="callout-title">Challenge - Saving your work<a class="anchor" aria-label="anchor" href="#challenge---saving-your-work"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>For each of the challenges in the previous challenge block,
modify your code to save the results to their own tables in the portal
database.</p></li>
<li><p>What are some of the reasons you might want to save the results
of your queries back into the database? What are some of the reasons you
might avoid doing this.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#Connect to the database</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"data/portal_mammals.sqlite"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># Read the results into a DataFrame</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_sql_query(<span class="st">'SELECT surveys.year,plots.plot_type,species.genus,species.species,surveys.sex </span><span class="ch">\</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="st">    FROM surveys INNER JOIN plots ON surveys.plot = plots.plot_id INNER JOIN species ON </span><span class="ch">\</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="st">    surveys.species = species.species_id WHERE surveys.year&gt;=1998 AND surveys.year&lt;=2001 </span><span class="ch">\</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="st">    AND ( surveys.sex = "M" OR surveys.sex = "F")'</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>df1.to_sql(<span class="st">"New Table 1"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># We already have the 'df' DataFrame created in the earlier exercise</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>df.to_sql(<span class="st">"New Table 2"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co"># Close the connection</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>con.close()</span></code></pre>
</div></li>
<li>
<p>If the database is shared with others and common queries (and
potentially data corrections) are likely to be required by many it may
be efficient for one person to perform the work and save it back to the
database as a new table so others can access the results directly
instead of performing the query themselves, particularly if it is
complex.</p>
<p>However, we might avoid doing this if the database is an
authoritative source (potentially version controlled) which should not
be modified by users. Instead, we might save the qeury results to a new
database that is more appropriate for downstream work.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>sqlite3 provides a SQL-like interface to read, query, and write SQL
databases from Python.</li>
<li>sqlite3 can be used with Pandas to read SQL data to the familiar
Pandas DataFrame.</li>
<li>Pandas and sqlite3 can also be used to transfer between the CSV and
SQL formats.</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-ecology-lesson/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-ecology-lesson/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/python-ecology-lesson/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-ecology-lesson/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/python-ecology-lesson/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/python-ecology-lesson/instructor/aio.html",
  "identifier": "https://datacarpentry.github.io/python-ecology-lesson/instructor/aio.html",
  "dateCreated": "2015-03-19",
  "dateModified": "2024-04-16",
  "datePublished": "2024-04-16"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

